---
title: "01z Wrangling"
author: "J Andres Gannon and Tom Brailey"
date: "2020-06-19"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(magrittr)
library(stringr)
```

# Equipment
This deals with all the equipment columns, organized alphabetically by section. For organization, we default to putting changes in the section that is the correct categorization for the technology, rather than the raw categorization of the technology.

## Not categorized
```{r}
iiss[] <- lapply(iiss, function(x) gsub("[&]", "and", x))

iiss$equipment_subname <- gsub(" ", "", iiss$equipment_subname, fixed=TRUE)

a <- gsub("*", "", iiss$unit_name, fixed=TRUE)
iiss$unit_name <- a

iiss$equipment_name[iiss$equipment_name == "?"] <- NA
```

## Air defence
### Typos
Here we fix typos, which include spelling errors, capitalization errors, and any other formatting errors that affect merging or equipment similarity

#### Unit_name typos
```{r}
iiss$unit_name[iiss$unit_name == "420 Chaparral"] <- "Chaparral"
iiss$unit_name[iiss$unit_name == "Nikes Hercules"] <- "Nike Hercules"
iiss$unit_name[iiss$unit_name == "2Kll Krug (SA-4 Ganef)"] <- "2K11 Krug (SA-4 Ganef)"
iiss$unit_name[iiss$unit_name == "SA-9/SA-13"] <- "SA-9/-13"
```

#### Equipment_subname typos
```{r}
iiss$equipment_subname[iiss$equipment_subname == "MANPD"] <- "MANPAD"
iiss$equipment_subname[iiss$equipment_subname == "35mmand85mmand100mm"] <- "35mm/85mm/100mm"
iiss$equipment_subname[iiss$equipment_subname == "MANDPD"] <- "MANPAD"
iiss$equipment_name[iiss$equipment_name == "MANPAT"] <- "MANPATS"
iiss$equipment_subname[iiss$equipment_name == "MANPADS"] <- "MANPAD"
iiss$equipment_name[iiss$equipment_name == "MANPADS"] <- "SAM"
```

#### Equipment_name typos
```{r}
iiss$equipment_name[iiss$equipment_name == "towed"] <- "TOWED"

iiss$equipment_name[iiss$equipment_name %in% c("AD Guns",
                                               "AD GUNS")] <- "AA"

iiss$equipment_type[iiss$equipment_type == "armoured fighting vehicles" &
                      iiss$equipment_name == "AA"] <- "air defence"

iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$equipment_name == "air defence"] <- "AA"
```

#### Equipment_subtype typos
```{r}
iiss$equipment_subtype[iiss$equipment_subtype == "missile"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_subtype == "missile"] <- "missiles"

iiss$equipment_subtype[iiss$equipment_subtype == "Radar"] <- "radars"
```

#### Equipment_type typos
```{r}
iiss$equipment_type[iiss$equipment_type == "AD"] <- "air defence"
iiss$equipment_type[iiss$equipment_type == "AD Guns"] <- "air defence"
iiss$equipment_type[iiss$equipment_type == "air defense"] <- "air defence"
iiss$equipment_type[iiss$equipment_type == "air-defence"] <- "air defence"
iiss$equipment_type[iiss$equipment_type == "anti-aircraft"] <- "air defence"
iiss$equipment_type[iiss$equipment_type == "anti-aircraft gun"] <- "air defence"
iiss$equipment_type[iiss$equipment_type == "coastal defence"] <- "air defence"
iiss$equipment_type[iiss$equipment_type == "ground defence"] <- "air defence"
iiss$equipment_type[iiss$equipment_type == "Missiles" |
                      iiss$equipment_type == "MISSILES"] <- "missiles"
iiss$equipment_type[iiss$equipment_type == "missile" |
                      iiss$equipment_type == "missiles"] <- "air defence"
iiss$equipment_type[iiss$equipment_type == "NA"] <- NA
iiss$equipment_type[iiss$equipment_type == "surface-to-air missile launchers"] <- "air defence"
iiss$equipment_type[iiss$equipment_type == "surface to air missiles"] <- "air defence"
iiss$equipment_type[iiss$equipment_type == "surface-to-air missile"] <- "air defence"
iiss$equipment_type[iiss$equipment_type == "surface-to-air missiles"] <- "air defence"
iiss$equipment_type[iiss$equipment_type == "squadron" &
                      iiss$unit_name == "Rapier"] <- "air defence"
```

### Coding changes
#### Unit_name 
```{r}
# Equipment type
iiss$equipment_type[iiss$unit_name == "L/70"] <- "artillery"
iiss$equipment_subtype[iiss$unit_name == "L/70"] <- "GUNS"
iiss$equipment_name[iiss$unit_name == "L/70"] <- "TOWED"
iiss$equipment_subname[iiss$unit_name == "L/70"] <- "40mm"

iiss$equipment_name[iiss$unit_name == "AIM-9"] <- "ASM"
iiss$equipment_subtype[iiss$unit_name == "AIM-9"] <- "missiles"
iiss$equipment_type[iiss$unit_name == "AIM-9"] <- "air-launched missiles"

iiss$equipment_type[iiss$unit_name == "Chaparral" &
                      iiss$equipment_type == "aircraft"] <- "air defence"

# iiss$equipment_type[iiss$unit_name == "Albatros"] <- "air defence"
# iiss$equipment_name[iiss$unit_name == "Albatros"] <- "SAM"

# Equipment_subname
iiss$equipment_subname[iiss$unit_name == "MIM-104F Patriot PAC-3/PAC-3 MSE"] <- "medium-range"
iiss$equipment_subname[iiss$unit_name == "NASAMS"] <- "short-range"
iiss$equipment_subname[iiss$unit_name == "MIM-104D/E Patriot PAC-2 GEM/GEM-T"] <- "long-range"
iiss$equipment_subname[iiss$unit_name == "53T6 (ABM-3 Gazelle)" |
                         iiss$unit_name == "9M96 (S-400)/Sh-08 Gazelle)"  |
                         iiss$unit_name == "SH-08 Gazelle"   |
                         iiss$unit_name == "ABM" |
                         iiss$unit_name == "SH-11 Gorgon"] <- "ABM"
iiss$equipment_subname[iiss$equipment_type == "air defence" & 
                         iiss$unit_name %in% c("SA-2 Guideline", "Rapier", "Improved HAWK", "SA-2 bn", 
                                               "PAC-3 Patriot", "Skyguard towed SAM", "Amoun", 
                                               "Amoun (Skyguard/RIM-7F Sparrow, some 36 twin 35mm guns, some 36 quad SAM)",
                                               "quad SAM", "twin 35mm guns")] <- "TOWED"
iiss$equipment_subname[iiss$equipment_type == "air defence" & 
                         iiss$unit_name %in% c("Roland II", "SA-4 bde", "SA-4", "SA-6", "SA-9", "SA-13", "SA-12",
                                               "Sinai-23 short-range", "BOV-1 SP")] <- "SP"
iiss$equipment_subname[iiss$equipment_type == "air defence" & 
                         iiss$unit_name %in% c("Starburst", "RBS-15", "SA-2/-3/-5", "SA-2/-3/-4/-5", "SA-2", "Mistral", "I HAWK")] <- "MANPAD"

# Equipment_name
iiss$equipment_name[iiss$unit_name == "53T6 (ABM-3 Gazelle)" |
                      iiss$unit_name == "9M96 (S-400)/Sh-08 Gazelle)"  |
                      iiss$unit_name == "SH-08 Gazelle"   |
                      iiss$unit_name == "ABM" |
                      iiss$unit_name == "SH-11 Gorgon"] <- "SAM"
iiss$equipment_name[iiss$unit_name == "MIM-104F Patriot PAC-3/PAC-3 MSE"] <- "SAM"
iiss$equipment_name[iiss$unit_name == "1,800 S-300 (SA-10 Grumble)"] <- "SAM"
iiss$equipment_name[iiss$unit_name ==  "96 S-400 (SA-21 Growler)"] <- "SAM"
iiss$equipment_name[iiss$unit_name == "AMX-VTT"] <- "SP"
iiss$equipment_name[iiss$equipment_type == "air defence" & 
                      iiss$equipment_subname == "TOWED" &
                         iiss$unit_name %in% c("SA-2 Guideline", "Rapier", "Improved HAWK", "SA-2 bn", 
                                               "PAC-3 Patriot", "Skyguard towed SAM", "Amoun", 
                                               "Amoun (Skyguard/RIM-7F Sparrow, some 36 twin 35mm guns, some 36 quad SAM)",
                                               "quad SAM", "twin 35mm guns")] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                         iiss$equipment_subname == "SP" & 
                         iiss$unit_name %in% c("Roland II", "SA-4 bde", "SA-4", "SA-6", "SA-9", "SA-13", "SA-12")] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" & 
                         iiss$unit_name %in% c("AIM-120B AMRAAM", "R-27 (AA-10 Alamo)")] <- "AAM"
iiss$equipment_name[iiss$equipment_type == "air defence" & 
                         iiss$unit_name %in% c("Kh-23(AS-7Kerry)", "AGM-88B HARM")] <- "ASM"
iiss$equipment_name[iiss$equipment_type == "air defence" & 
                         iiss$equipment_subname == "MANPAD" & 
                         iiss$unit_name %in% c("Starburst", "RBS-15", "SA-2/-3/-5", "SA-2/-3/-4/-5", "SA-2", "Mistral", "I HAWK")] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" & 
                      iiss$equipment_subtype == "missiles" & 
                      is.na(iiss$equipment_name) &
                      is.na(iiss$unit_name)] <- "SAM"
iiss$equipment_name[iiss$unit_name == "Avenger"] <- "SAM"

iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$unit_name %in% c("Chaparral",
                                            "Hawk",
                                            "MIM-23 HAWK",
                                            "Nike Hercules",
                                            "SA-6 Gainful",
                                            "SP",
                                            "SP/SA-7 Grail")] <- "SAM"

iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$unit_name == "Yug M-55"] <- "AA"

# Equipment_subtype
iiss$equipment_subtype[iiss$unit_name == "MIM-104F Patriot PAC-3/PAC-3 MSE"] <- NA
iiss$equipment_subtype[iiss$unit_name == "NASAMS"] <- "missiles"
iiss$equipment_subtype[iiss$unit_name == "MIM-104D/E Patriot PAC-2 GEM/GEM-T"] <- NA
iiss$equipment_subtype[iiss$unit_name == "M998 HMMVW"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "air defence" & 
                      iiss$equipment_name == "SAM" & 
                      iiss$equipment_subname == "TOWED" &
                         iiss$unit_name %in% c("SA-2 Guideline", "Rapier", "Improved HAWK", "SA-2 bn", 
                                               "PAC-3 Patriot", "Skyguard towed SAM", "Amoun", 
                                               "Amoun (Skyguard/RIM-7F Sparrow, some 36 twin 35mm guns, some 36 quad SAM)",
                                               "quad SAM", "twin 35mm guns")] <- NA
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         iiss$equipment_subname == "SP" & 
                         iiss$unit_name %in% c("Sinai-23 short-range", "BOV-1 SP")] <- "GUNS"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                      iiss$equipment_name == "SAM" & 
                         iiss$equipment_subname == "SP" & 
                         iiss$unit_name %in% c("Roland II", "SA-4 bde", "SA-4", "SA-6", "SA-9", "SA-13", "SA-12")] <- NA
iiss$equipment_subtype[iiss$equipment_type == "air defence" & 
                         (iiss$equipment_name == "AAM" | iiss$equipment_name == "ASM") & 
                         iiss$unit_name %in% c("Kh-23(AS-7Kerry)", "AGM-88B HARM", "AIM-120B AMRAAM", "R-27 (AA-10 Alamo)")] <- NA
iiss$equipment_subtype[iiss$equipment_type == "air defence" & 
                         iiss$equipment_name == "SAM" & 
                         iiss$equipment_subname == "MANPAD" & 
                         iiss$unit_name %in% c("Starburst", "RBS-15", "SA-2/-3/-5", "SA-2/-3/-4/-5", "SA-2", "Mistral", "I HAWK")] <- NA
iiss$equipment_name[iiss$equipment_type == "air defence" & 
                         iiss$unit_name == "guns"] <- "GUNS"
iiss$equipment_name[iiss$equipment_type == "air defence" & 
                         is.na(iiss$equipment_subtype) & 
                         iiss$unit_name == "arty"] <- "GUNS"

# Equipment_type
iiss$equipment_type[iiss$unit_name == "1,800 S-300 (SA-10 Grumble)"] <- "air defence"

iiss$equipment_type[iiss$unit_name == "53T6 (ABM-3 Gazelle)" |
                      iiss$unit_name == "9M96 (S-400)/Sh-08 Gazelle)" |
                      iiss$unit_name == "SH-08 Gazelle"  |
                      iiss$unit_name == "ABM" |
                      iiss$unit_name == "SH-11 Gorgon"] <- "air defence"

iiss$equipment_type[iiss$unit_name ==  "96 S-400 (SA-21 Growler)"] <- "air defence"

iiss$equipment_type[iiss$unit_name == "M998 HMMVW"] <- "air defence"
```

#### Equipment_subname
```{r}
# Unit name
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                         iiss$unit_name %in% c("SP",
                                               "SP/SA-7 Grail")] <- "SP"

# Equipment_subname
iiss$equipment_subname[iiss$equipment_subname == "9K35Strela-10" |
                         iiss$equipment_subname == "9K32Strela-2"] <- NA

iiss$equipment_subname[iiss$equipment_subname == "GDF"] <- NA

iiss$equipment_subname[iiss$equipment_subname == "R530"] <- NA

iiss$equipment_subtype[iiss$equipment_subname == "SP"] <- "SP"
iiss$equipment_subname[iiss$equipment_subname == "SP"] <- NA

iiss$equipment_name[iiss$equipment_subname == "STATIC/SHELTER"] <- "STATIC/SHELTER"
iiss$equipment_subname[iiss$equipment_subname == "STATIC/SHELTER"] <- NA

# Equipment_name
iiss$equipment_name[grepl("TOWED", iiss$equipment_subname)] <- "TOWED"
iiss$equipment_name[grepl("SP", iiss$equipment_subname)] <- "SP"
iiss$equipment_subname <- gsub("TOWED", '', iiss$equipment_subname)
iiss$equipment_subname <- gsub("SP", '', iiss$equipment_subname)
```

#### Equipment_name 
```{r}
# Unit_name
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      (iiss$unit_name == "Type 55 and Type 57 Bofors" |
                         iiss$unit_name == "Types 55 and Type 57 Bofors" |
                         iiss$unit_name == "Types 55 and 57 Bofors")] <- "GUNS"

iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$unit_name == "M-65"] <- "GUNS"

iiss$equipment_name[iiss$equipment_type == "air defence" &
                      (iiss$unit_name == "ZU-23-2 AA guns" |
                         iiss$unit_name == "ZU-23")] <- "GUNS"

iiss$equipment_name[iiss$equipment_type == "air defence" &
                      (iiss$unit_name == "Yug M-55" |
                         iiss$unit_name == "Z/65" |
                         iiss$unit_name == "Z/75")] <- "GUNS"

iiss$equipment_name[iiss$equipment_type == "air defence" &
                      (iiss$unit_name == "Super-Bat" |
                         iiss$unit_name == "Thin Skin" |
                         iiss$unit_name == "Long Track (SA-4/-6)")] <- "RADAR"

iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$unit_name == "SP"] <- "SAM"

iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$equipment_name == "SSM/SAM" &
                      iiss$unit_name == "Standard"] <- "SAM"

iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$unit_name == "Honest John"] <- "SSM"

iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$unit_name == "M-42"] <- "SP"

iiss$equipment_name[iiss$equipment_type == "air defence" &
                      (iiss$unit_name == "GDF-001" |
                         iiss$unit_name == "Oerlikon" |
                         iiss$unit_name == "Rapier/BLindfire" |
                         iiss$unit_name == "Rapier/Blindfire" |
                         iiss$unit_name == "Skyguard" |
                         iiss$unit_name == "Skyguard/Sparrow")] <- "TOWED"

iiss$equipment_type[iiss$unit_name == "Flat Face" |
                      iiss$unit_name == "Land Roll" |
                      iiss$unit_name == "Pat Hand" |
                      iiss$unit_name == "P-50 Bar Lock"] <- "radars"

iiss$equipment_name[iiss$unit_name == "Flat Face"] <- "SAM-associated short-range"
iiss$equipment_name[iiss$unit_name == "Land Roll" |
                      iiss$unit_name == "P-50 Bar Lock"] <- "search, surveillance, target acquisition"
iiss$equipment_name[iiss$unit_name == "Straight Flush"] <- "early warning"

# Equipment_subname
iiss$equipment_name[iiss$equipment_subname == "MANPAD"] <- "SAM"

# Equipment_name
iiss$equipment_name[iiss$equipment_name == "AIM"] <- "AAM"
iiss$equipment_name[iiss$equipment_name == "AAIM"] <- "AAM"
iiss$equipment_name[iiss$equipment_name == "MISSILES"] <- NA
iiss$equipment_type[iiss$equipment_name == "AA artillery fire control"] <- "air defence"
iiss$equipment_name[iiss$equipment_name == "AA artillery fire control"] <- "AA"

iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$unit_name %in% c("AIM-9 Sidewinder",
                                            "Firestreak",
                                            "R-550 Magic",
                                            "Red Top",
                                            "Super R-530")] <- "AAM"

iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$unit_name %in% c("Armat")] <- "ARM"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                      iiss$unit_name %in% c("Armat")] <- NA

iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$unit_name %in% c("AA guns",
                                            "M-1A1",
                                            "M/A1")] <- "GUNS"

iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$unit_name %in% c("SA-18")] <- "SAM"
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                      iiss$unit_name %in% c("SA-18")] <- "MANPAD"

iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$unit_name %in% c("AA arty",
                                            "M998 HMMVW",
                                            "B/L-64 (Bloodhound)",
                                            "Bloodhound",
                                            "Vulcan",
                                            "ZSU-23-4",
                                            "ZSU-57-2")] <- "SAM"

iiss$equipment_subname[iiss$equipment_type == "air defence" &
                      iiss$unit_name %in% c("Charioteer",
                                            "Roland II",
                                            "S-60",
                                            "9K33 Osa (SA-8 Gecko)")] <- "SP"

iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                      iiss$unit_name %in% c("Charioteer",
                                            "Roland II",
                                            "Roland I",
                                            "Roland",
                                            "S-60",
                                            "9K33 Osa (SA-8 Gecko)")] <- NA

iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$unit_name %in% c("Charioteer",
                                            "Roland II",
                                            "Roland I",
                                            "Roland",
                                            "S-60",
                                            "9K33 Osa (SA-8 Gecko)")] <- "SAM"

iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$unit_name %in% c("2K22 Tunguska (SA-19 Grison)",
                                            "Gerpard")] <- "SPAAGM"

iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$unit_name %in% c("Excalibur")] <- "SSM"

iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                      iiss$equipment_name == "early warning"] <- "land-based systems"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$equipment_subtype == "land-based systems"] <- "SAM RADARS"

# Equipment_subtype

```

#### Equipment_subtype
```{r}
# Equipment_subtype
iiss$unit_count[iiss$equipment_subtype == "IN STORE"] <- 0
iiss$equipment_subtype[iiss$equipment_subtype == "IN STORE"] <- NA

iiss <- iiss %>%
  dplyr::filter(equipment_subtype != "arty/SSM/inf" |
                  is.na(equipment_subtype))

iiss$equipment_subtype[iiss$equipment_subtype == "AD"] <- NA

iiss$equipment_subtype[iiss$unit_name == "Roland II"] <- "SAM"
iiss$equipment_subtype[iiss$unit_name == "SA-18"] <- "SAM"

iiss$equipment_subtype[iiss$equipment_subname == "ABM"] <- "ABM"
iiss$equipment_subname[iiss$equipment_subname == "ABM"] <- "ABM"

iiss$equipment_name[iiss$equipment_name == "SP" &
                         iiss$equipment_subname == "SP"] <- "SAM"

iiss$equipment_name[iiss$equipment_subtype == "SAM" &
                         iiss$equipment_name == "MANPAD"] <- "SAM"

iiss$equipment_name[iiss$equipment_subtype == "SPAAGM"] <- "SPAAGM"

iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$equipment_subtype == "AAM"] <- "AAM"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                      iiss$equipment_name == "AAM"] <- NA

iiss$equipment_subtype[iiss$equipment_subtype %in% c("SP",
                                                     "SAM",
                                                     "ARM",
                                                     "SPAAGM")] <- NA
```

#### Equipment_type
Fix incorrect unit_name that should have equipment_type = air defence
```{r}
iiss$unit_name[iiss$equipment_type == "air defence" &
                 iiss$equipment_name == "AMRAAM"] <- "AMRAAM"
iiss$unit_name[iiss$equipment_type == "air defence" &
                 iiss$equipment_name == "Sidewinder"] <- "Sidewinder"
iiss$unit_name[iiss$equipment_type == "air defence" &
                 iiss$equipment_name == "Sparrow"] <- "Sparrow"
```

Fix incorrect equipment_subname that should have equipment_type = air defence
```{r}
# Convert to ABM
iiss$equipment_subname[iiss$equipment_type == "missiles" &
                         (iiss$equipment_subtype == "strategic" |
                            is.na(iiss$equipment_subtype)) &
                         iiss$equipment_name == "ABM"] <- "ABM"
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "ABM" &
                         is.na(iiss$equipment_name) &
                         is.na(iiss$equipment_subname)] <- "ABM"
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "ABM" &
                         is.na(iiss$equipment_subname)] <- "ABM"

# Convert to ARM
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                         iiss$equipment_name == "ARM"] <- "ARM"

# Convert to tactical
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "tactical"] <- "tactical"

# Convert to NA 
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                      iiss$equipment_name == "SAM" &
                      iiss$equipment_subname == "SAM"] <- NA
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SAM" &
                         iiss$equipment_subname == "long-range"] <- NA
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SAM" &
                         iiss$equipment_subname == "short-range"] <- NA
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SAM" &
                         iiss$equipment_subname == "point-defence"] <- NA
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "missiles" &
                         iiss$equipment_name == "AShM" &
                         iiss$equipment_subname == "AShM"] <- NA
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "missiles" &
                         iiss$equipment_name == "SAM" &
                         iiss$equipment_subname == "NAVAL"] <- NA

# Convert to SARH
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "missiles" &
                         iiss$equipment_name == "SARH"] <- "SARH"

# Convert to MANPAD
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "missiles" &
                         iiss$equipment_name == "MANPAD" &
                         is.na(iiss$equipment_subname)] <- "MANPAD"
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SAM-MANPAD" &
                         is.na(iiss$equipment_subname)] <- "MANPAD"
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "SAM" &
                         iiss$equipment_name == "MANPAD" &
                         is.na(iiss$equipment_subname)] <- "MANPAD"
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "SAM" &
                         iiss$equipment_name == "MANPADS" &
                         is.na(iiss$equipment_subname)] <- "MANPAD"
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "MANPAD" &
                         is.na(iiss$equipment_name) &
                         is.na(iiss$equipment_subname)] <- "MANPAD"
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SAM" &
                         iiss$equipment_subname == "MANPD"] <- "MANPAD"
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name %in% c("SAM-MANPAD", "MANPAD") &
                         iiss$equipment_subname == "point-defence"] <- "MANPAD"
iiss$equipment_subname[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SAM-MANPAD" &
                         is.na(iiss$equipment_subname)] <- "MANPAD"
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "MANPAD" &
                         is.na(iiss$equipment_subname)] <- "MANPAD"
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "MANPADS" &
                         is.na(iiss$equipment_subname)] <- "MANPAD"
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "missiles" &
                         iiss$equipment_name == "MANPAD"] <- "MANPAD"
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                      iiss$equipment_name == "LAUNCHER"] <- "MANPAD"

# Convert to STATIC/SHELTER
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "missiles" &
                         iiss$equipment_name == "SAM" &
                         iiss$equipment_subname == "STATIC"] <- "STATIC/SHELTER"
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "SAM" &
                         iiss$equipment_name == "STATIC" &
                         is.na(iiss$equipment_subname)] <- "STATIC/SHELTER"
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "SAM" &
                         iiss$equipment_name == "STATIC/SHELTER" &
                         is.na(iiss$equipment_subname)] <- "STATIC/SHELTER"
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SAM-STATIC" &
                         is.na(iiss$equipment_subname)] <- "STATIC/SHELTER"
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "STATIC" &
                         is.na(iiss$equipment_subname)] <- "STATIC/SHELTER"

# Convert to SP
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SAM-SP" &
                         is.na(iiss$equipment_subname)] <- "SP"
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "SAM" &
                         iiss$equipment_name == "SP" &
                         is.na(iiss$equipment_subname)] <- "SP"
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "missiles" &
                         iiss$equipment_name == "SP" &
                         is.na(iiss$equipment_subname)] <- "SP"
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "SAM" &
                         iiss$equipment_name == "SP" &
                         is.na(iiss$equipment_subname)] <- "SP"
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "long-range" &
                         iiss$equipment_name == "SAM-SP" &
                         is.na(iiss$equipment_subname)] <- "SP"
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SAM-SP" &
                         iiss$equipment_subname == "point-defence"] <- "SP"
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "long-range" &
                         iiss$equipment_name == "SAM-SP" &
                         is.na(iiss$equipment_subname)] <- "SP"
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         is.na(iiss$equipment_name) &
                         is.na(iiss$equipment_subname)] <- "SP"
iiss$equipment_subname[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                         is.na(iiss$equipment_subtype) &
                         (iiss$equipment_name == "SAM-SP" |
                            iiss$equipment_name == "SP") &
                         is.na(iiss$equipment_subname)] <- "SP"
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                      iiss$equipment_subtype == "SP" &
                      is.na(iiss$equipment_name) &
                      is.na(iiss$equipment_subname)] <- "SP"
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SP" &
                         is.na(iiss$equipment_subname)] <- "SP"
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SP SAM" &
                         is.na(iiss$equipment_subname)] <- "SP"
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "missiles" &
                         iiss$equipment_name == "SP SAM"] <- "SP"
iiss$equipment_subname[iiss$equipment_type == "air defence" & 
                         iiss$equipment_name == "SP"] <- "SP"

# Convert to TOWED
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SAM-TOWED" &
                         (iiss$equipment_subname == "long-range" |
                            iiss$equipment_subname == "long range")] <- "TOWED"
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "SAM" &
                         iiss$equipment_name == "TOWED" &
                         is.na(iiss$equipment_subname)] <- "TOWED"
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "SAM" &
                         iiss$equipment_name == "TOWED" &
                         iiss$equipment_subname == "MIM-23"] <- "TOWED"
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SAM-TOWED" &
                         is.na(iiss$equipment_subname)] <- "TOWED"
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "TOWED" &
                         is.na(iiss$equipment_subname)] <- "TOWED"
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "TOWED SAM" &
                         is.na(iiss$equipment_subname)] <- "TOWED"
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SAM TOWED" &
                         is.na(iiss$equipment_subname)] <- "TOWED"

# Convert to NAVAL
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "SAM" &
                         iiss$equipment_name == "NAVAL" &
                         is.na(iiss$equipment_subname)] <- "NAVAL"

# Convert to ground-based interceptors
iiss$equipment_subname[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "land-based systems" &
                         iiss$equipment_name == "ground-based interceptors" &
                         is.na(iiss$equipment_subname)] <- "ground-based interceptors"
```

Fix incorrect equipment_name that should have equipment_type = air defence
```{r}
# Convert to SAM
iiss$equipment_name[iiss$equipment_type == "missiles" &
                        (iiss$equipment_subtype == "strategic" |
                           is.na(iiss$equipment_subtype)) &
                        iiss$equipment_name == "ABM" &
                        iiss$equipment_subname == "ABM"] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$equipment_name == "AD" &
                      iiss$equipment_subname == "SAM"] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "missiles" &
                         iiss$equipment_subtype == "SAM"] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$equipment_subtype == "missiles" &
                      iiss$equipment_name == "MANPAD" &
                      iiss$equipment_subname == "MANPAD"] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      is.na(iiss$equipment_subtype) &
                      iiss$equipment_name == "SAM-MANPAD" &
                      iiss$equipment_subname == "MANPAD"] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      is.na(iiss$equipment_subtype) &
                      iiss$equipment_name == "SAM-SP" &
                      iiss$equipment_subname == "SP"] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      is.na(iiss$equipment_subtype) &
                      iiss$equipment_name == "SAM-TOWED" &
                      iiss$equipment_subname == "TOWED"] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$equipment_subtype == "SAM" &
                      iiss$equipment_name == "MANPAD" &
                      iiss$equipment_subname == "MANPAD"] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$equipment_subtype == "SAM" &
                      iiss$equipment_name == "MANPADS" &
                      iiss$equipment_subname == "MANPAD"] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$equipment_subtype == "SAM" &
                      is.na(iiss$equipment_name)  &
                      is.na(iiss$equipment_subname)] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$equipment_subtype == "SAM" &
                      iiss$equipment_name == "SP" &
                      iiss$equipment_subname == "SP"] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$equipment_subtype == "SAM" &
                      iiss$equipment_name == "TOWED" &
                      iiss$equipment_subname == "TOWED"] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$equipment_subtype == "SAM" &
                      iiss$equipment_name == "STATIC" &
                      iiss$equipment_subname == "STATIC/SHELTER"] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$equipment_subtype == "missiles" &
                      iiss$equipment_name == "SP" &
                      iiss$equipment_subname == "SP"] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$equipment_subtype == "SAM" &
                      iiss$equipment_name == "TOWED" &
                      iiss$equipment_subname == "TOWED"] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$equipment_subtype == "SAM" &
                      iiss$equipment_name == "SP" &
                      iiss$equipment_subname == "SP"] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$equipment_subtype == "SAM" &
                      iiss$equipment_name == "STATIC/SHELTER" &
                      iiss$equipment_subname == "STATIC/SHELTER"] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$equipment_subtype == "MANPAD" &
                      is.na(iiss$equipment_name) &
                      iiss$equipment_subname == "MANPAD"] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      is.na(iiss$equipment_subtype) &
                      iiss$equipment_name == "SAM-TOWED" &
                      iiss$equipment_subname == "TOWED"] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      is.na(iiss$equipment_subtype) &
                      iiss$equipment_name == "SAM-STATIC" &
                      iiss$equipment_subname == "STATIC/SHELTER"] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      is.na(iiss$equipment_subtype) &
                      iiss$equipment_name == "STATIC" &
                      iiss$equipment_subname == "STATIC/SHELTER"] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      is.na(iiss$equipment_subtype) &
                      iiss$equipment_name == "TOWED" &
                      iiss$equipment_subname == "TOWED"] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$equipment_subtype == "ABM" &
                      is.na(iiss$equipment_name) &
                      iiss$equipment_subname == "ABM"] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      is.na(iiss$equipment_subtype) &
                      iiss$equipment_name  == "ABM" &
                      iiss$equipment_subname == "ABM"] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$equipment_subtype == "AD" &
                      is.na(iiss$equipment_name) &
                      is.na(iiss$equipment_subname)] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$equipment_subtype == "long-range" &
                      iiss$equipment_name == "SAM-SP" &
                      iiss$equipment_subname == "SP"] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      is.na(iiss$equipment_subtype) &
                      iiss$equipment_name == "SAM-MANPAD" &
                      iiss$equipment_subname == "MANPAD"] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      is.na(iiss$equipment_subtype) &
                      iiss$equipment_name == "SAM-SP" &
                      iiss$equipment_subname == "SP"] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                      is.na(iiss$equipment_subtype) &
                      iiss$equipment_name == "SAM-MANPAD" &
                      iiss$equipment_subname == "MANPAD"] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                      iiss$equipment_subtype == "SAM" &
                      is.na(iiss$equipment_name) &
                      is.na(iiss$equipment_subname)] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      is.na(iiss$equipment_subtype) &
                      iiss$equipment_name == "MANPAD" &
                      iiss$equipment_subname == "MANPAD"] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      is.na(iiss$equipment_subtype) &
                      iiss$equipment_name == "TOWED SAM" &
                      iiss$equipment_subname == "TOWED"] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      is.na(iiss$equipment_subtype) &
                      iiss$equipment_name == "SAM TOWED" &
                      iiss$equipment_subname == "TOWED"] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      is.na(iiss$equipment_subtype) &
                      iiss$equipment_name == "MANPADS" &
                      iiss$equipment_subname == "MANPAD"] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      is.na(iiss$equipment_subtype) &
                      is.na(iiss$equipment_name) &
                      iiss$equipment_subname == "RADAR"] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$equipment_subtype == "long-range" &
                      iiss$equipment_name == "SAM-SP" &
                      iiss$equipment_subname == "SP"] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      is.na(iiss$equipment_subtype) &
                      is.na(iiss$equipment_name) &
                      iiss$equipment_subname == "SP"] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$equipment_subtype == "SAM" &
                      iiss$equipment_name == "AD"] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                      is.na(iiss$equipment_subtype) &
                      (iiss$equipment_name == "SAM-SP" |
                         iiss$equipment_name == "SP") &
                      iiss$equipment_subname == "SP"] <- "SAM"
iiss$equipment_name[iiss$equpment_type == "air defence" &
                      iiss$equipment_subtype == "missiles" &
                      is.na(iiss$equipment_name) &
                      iiss$unit_name %like% "SA%"] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$equipment_subtype == "SAM" &
                      iiss$equipment_name == "NAVAL" &
                      iiss$equipment_subname == "NAVAL"] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$equipment_subtype == "SP" &
                      is.na(iiss$equipment_name) &
                      iiss$equipment_subname == "SP"] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      is.na(iiss$equipment_subtype) &
                      iiss$equipment_name == "SP" &
                      iiss$equipment_subname == "SP"] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      is.na(iiss$equipment_subtype) &
                      iiss$equipment_name == "SP SAM" &
                      iiss$equipment_subname == "SP"] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$equipment_subtype == "land-based systems" &
                      iiss$equipment_name == "ground-based interceptors" &
                      is.na(iiss$equipment_subname)] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$equipment_subtype == "missiles" &
                      iiss$equipment_name == "MANPAD"] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "missiles" &
                         iiss$equipment_name == "SP SAM" &
                         iiss$equipment_subname == "SP"] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                         iiss$equipment_name == "LAUNCHER" &
                      iiss$equipment_subname == "MANPAD"] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$equipment_subtype == "missiles" &
                      iiss$equipment_name == "SP"] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$equipment_name == "MCO"] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$equipment_name == "ADF"] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "MSLS" & 
                      iiss$equipment_subtype == "SAM" & 
                      is.na(iiss$equipment_name)] <- "SAM" 
iiss$equipment_name[iiss$equipment_type == "air defence" & 
                      is.na(iiss$equipment_subtype) & 
                      (iiss$equipment_name == "AD ARTY" | iiss$equipment_name == "AD") & 
                      is.na(iiss$equipment_subname) & 
                      (iiss$unit_name == "indep AD regts" | is.na(iiss$unit_name))] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" & 
                      iiss$equipment_subtype == "missiles" & 
                      iiss$equipment_name == "MCO" & 
                      is.na(iiss$equipment_subname) & 
                      iiss$unit_name == "Avenger"] <- "SAM"
iiss$equipment_name[iiss$equipment_type == "air defence" & 
                      is.na(iiss$equipment_name) & 
                      iiss$unit_name == "Samlet"] <- "SAM"

# Convert to AAM
iiss$equipment_name[iiss$equipment_type == "surface-to-surface missile launchers" &
                        is.na(iiss$equipment_subtype) &
                        iiss$equipment_name == "ASRAAM" &
                        is.na(iiss$equipment_subname)] <- "AAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$equipment_subtype == "missiles" &
                      iiss$equipment_name == "SARH" &
                      iiss$equipment_subname == "SARH"] <- "AAM"
iiss$equipment_name[iiss$equipment_type == "missiles" &
                      iiss$equipment_subtype == "AAM"] <- "AAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$equipment_name == "ARM" &
                      iiss$equipment_subname == "ARM"] <- "AAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                 iiss$equipment_name == "AMRAAM"] <- "AAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                 iiss$equipment_name == "Sidewinder"] <- "AAM"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$equipment_name == "Sparrow"] <- "AAM"

# Convert to ASM
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$equipment_subtype == "ASM"] <- "ASM"
iiss$equipment_name[iiss$equipment_type == "surface-to-surface missile launchers" &
                      is.na(iiss$equipment_subtype) &
                      iiss$equipment_name == "AAM" &
                      iiss$equipment_subname == "ASM"] <- "ASM"

# Convert to SP
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$equipment_subtype == "SP" &
                      is.na(iiss$equipment_name) &
                      iiss$equipment_subname == "20mm"] <- "SP"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$equipment_subtype == "SP" &
                      is.na(iiss$equipment_name) &
                      iiss$equipment_subname == "40mm"] <- "SP"

# Convert to AShM
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$equipment_subtype == "missiles" &
                      iiss$equipment_name == "AAM" &
                      iiss$equipment_subname == "AShM"] <- "AShM"

# Convert to TOWED
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      is.na(iiss$equipment_subtype) &
                      iiss$equipment_name == "GUNS-TOWED"] <- "TOWED"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$equipment_subtype == "AT" &
                      iiss$equipment_name == "GUNS"] <- "TOWED"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$equipment_subtype == "TOWED" &
                      is.na(iiss$equipment_name)] <- "TOWED"

# Convert to SP
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      is.na(iiss$equipment_subtype) &
                      iiss$equipment_name == "GUNS-SP"] <- "SP"

# Convert to NA
iiss$equipment_name[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "GUNS" &
                         (iiss$equipment_name == "AA GUNS" |
                            iiss$equipment_name == "AD arty")] <- "AA"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$equipment_subname == "ARM"] <- NA
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$equipment_subtype == "GUNS" &
                      iiss$equipment_name == "GUNS"] <- NA
iiss$equipment_name[(iiss$equipment_type == "air defence" |
                      iiss$equipment_subtype == "GUNS") &
                      iiss$equipment_name %in% c("AD",
                                                 "AD GUNS")] <- "AA"
```

Fix incorrect equipment_subtype that should have equipment_type = air defence
```{r}
# Convert to missiles
iiss$equipment_subtype[iiss$equipment_type == "missiles" &
                           (iiss$equipment_subtype == "strategic" |
                              is.na(iiss$equipment_subtype)) &
                           iiss$equipment_name == "SAM" &
                           iiss$equipment_subname == "ABM"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SAM"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "missiles" &
                      iiss$equipment_subtype == "SAM" &
                        iiss$equipment_name == "SAM"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "missiles" &
                      iiss$equipment_name == "SAM"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "missiles" &
                         iiss$equipment_subtype == "AAM" &
                         iiss$equipment_name == "AAM"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SAM" &
                         iiss$equipment_subname == "MANPAD"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SAM" &
                         is.na(iiss$equipment_subname)] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SAM" &
                         iiss$equipment_subname == "SP"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SAM" &
                         iiss$equipment_subname == "TOWED"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SAM" &
                         iiss$equipment_subname == "STATIC"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SAM" &
                         iiss$equipment_subname == "MANPAD"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SAM" &
                         iiss$equipment_subname == "SP"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SAM" &
                         iiss$equipment_subname == "TOWED"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "SAM" &
                         iiss$equipment_name == "SAM" &
                         iiss$equipment_subname == "MANPAD"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "SAM" &
                         iiss$equipment_name == "SAM" &
                         iiss$equipment_subname == "MANPAD"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "SAM" &
                         iiss$equipment_name == "SAM" &
                         is.na(iiss$equipment_subname)] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "SAM" &
                         iiss$equipment_name == "SAM" &
                         iiss$equipment_subname == "SP"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "SAM" &
                         iiss$equipment_name == "SAM" &
                         iiss$equipment_subname == "TOWED"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "SAM" &
                         iiss$equipment_name == "SAM" &
                         iiss$equipment_subname == "STATIC/SHELTER"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "SAM" &
                         iiss$equipment_name == "SAM" &
                         iiss$equipment_subname == "TOWED"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "SAM" &
                         iiss$equipment_name == "SAM" &
                         iiss$equipment_subname == "SP"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "SAM" &
                         iiss$equipment_name == "SAM" &
                         iiss$equipment_subname == "STATIC/SHELTER"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "MANPAD" &
                         iiss$equipment_name == "SAM" &
                         iiss$equipment_subname == "MANPAD"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         is.na(iiss$equipment_name) &
                         is.na(iiss$equipment_subname)] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SAM" &
                         iiss$equipment_subname == "MANPAD"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SAM" &
                         iiss$equipment_subname == "TOWED"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SAM" &
                         iiss$equipment_subname == "STATIC/SHELTER"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SAM" &
                         iiss$equipment_subname == "STATIC/SHELTER"] <- "missile"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SAM" &
                         iiss$equipment_subname == "TOWED"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "ABM" &
                         iiss$equipment_name == "SAM" &
                         iiss$equipment_subname == "ABM"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SAM" &
                         iiss$equipment_subname == "ABM"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "AD" &
                         iiss$equipment_name == "SAM" &
                         is.na(iiss$equipment_subname)] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SAM" &
                         is.na(iiss$equipment_subname)] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "long-range" &
                         iiss$equipment_name == "SAM" &
                         iiss$equipment_subname == "SP"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SAM" &
                         is.na(iiss$equipment_subname)] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SAM" &
                         iiss$equipment_subname == "MANPAD"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SAM" &
                         iiss$equipment_subname == "SP"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SAM" &
                         is.na(iiss$equipment_subname)] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SAM" &
                         iiss$equipment_subname == "MANPAD"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                         iiss$equipment_subtype == "SAM" &
                         iiss$equipment_name == "SAM" &
                         is.na(iiss$equipment_subname)] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SAM" &
                         iiss$equipment_subname == "MANPAD"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SAM" &
                         iiss$equipment_subname == "TOWED"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SAM" &
                         iiss$equipment_subname == "MANPAD"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SAM" &
                         iiss$equipment_subname == "RADAR"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SAM" &
                         iiss$equipment_subname == "RADAR"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "long-range" &
                         iiss$equipment_name == "SAM" &
                         iiss$equipment_subname == "SP"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SAM" &
                         iiss$equipment_subname == "SP"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                      iiss$equipment_subtype == "SAM" &
                      iiss$equipment_name == "SAM"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SAM" &
                         iiss$equipment_subname == "SP"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SAM" &
                         is.na(iiss$equipment_subname)] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "MANPAD" &
                         is.na(iiss$equipment_subname)] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "SAM" &
                         iiss$equipment_name == "SAM" &
                         iiss$equipment_subname == "NAVAL"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "SP" &
                         iiss$equipment_name == "SAM" &
                         iiss$equipment_subname == "SP"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SAM" &
                         iiss$equipment_subname == "SP"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SAM" &
                         iiss$equipment_subname == "SP"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "strategic defenses - missile defenses" &
                         iiss$equipment_subtype == "land-based systems" &
                         iiss$equipment_name == "SAM" &
                         iiss$equipment_subname == "ground-based interceptor"] <- "missile"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                      iiss$equipment_subtype == "SAM" &
                      iiss$equipment_name == "SAM"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                          iiss$equipment_subtype == "corvettes" &
                          (iiss$unit_name == "Barak VLS" |
                             iiss$unit_name == "Selenia")] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "surface-to-surface missile launchers" &
                         iiss$equipment_subtype == "AD"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "MSLS" & 
                         iiss$equipment_subtype == "SAM" & 
                         iiss$equipment_name == "SAM"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air defence" & 
                         (iiss$equipment_subtype == "strategic" |
                            iiss$equipment_subtype == "STRATEGIC") & 
                         iiss$equipment_name == "SAM" & 
                         iiss$equipment_subname == "ABM"] <- "missiles"

# Convert to GUNS 
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "SP" &
                         iiss$equipment_name == "SP" &
                         iiss$equipment_subname == "20mm"] <- "GUNS"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "SP" &
                         iiss$equipment_name == "SP" &
                         iiss$equipment_subname == "40mm"] <- "GUNS"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                      iiss$equipment_name == "AD GUNS"] <- "GUNS"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         (iiss$equipment_name == "AA GUNS" |
                            iiss$equipment_name == "AD arty")] <- "GUNS"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "TOWED"] <- "GUNS"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SP"] <- "GUNS"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "GUNS"] <- "GUNS"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "AD GUNS" &
                         iiss$equipment_name == "TOWED"] <- "GUNS"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "AT" &
                         iiss$equipment_name == "TOWED"] <- "GUNS"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "TOWED" &
                         iiss$equipment_name == "TOWED"] <- "GUNS"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         (iiss$equipment_name == "GUNS" |
                            iiss$equipment_name == "GUNS-TOWED" |
                            iiss$equipment_name == "TOWED" |
                            iiss$equipment_name == "GUNS-SP")] <- "GUNS"

# Convert to NA
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "tactical" &
                         iiss$equipment_subname == "tactical"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         iiss$subservice == "coastal defence" &
                  iiss$equipment_subtype == "coastal defence"] <- NA
iiss$subsubservice[iiss$equipment_type == "air defence" &
                     iiss$equipment_subtype == "AIR WING"] <- "air wing"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                     iiss$equipment_subtype == "AIR WING"] <- NA
iiss$subservice[iiss$equipment_type == "air defence" &
               iiss$equipment_subtype == "coastal defence"] <- "coastal defence"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                     iiss$equipment_subtype == "coastal defence"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                      iiss$equipment_subtype == "ASM" &
                        iiss$equipment_name == "ASM"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "AD" &
                         iiss$equipment_name == "GUNS"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "GUNS" &
                         iiss$equipment_name == "SAM"] <- NA
```

Fix incorrect equipment_type that should have equipment_type = air defence
```{r}
# Missiles
iiss$equipment_type[iiss$equipment_type == "missiles" &
                        iiss$equipment_subtype == "missiles" &
                        iiss$equipment_name == "SAM" &
                        iiss$equipment_subname == "ABM"] <- "air defence"
iiss$equipment_type[iiss$equipment_type == "missiles" &
                         iiss$equipment_subtype == "SAM" &
                         iiss$equipment_name == "SAM"] <- "air defence"

iiss$equipment_type[iiss$equipment_type == "surface-to-air missiles"] <- "air defence"
iiss$equipment_type[iiss$equipment_type == "surface-to-air-missiles"] <- "air defence"

iiss$equipment_type[iiss$equipment_name == "SAM"] <- "surface-to-surface missile launchers"

iiss$equipment_subtype[iiss$equipment_subtype == "GUNS" &
                      iiss$equipment_name == "SAM"] <- NA
iiss$equipment_name[iiss$equipment_type == "artillery" &
                      iiss$equipment_name == "SAM"] <- "air defence"

# Surface-to-surface missile launchers 
iiss$equipment_type[iiss$equipment_type == "surface-to-surface missile launchers" &
                      iiss$equipment_subtype == "missiles" &
                      iiss$equipment_name == "SARH"] <- "air defence"
iiss$equipment_type[iiss$equipment_type == "surface-to-surface missile launchers" &
                      iiss$equipment_subtype == "missiles" &
                      is.na(iiss$equipment_name) &
                      (iiss$equipment_subname == "ARH" |
                         iiss$equipment_subname == "IR/SARH")] <- "air defence"
iiss$equipment_type[iiss$country == "poland" &
                      iiss$equipment_type == "surface-to-surface missile launchers" &
                      iiss$equipment_subtype == "missiles" &
                      is.na(iiss$equipment_name) &
                      is.na(iiss$equipment_subname)] <- "air defence"
iiss$equipment_type[iiss$equipment_type == "surface-to-surface missile launchers" &
                      is.na(iiss$equipment_subtype) &
                      iiss$equipment_name == "SAM"] <- "air defence"
iiss$equipment_type[iiss$equipment_type == "missiles" &
                         iiss$equipment_subtype == "missiles" &
                         iiss$equipment_name == "SAM"] <- "air defence"
iiss$equipment_type[iiss$equipment_type == "missiles" &
                      iiss$equipment_subtype == "AAM" &
                      iiss$equipment_name == "AAM"] <- "air defence"
iiss$equipment_type[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                      iiss$equipment_subtype == "missiles" &
                      iiss$equipment_name == "SAM" &
                      is.na(iiss$equipment_subname)] <- "air defence"
iiss$equipment_type[iiss$equipment_type == "surface-to-surface missile launchers" & 
                      iiss$equipment_subtype == "missiles" & 
                      iiss$equipment_name == "AD"] <- "air defence"
iiss$equipment_type[iiss$equipment_type == "surface-to-surface missile launchers" &
                      iiss$equipment_subtype == "missiles" &
                      iiss$equipment_name == "MICA"] <- "air defence"

# Anti-tank/anti-infrastucture
iiss$equipment_type[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                      iiss$equipment_subtype == "missiles" &
                      iiss$equipment_name == "SAM" &
                      iiss$equipment_subname == "MANPAD"] <- "air defence"
iiss$equipment_type[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                      iiss$equipment_subtype == "missiles" &
                      iiss$equipment_name == "SAM" &
                      iiss$equipment_subname == "SP"] <- "air defence"
iiss$equipment_type[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                      iiss$equipment_subtype == "missiles" &
                      iiss$equipment_name == "SAM" &
                      is.na(iiss$equipment_subname)] <- "air defence"
iiss$equipment_type[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                      iiss$equipment_subtype == "missiles" &
                      iiss$equipment_name == "MANPAD" &
                      is.na(iiss$equipment_subname)] <- "air defence"

# Artillery
iiss$equipment_type[iiss$equipment_type == "artillery" &
                      iiss$equipment_subtype == "SAM"] <- "air defence"
iiss$equipment_type[iiss$equipment_type == "artillery" &
                      iiss$equipment_name == "SAM"] <- "air defence"
iiss$equipment_type[iiss$equipment_type == "artillery" &
                      iiss$equipment_name == "AD"] <- "air defence"
iiss$equipment_type[iiss$equipment_type == "artillery" &
                      iiss$equipment_name == "AD arty"] <- "air defence"
iiss$equipment_type[iiss$equipment_type == "artillery" &
                      (iiss$equipment_name == "AD arty" |
                      iiss$equipment_name == "AD")] <- "air defence"
iiss$equipment_type[iiss$equipment_type == "artillery" &
                      iiss$equipment_name == "AA GUNS"] <- "air defence"
iiss$equipment_type[iiss$equipment_type == "artillery" &
                      (iiss$equipment_name == "AD arty" | 
                         iiss$equipment_name == "AA GUNS")] <- "air defence"
iiss$equipment_type[iiss$equipment_type == "artillery" & 
                      iiss$equipment_subtype == "missiles" & 
                      iiss$equipment_name == "SAM" & 
                      iiss$equipment_subname == "TOWED"] <- "air defence"

# Helicopters
iiss$equipment_type[iiss$equipment_type == "helicopters" &
                      (iiss$equipment_name == "GUNS-TOWED" |
                         iiss$equipment_name == "GUNS-SP")] <- "air defence"
iiss$equipment_type[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "AD"] <- "air defence"
iiss$equipment_type[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "SAM"] <- "air defence"


# Patrol and coastal combatants
iiss$equipment_type[iiss$equipment_type == "patrol and coastal combatants" &
                         iiss$equipment_subname == "40mm"] <- "air defence"
iiss$equipment_type[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_name == "SAM"] <- "air defence"

# NA
iiss$equipment_type[is.na(iiss$equipment_type) &
                      (iiss$equipment_name == "AA GUNS" |
                         iiss$equipment_name == "AD" |
                         iiss$equipment_name == "AD GUNS" |
                         iiss$unit_name == "SA-7 Grail" |
                         iiss$equipment_name == "SAM" |
                         iiss$equipment_name == "SP" |
                         iiss$equipment_subtype == "SAM" |
                         iiss$equipment_name == "AD ARTY" |
                         iiss$unit_name == "Rh-202" |
                         iiss$unit_name == "L/60")] <- "air defence"
iiss$equipment_type[is.na(iiss$equipment_type) &
                      (iiss$unit_name == "SA-13" |
                         iiss$unit_name == "SA-2" |
                         iiss$unit_name == "SA-3/3A")] <- "air defence"

# Air-launched missiles
iiss$equipment_type[iiss$equipment_type == "air-launched missiles" &
                      iiss$equipment_name == "MANPAD"] <- "air defence"
iiss$equipment_type[iiss$equipment_type == "air-launched missiles" &
                      iiss$equipment_name == "SAM"] <- "air defence"

# Aircraft
iiss$equipment_type[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "ADF"] <- "air defence"

# MSLS
iiss$equipment_type[iiss$equipment_type == "MSLS" & 
                      iiss$equipment_subtype == "missiles" & 
                      iiss$equipment_name == "SAM"] <- "air defence"

# AB
iiss$equipment_type[iiss$equipment_type == "AB"] <- "air defence"

# radars 
iiss$equipment_type[iiss$equipment_type == "radars" & 
                      iiss$equipment_name == "AA" & 
                      iiss$unit_name == "guns"] <- "air defence"

# Air defence
iiss$equipment_type[iiss$unit_name == "Roland II"] <- "air defence"
iiss$equipment_type[iiss$unit_name == "SA-18"] <- "air defence"

# Squadrons
iiss$equipment_type[iiss$equipment_type == "squadrons"] <- "air defence"
```


## Air-launched missiles

### Typos
Here we fix typos, which include spelling errors, capitalization errors, and any other formatting errors that affect merging or equipment similarity

#### Unit_name typos
```{r}

```

#### Equipment_subname typos
```{r}

```

#### Equipment_name typos
```{r}
```

#### Equipment_subtype typos
```{r}

```

#### Equipment_type typos
```{r}
iiss$equipment_type[iiss$equipment_type == "MSL"] <- "air-launched missiles"
iiss$equipment_type[iiss$equipment_type == "air-to-air missile launchers"] <- "air-launched missiles"

```

### Coding changes

#### Unit_name
Fix incorrect columns based on unit_name value
```{r}
# Unit_name
iiss$unit_name[iiss$equipment_subname == "Exocet"] <- "Exocet"
iiss$equipment_subname[iiss$equipment_subname == "Exocet"] <- NA

iiss$unit_name[iiss$equipment_subname == "Kingfisher"] <- "Kingfisher"
iiss$equipment_subname[iiss$equipment_subname == "Kingfisher"] <- NA

iiss$unit_name[iiss$equipment_subname == "Sidewinder"] <- "Sidewinder"
iiss$equipment_subname[iiss$equipment_subname == "Sidewinder"] <- NA

iiss$unit_name[iiss$equipment_subname == "Sparrow"] <- "Sparrow"
iiss$equipment_subname[iiss$equipment_subname == "Sparrow"] <- NA

# Equipment_subname

# Equipment_name

# Equipment_subtype

# Equipment_type

```

#### Equipment_subname
Fix incorrect columns that should have equipment_subname = TBD
```{r}
# Equipment_subname
iiss$equipment_subname[iiss$equipment_subname == "IIR"] <- "IIR"

iiss$equipment_subname[iiss$equipment_subname == "OR"] <- "IR"

iiss$equipment_subname[iiss$equipment_subname == "Tactical-AAM"] <- "tactical"

# Equipment_name
iiss$equipment_name[iiss$equipment_subname == "IIR"] <- "AAM"

iiss$equipment_name[iiss$equipment_subname == "IR"] <- "AAM"

```

  REPEAT FOR EACH EQUIPMENT_SUBNAME AS NEEDED

#### Equipment_name
Fix incorrect columns that should have equipment_name = TBD
```{r}
# Equipment_subname
iiss$equipment_subname[iiss$equipment_name == "IIR"] <- "IIR"

iiss$equipment_subname[iiss$equipment_name == "IR"] <- "IR"

iiss$equipment_subname[iiss$equipment_name == "ARH"] <- "ARH"

iiss$equipment_subname[iiss$equipment_name == "IR/SARH"] <- "IR/SARH"

iiss$equipment_subname[iiss$equipment_name == "SARH"] <- "SARH"

iiss$equipment_name[iiss$equipment_subname == "ARM"] <- "ARM"
iiss$equipment_subname[iiss$equipment_subname == "ARM"] <- NA

iiss$equipment_subname[iiss$unit_name == "MALD/MALD-J"] <- "decoy"
iiss$equipment_name[iiss$unit_name == "MALD/MALD-J"] <- "AAM"

# Equipment_name
iiss$equipment_name[iiss$equipment_name == "ARH"] <- "AAM"

iiss$equipment_name[iiss$equipment_name == "IR/SARH" &
                      iiss$equipment_subname == "IR/SARH"] <- "AAM"

iiss$equipment_name[iiss$equipment_name == "SARH" &
                      iiss$equipment_subname == "SARH"] <- "AAM"

iiss$equipment_subtype[iiss$equipment_type == "air-launched missiles" &
                      iiss$equipment_name == "AD" &
                      iiss$unit_name == "radar units"] <- "land-based systems"
iiss$equipment_name[iiss$equipment_type == "air-launched missiles" &
                      iiss$equipment_name == "AD" &
                      iiss$unit_name == "radar units"] <- "fire control"

iiss$equipment_type[iiss$equipment_type == "air-launched missiles" &
                      iiss$equipment_name == "AD" &
                      iiss$unit_name == "SAM"] <- "air defence"
iiss$equipment_name[iiss$equipment_type == "air defence" &
                      iiss$equipment_name == "AD" &
                      iiss$unit_name == "SAM"] <- "SAM"
iiss$unit_name[iiss$equipment_type == "air defence" &
                      iiss$equipment_name == "SAM" &
                      iiss$unit_name == "SAM"] <- NA

# Equipment_subtype
iiss$equipment_subtype[iiss$equipment_name == "ALCM"] <- "missiles"

iiss$equipment_name[iiss$equipment_subtype == "ASM"] <- "ASM"

# Equipment_type
iiss$equipment_type[iiss$equipment_name == "ALCM"] <- "air-launched missiles"

```

  REPEAT FOR EACH EQUIPMENT_NAME AS NEEDED
  
#### Equipment_subtype
Fix incorrect columns that should have equipment_subtype = TBD
```{r}

```

  REPEAT FOR EACH EQUIPMENT_SUBTYPE AS NEEDED

#### Equipment_type

Fix incorrect unit_name that should have equipment_type = equipment_type
```{r}
iiss$equipment_type[iiss$equipment_name == "AAM"] <- "air-launched missiles"
iiss$equipment_subtype[iiss$equipment_name == "AAM"] <- NA

```

Fix incorrect equipment_subname that should have equipment_type = equipment_type
```{r}
# convert to tactical
iiss$equipment_subname[iiss$equipment_type == "surface-to-surface missile launchers" &
                         iiss$equipment_subtype == "tactical" &
                         iiss$equipment_name == "ASM" &
                         is.na(iiss$equipment_subname)] <- "tactical"
iiss$equipment_subname[iiss$equipment_type == "air-launched missiles" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "ASM" &
                         iiss$equipment_subname == "Tactical"] <- "tactical"

# Convert to ARH
iiss$equipment_subname[iiss$equipment_type == "air-launched missiles" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "ARH" &
                         is.na(iiss$equipment_subname)] <- "ARH"

# Convert to ARH/IIR
iiss$equipment_subname[iiss$equipment_type == "air-launched missiles" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "AAM" &
                         iiss$equipment_subname == "IIR"] <- "ARH/IIR"
iiss$equipment_subname[iiss$equipment_type == "air-launched missiles" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "IIR" &
                         is.na(iiss$equipment_subname)] <- "ARH/IIR"

# Convert to SARH
iiss$equipment_subname[iiss$equipment_type == "air-launched missiles" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SARH" &
                         is.na(iiss$equipment_subname)] <- "SARH"

# Convert to NA
iiss$equipment_subname[iiss$equipment_type == "air-launched missiles" &
                      iiss$equipment_subtype == "missiles" &
                      iiss$equipment_name == "AAM" &
                      iiss$equipment_subname == "AAM"] <- NA
iiss$equipment_subname[iiss$equipment_type == "air-launched missiles" &
                         iiss$equipment_subtype == "missiles" &
                         iiss$equipment_name == "ASM" &
                         iiss$equipment_subname == "ASM"] <- NA
iiss$equipment_subname[iiss$equipment_type == "air-launched missiles" &
                         iiss$equipment_name == "AShM" &
                      iiss$equipment_subname == "AShM"] <- NA
iiss$equipment_subname[iiss$equipment_type == "air-launched missiles" &
                         iiss$equipment_name == "ASM" &
                         iiss$equipment_subname == "ASM"] <- NA
iiss$equipment_subname[iiss$equipment_type == "air-launched missiles" &
                         iiss$equipment_subname == "Matra"] <- NA
iiss$equipment_subname[iiss$equipment_type == "air-launched missiles" & 
                         iiss$equipment_name == "AAM" & 
                         iiss$equipment_subname == "AAM"] <- NA
```

Fix incorrect equipment_name that should have equipment_type = equipment_type
```{r}
# convert to AAM
iiss$equipment_name[iiss$equipment_type == "surface-to-surface missile launchers" &
                      iiss$equipment_name == "AIM"] <- "AAM"
iiss$equipment_name[iiss$equipment_type == "air-launched missiles" &
                         iiss$equipment_subtype == "AAM"] <- "AAM"
iiss$equipment_name[iiss$equipment_type == "air-launched missiles" &
                        iiss$equipment_subtype == "missiles" &
                        iiss$equipment_name == "MSL" &
                        iiss$equipment_subname == "AAM"] <- "AAM"
iiss$equipment_name[iiss$equipment_type == "air-launched missiles" &
                      is.na(iiss$equipment_subtype) &
                      iiss$equipment_name == "ARH" &
                      iiss$equipment_subname == "ARH"] <- "AAM"
iiss$equipment_name[iiss$equipment_type == "air-launched missiles" &
                      is.na(iiss$equipment_subtype) &
                      iiss$equipment_name == "IIR" &
                      iiss$equipment_subname == "ARH/IIR"] <- "AAM"
iiss$equipment_name[iiss$equipment_type == "air-launched missiles" &
                      is.na(iiss$equipment_subtype) &
                      iiss$equipment_name == "MANPAD" &
                      is.na(iiss$equipment_subname)] <- "AAM"
iiss$equipment_name[iiss$equipment_type == "air-launched missiles" &
                      is.na(iiss$equipment_subtype) &
                      iiss$equipment_name == "SARH" &
                      iiss$equipment_subname == "SARH"] <- "AAM"
iiss$equipment_name[iiss$equipment_type == "air-launched missiles" &
                      iiss$equipment_name == "MSL" &
                      iiss$equipment_subname == "AAM"] <- "AAM"

# Convert to ASM 
iiss$equipment_name[iiss$equipment_type == "surface-to-surface missile launchers" &
                      iiss$equipment_subtype == "tactical" &
                      iiss$equipment_name == "MSL" &
                      iiss$equipment_subname == "tactical"] <- "ASM"
iiss$equipment_name[iiss$equipment_type == "surface-to-surface missile launchers" &
                      is.na(iiss$equipment_subtype) &
                      iiss$equipment_name == "ASMP" &
                      is.na(iiss$equipment_subname)] <- "ASM"
iiss$equipment_name[iiss$equipment_type == "air-launched missiles" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "AAM" &
                         iiss$equipment_subname == "ASM"] <- "ASM"
iiss$equipment_name[iiss$equipment_type == "air-launched missiles" &
                      iiss$equipment_subtype == "missiles" &
                      iiss$equipment_name == "MSL" &
                      iiss$equipment_subname == "ASM"] <- "ASM"
iiss$equipment_name[iiss$equipment_type == "air-launched missiles" &
                      iiss$equipment_subname == "ASM"] <- "ASM"

# Convert to AShM
iiss$equipment_name[iiss$equipment_type == "air-launched missiles" &
                      iiss$equipment_subname == "AShM"] <- "AShM"

# Convert to LACM
iiss$equipment_name[iiss$equipment_type == "air-launched missiles" &
                      is.na(iiss$equipment_subtype) &
                      iiss$equipment_name == "ALCM" &
                      (iiss$equipment_subname == "nuclear" |
                         iiss$equipment_subname == "Nuclear")] <- "LACM"
iiss$equipment_name[iiss$equipment_type == "air-launched missiles" &
                      is.na(iiss$equipment_subtype) &
                      iiss$equipment_name == "ALCM" &
                      iiss$equipment_subname == "conventional"] <- "LACM"
iiss$equipment_name[iiss$equipment_type == "air-launched missiles" &
                      is.na(iiss$equipment_subtype) &
                      iiss$equipment_name == "ALCM" &
                      (iiss$equipment_subname == "tactical" |
                         iiss$equipment_subname == "Tactical")] <- "LACM"
iiss$equipment_name[iiss$equipment_type == "air-launched missiles" &
                      is.na(iiss$equipment_subtype) &
                      iiss$equipment_name == "ASM" &
                      (iiss$equipment_subname == "strategic" |
                         iiss$equipment_subname == "Strategic")] <- "LACM"
iiss$equipment_name[iiss$equipment_type == "air-launched missiles" &
                      is.na(iiss$equipment_subtype) &
                      is.na(iiss$equipment_name) &
                      iiss$equipment_subname == "nuclear"] <- "LACM"
```

Fix incorrect equipment_subtype that should have equipment_type = equipment_type
```{r}
# convert to missiles
iiss$equipment_subtype[iiss$equipment_type == "surface-to-surface missile launchers" &
                         iiss$equipment_subtype == "tactical" &
                         iiss$equipment_name == "ASM" &
                         iiss$equipment_subname == "tactical"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "surface-to-surface missile launchers" &
                           is.na(iiss$equipment_subtype) &
                           iiss$equipment_name == "ASM" &
                           is.na(iiss$equipment_subname)] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "surface-to-surface missile launchers" &
                         iiss$equipment_subtype == "tactical" &
                         iiss$equipment_name == "ASM" &
                         iiss$equipment_subname == "tactical"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "surface-to-surface missile launchers" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "ASM" &
                         is.na(iiss$equipment_subname)] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air-launched missiles" &
                      iiss$equipment_subtype == "AAM" &
                        iiss$equipment_name == "AAM"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "missiles" &
                         is.na(iiss$equipment_subtype) &
                         (iiss$equipment_name == "ASM" |
                            iiss$equipment_name == "ASM/ALCM")] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air-launched missiles" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "AAM" &
                         iiss$equipment_subname == "ARH"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "air-launched missiles" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "AAM" &
                         iiss$equipment_subname == "ARH/IIR"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "air-launched missiles" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "AAM" &
                         iiss$equipment_subname == "IR"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "air-launched missiles" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "ARM" &
                         is.na(iiss$equipment_subname)] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air-launched missiles" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "AShM" &
                         is.na(iiss$equipment_subname)] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air-launched missiles" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "ASM" &
                         is.na(iiss$equipment_subname)] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air-launched missiles" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "ASM" &
                         iiss$equipment_subname == "tactical"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air-launched missiles" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "ASM" &
                         is.na(iiss$equipment_subname)] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air-launched missiles" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "AAM" &
                         is.na(iiss$equipment_subname)] <- NA
iiss$equipment_subtype[iiss$equipment_type == "air-launched missiles" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "AAM" &
                         iiss$equipment_subname == "SARH"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "air-launched missiles" &
                        iiss$equipment_name == "MSL" &
                        iiss$equipment_subname == "AAM"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air-launched missiles" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "LACM" &
                         (iiss$equipment_subname == "nuclear" |
                            iiss$equipment_subname == "Nuclear")] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air-launched missiles" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "LACM" &
                         iiss$equipment_subname == "conventional"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air-launched missiles" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "LACM" &
                         (iiss$equipment_subname == "tactical" |
                            iiss$equipment_subname == "Tactical")] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air-launched missiles" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "AAM" &
                         iiss$equipment_subname == "ARH"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "air-launched missiles" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "LACM" &
                         (iiss$equipment_subname == "strategic" |
                            iiss$equipment_subname == "Strategic")] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air-launched missiles" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "EW" &
                         is.na(iiss$equipment_subname)] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air-launched missiles" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "AAM" &
                         iiss$equipment_subname == "ARH/IIR"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "air-launched missiles" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "LACM" &
                         is.na(iiss$equipment_subname)] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air-launched missiles" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "AAM" &
                         is.na(iiss$equipment_subname)] <- NA
iiss$equipment_subtype[iiss$equipment_type == "air-launched missiles" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "AAM" &
                         iiss$equipment_subname == "SARH"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "air-launched missiles" &
                         iiss$equipment_subtype == "air-launched missiles"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air-launched missiles" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "LACM" &
                         iiss$equipment_subname == "nuclear"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air-launched missiles" &
                         iiss$equipment_subtype == "AD"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air-launched missiles" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "MSL" &
                         iiss$equipment_subname == "ASM"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air-launched missiles" &
                         is.na(iiss$equipment_subtype) &
                         (iiss$equipment_name == "AAM" |
                            iiss$equipment_name == "ASMP")] <- NA
iiss$equipment_subtype[iiss$equipment_name == "ASM"] <- "missiles"

# Convert to NA
iiss$equipment_subtype[iiss$equipment_type == "air-launched missiles" &
                      iiss$equipment_subtype == "tactical"] <- NA
```

Fix incorrect equipment_type that should have equipment_type = equipment_type
```{r}
# surface-to-surface missile launchers
iiss$equipment_type[iiss$equipment_type == "surface-to-surface missile launchers" &
                        iiss$equipment_name == "AAM"] <- "air-launched missiles"
iiss$equipment_type[iiss$equipment_type == "surface-to-surface missile launchers" &
                      iiss$equipment_subtype == "missiles" &
                      iiss$equipment_name == "AShM" &
                      iiss$equipment_subname == "strategic"] <- "air-launched missiles"
iiss$equipment_type[iiss$equipment_type == "surface-to-surface missile launchers" &
                      iiss$equipment_subtype == "missiles" &
                      iiss$equipment_name == "ASM" &
                      iiss$equipment_subname == "strategic"] <- "air-launched missiles"
iiss$equipment_type[iiss$equipment_type == "surface-to-surface missile launchers" &
                      iiss$equipment_subtype == "missiles" &
                      iiss$equipment_name == "ASM" &
                      iiss$equipment_subname == "tactical"] <- "air-launched missiles"
iiss$equipment_type[iiss$equipment_type == "surface-to-surface missile launchers" &
                      iiss$equipment_subtype == "missiles" &
                      iiss$equipment_name == "ASM" &
                      is.na(iiss$equipment_subname)] <- "air-launched missiles"
iiss$equipment_type[iiss$equipment_type == "surface-to-surface missile launchers" &
                      iiss$equipment_name == "ASM"] <- "air-launched missiles"
iiss$equipment_type[iiss$equipment_type == "surface-to-surface missile launchers" &
                      iiss$equipment_name == "MSL" &
                      iiss$equipment_subname == "ASM"] <- "air-launched missiles"

# Helicopters
iiss$equipment_type[iiss$equipment_name == "ASM" |
                      iiss$equipment_subname == "ASM"] <- "air-launched missiles"

# Msl
iiss$equipment_type[iiss$equipment_type == "msl" &
                      iiss$equipment_subtype == "AAM"] <- "air-launched missiles"

# Missiles
iiss$equipment_type[iiss$equipment_type == "missiles" &
                         iiss$equipment_subtype == "missiles" &
                         (iiss$equipment_name == "ASM" |
                            iiss$equipment_name == "ASM/ALCM")] <- "air-launched missiles"
iiss$equipment_type[iiss$equipment_type == "missiles" &
                         iiss$equipment_subtype == "missiles" &
                         iiss$equipment_name == "AAM"] <- "air-launched missiles"

# Logistics and support
iiss$equipment_type[iiss$equipment_type == "logistics and support" &
                      iiss$equipment_name == "MSL" &
                      iiss$equipment_subname == "AAM"] <- "air-launched missiles"

# Engineering and maintenance vehicles
iiss$equipment_type[iiss$equipment_type == "engineering and maintenance vehicles" &
                      iiss$equipment_name == "AAM"] <- "air-launched missiles"

# Air-to-air missiles 
iiss$equipment_type[iiss$equipment_type == "air-to-air missiles"] <- "air-launched missiles"

# Air launched missiles
iiss$equipment_type[iiss$equipment_type == "air launched missiles"] <- "air-launched missiles"

# NA
iiss$equipment_type[is.na(iiss$equipment_type) &
                      (iiss$equipment_name == "AAM" |
                         iiss$equipment_name == "ASM")] <- "air-launched missiles"
```


## Aircraft

### Typos
Here we fix typos, which include spelling errors, capitalization errors, and any other formatting errors that affect merging or equipment similarity

#### Unit_name typos
```{r}
iiss$unit_name[iiss$unit_name == "AN-2"] <- "An-2"
iiss$unit_name[iiss$unit_name == "S-2T Tracjer"] <- "S-2T Tracker"
iiss$unit_name[iiss$unit_name=="C-37"] <- "C-37 Cessna 182 Skylane"
iiss$unit_name[iiss$unit_name=="Cessna 182"] <- "C-37 Cessna 182 Skylane"
iiss$unit_name[iiss$unit_name=="Cessna 182 Skylane"] <- "C-37 Cessna 182 Skylane"
iiss$unit_name[iiss$unit_name == "DCH-5"] <- "DHC-5"
iiss$unit_name[iiss$unit_name == "DCH-6"] <- "DHC-6"
iiss$unit_name[iiss$unit_name == "MiG-21"] <- "MiG-21 Fishbed"
iiss$unit_name[iiss$unit_name=="Peliance"] <- "Reliance"
iiss$unit_name[iiss$unit_name=="Su-25"] <- "Su-25 Frogfoot"
iiss$unit_name[iiss$unit_name == "J-5"] <- "PRC J-5"
iiss$unit_name[iiss$unit_name == "Tucano (trg) (plus 52 in reserve)"] <- "Tucano"
```

#### Equipment_subname typos
```{r}
# AT-3
iiss$equipment_subname[iiss$equipment_type == "aircraft" &
                         iiss$equipment_subname == "AT-3"] <- NA

# Light
iiss$equipment_subname[iiss$equipment_subname == "mlight"] <- "light"
iiss$equipment_subname[iiss$unit_name == "lt tpt ac"] <- "light"

iiss$equipment_subname[iiss$equipment_subname == "meadium/light"] <- "medium/light"

# Long-range
iiss$equipment_subname[iiss$equipment_type == "aircraft" &
                         iiss$equipment_subname == "longrange"] <- "long-range"

# Medium-range
iiss$equipment_subname[iiss$equipment_type == "aircraft" &
                         iiss$equipment_subname == "medium"] <- "medium-range"

# Remove subnames
iiss$equipment_subname[iiss$equipment_type == "aircraft" &
                         (iiss$equipment_subname == "(6withSLAR)" |
                            iiss$equipment_subname == "2sqn" |
                            iiss$equipment_subname == "air defence" |
                            iiss$equipment_subname == "Bandeirante" |
                            iiss$equipment_subname == "beech" |
                            iiss$equipment_subname == "C-130" |
                            iiss$equipment_subname == "Cessna" |
                            iiss$equipment_subname == "EC-93" |
                            iiss$equipment_subname == "EMB-111(P-54/P-95B)" |
                            iiss$equipment_subname == "EU-93" |
                            iiss$equipment_subname == "F-5" |
                            iiss$equipment_subname == "L-410" |
                            iiss$equipment_subname == "PC-6" |
                            iiss$equipment_subname == "R-99B" |
                            iiss$equipment_subname == "RC-12" |
                            iiss$equipment_subname == "SAAB" |
                            iiss$equipment_subname == "SC.73MSkyvan2" |
                            iiss$equipment_subname == "Schweizer" |
                            iiss$equipment_subname == "Su-27" |
                            iiss$equipment_subname == "TP-100A" |
                            iiss$equipment_subname == "OBS" |
                            iiss$equipment_subname == "(HB-315BGaviao)" |
                            iiss$equipment_subname == "AlouetteIII\n/SA-319\nAlouetteIII" |
                            iiss$equipment_subname == "TwinOtter" |
                            iiss$equipment_subname == "EU-93A")] <- NA
```

#### Equipment_name typos
```{r}
iiss$equipment_name[iiss$equipment_name == "RC-12"] <- "RECCE"
iiss$equipment_name[iiss$equipment_name == "ARL"] <- "RECCE"
iiss$equipment_name[iiss$equipment_type %in% c("aircraft",
                                               "helicopters") &
                      iiss$equipment_name == "COMD"] <- "C2"
iiss_ac_match <- iiss %>%
  dplyr::filter(stringr::str_detect(equipment_name, "AC") |
                  stringr::str_detect(equipment_name, "ac"))
iiss_ac <- iiss %>%
  dplyr::filter(equipment_name == "AC")
ac_types <- iiss_ac %>%
  dplyr::distinct(equipment_type)
ac_units <- iiss_ac %>%
  dplyr::distinct(unit_name)

# AEW
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "AEW"] <- "AEWandC"

# ATK
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "ATTACK/RECCE"] <- "ATK/RECCE"

iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      (iiss$equipment_name == "armed" |
                         iiss$equipment_name == "ATTACK" |
                         iiss$equipment_name == "MARITIME ATTACK")] <- "ATK"

iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      (iiss$equipment_name == "LIGHT ATTACK/TRG" |
                         iiss$equipment_name == "COMBAT TRG" |
                         iiss$equipment_name == "ATTACK/TRG")] <- "ATK/TRG"

iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "LT ATK/RECCE"] <- "ATK/RECCE"

# AWACS
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "AWAC"] <- "AWACS"

# Bomber
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      (iiss$equipment_name == "Bomber" |
                         iiss$equipment_name == "bombers" |
                         iiss$equipment_name == "BOMBERS" |
                         iiss$equipment_name == "LT BBR" |
                         iiss$equipment_name == "MED BBR" |
                         iiss$equipment_name == "MD BBR" |
                         iiss$equipment_name == "BBRj")] <- "BBR"

# Calibration
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "calibration"] <- "CALIBRATION"

# CBT/TRG
iiss$equipment_name[iiss$equipment_name == "CBT TRG"] <- "CBT/TRG"

# Communications
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      (iiss$equipment_name == "Communications" |
                         iiss$equipment_name == "communications" |
                         iiss$equipment_name == "COMMS")] <- "COMMS"

# COIN
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "Coin"] <- "COIN"

iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "Coin/TRG"] <- "COIN/TRG"

# ELINT/TPT
iiss$equipment_name[iiss$equipment_name == "ELINT/Tpt"] <- "ELINT/TPT"

# EW/TPT
iiss$equipment_name[iiss$equipment_name == "EW/tpt"] <- "EW/TPT"
iiss$equipment_name[iiss$equipment_name == "EW/Tpt"] <- "EW/TPT"

# EW
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "EWS"] <- "EW"

# FGA
iiss$equipment_name[iiss$equipment_name == "PRC" |
                      iiss$equipment_name == "FGA/SQN"] <- "FGA"

# FTR
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      (iiss$equipment_name == "Fighter" |
                         iiss$equipment_name == "FIGHTER" |
                         iiss$equipment_name == "FRG" |
                         iiss$equipment_name == "FTG" |
                         iiss$equipment_name == "FTR/BOMBERS")] <- "FTR"

# Interceptor
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      (iiss$equipment_name == "interceptor" |
                      iiss$equipment_name == "Interceptor")] <- "INTERCEPTOR"

# Liaison
iiss$equipment_name[iiss$equipment_name == "Liaison" |
                         iiss$equipment_name == "liason" |
                         iiss$equipment_name == "Liason" |
                         iiss$equipment_name == "LIASON"] <- "LIAISON"

iiss$equipment_name[iiss$equipment_name == "Liason/COMMS"] <- "LIAISON/COMMS"

# MR
iiss$equipment_name[iiss$equipment_name == "MR ac"] <- "MR"

# MR/ATK
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "MR/ATTACK"] <- "MR/ATK"

# MR/MP
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "MR(MP)"] <- "MR/MP"

# MR/SAR
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "MR/SAW"] <- "MR/SAR"

# Multi-role
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "MULTI-ROLE"] <- "MR"

# Recce
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "recce" |
                      iiss$equipment_name == "RECCEE"] <- "RECCE"

iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "SAR/REECE"] <- "SAR/RECCE"

# STRIKE
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "strike"] <- "STRIKE"

iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "Strike/FGA"] <- "STRIKE/FGA"

# Survey
iiss$equipment_name[iiss$equipment_name == "SURVEY" |
                         iiss$equipment_name == "survey"] <- "SURV"

# Tankers
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "TANKERS"] <- "TKR"

iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "TRK"] <- "TKR"

# TPT
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      (iiss$equipment_name == "T" |
                         iiss$equipment_name == "tpt" |
                         iiss$equipment_name == "Transport" |
                         iiss$equipment_name == "TRANSPORT")] <- "TPT"

iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      (iiss$equipment_name == "PRESIDENTIAL" |
                         iiss$equipment_name == "PRESIDENTIAL FLT")] <- "TPT"

iiss$equipment_name[iiss$equipment_name == "TPE/ECM"] <- "TPT/ECM"

iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "TPT/Liason"] <- "TPT/LIAISON"

# TRG
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      (iiss$equipment_name == "TRAINING" |
                         iiss$equipment_name == "TR" |
                         iiss$equipment_name == "trg" |
                         iiss$equipment_name == "Training"|
                         iiss$equipment_name == "training" |
                         iiss$equipment_name == "TRG CENTRE" |
                         iiss$equipment_name == "Trainers")] <- "TRG"
iiss$equipment_name[iiss$equipment_name == "Trg"] <- "TRG"


# TT
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      (iiss$equipment_name == "TandT" |
                         iiss$equipment_name == "TEST" |
                         iiss$equipment_name == "TRIALS" |
                         iiss$equipment_name == "TT" |
                         iiss$equipment_name == "TEST AND TRIALS" |
                         iiss$equipment_name == "Trails" |
                         iiss$equipment_name == "TRAILS" |
                         iiss$equipment_name == "trials" |
                         iiss$equipment_name == "TRIALS AND TEST")] <- "TT"

# UTL
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                         iiss$equipment_subtype == "AC"] <- "UTL"
iiss$equipment_name[iiss$equipment_name == "utility"] <- "UTL"
iiss$equipment_subtype[iiss$equipment_type == "aircraft" &
                         iiss$equipment_subtype == "AC"] <- NA
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "UTILITY/LIAISON"] <- "UTL/LIAISON"

iiss$equipment_name[iiss$equipment_name == "utility/trials"] <- "UTL/TRIALS"

# TRG/COIN
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "Trg/COIN"] <- "TRG/COIN"

# MP/ASW
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "MP ASW"] <- "MP/ASW"

# MP/SURV
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "MP/Surv"] <- "MP/SURV"

```

#### Equipment_subtype typos
```{r}
iiss$equipment_subtype[iiss$equipment_subtype == "tiltrotor"] <- NA
iiss$equipment_subtype[iiss$equipment_subtype == "special freighter"] <- NA
iiss$equipment_subtype[iiss$equipment_subtype == "trg"] <- "TRG"
iiss$equipment_subtype[iiss$equipment_subtype == "Piper"] <- NA
```

#### Equipment_type typos
```{r}
iiss$equipment_type[iiss$equipment_type == "aicraft"] <- "aircraft"
iiss$equipment_type[iiss$equipment_type == "airships"] <- "aircraft"
iiss$equipment_type[iiss$equipment_type == "air defence" &
                      iiss$equipment_subtype == "civil defence"] <- "aircraft"
iiss$equipment_type[iiss$equipment_type == "SF"] <- "special freighter"
iiss$equipment_type[iiss$equipment_type == "special freighter"] <- "aircraft"
iiss$equipment_type[iiss$equipment_type == "bbr"] <- "bombers"
iiss$equipment_type[iiss$equipment_type == "bombers"] <- "aircraft"
iiss$equipment_type[iiss$equipment_type == "transport"] <- "aircraft"
iiss$equipment_subtype[iiss$equipment_type == "tiltrotor"] <- "tiltrotor"
iiss$equipment_type[iiss$equipment_type == "tiltrotor"] <- "aircraft"
iiss$equipment_type[iiss$equipment_type == "aircarft"] <- "aircraft"
iiss$equipment_type[iiss$equipment_type == "Coin"] <- "aircraft"
iiss$equipment_type[iiss$equipment_type == "fighter aircraft"] <- "aircraft"
iiss$equipment_type[iiss$equipment_type == "Liason"] <- "aircraft"
iiss$equipment_type[iiss$equipment_type == "reconnaissance aircraft"] <- "aircraft"
iiss$equipment_type[iiss$equipment_type == "trainer aircraft"] <- "aircraft"
iiss$equipment_type[iiss$equipment_type == "Training"] <- "aircraft"
iiss$equipment_type[iiss$equipment_type == "Transport"] <- "aircraft"
iiss$equipment_type[iiss$equipment_type == "transport aircraft"] <- "aircraft"

iiss$equipment_name[iiss$equipment_type == "mobile emergency police force" &
                      iiss$unit_name == "Cessna 337"] <- "TPT"
iiss$equipment_type[iiss$equipment_type == "mobile emergency police force" &
                      iiss$unit_name == "Cessna 337"] <- "aircraft"
iiss$equipment_name[iiss$equipment_type == "mobile emergency police force" &
                      iiss$unit_name == "Do-28"] <- "TPT"
iiss$equipment_type[iiss$equipment_type == "mobile emergency police force" &
                      iiss$unit_name == "Do-28"] <- "aircraft"
```

### Coding changes

#### Unit_name

Fix incorrect equipment that should have unit_name = TBD
```{r}
# Equipment_name
iiss$equipment_name[iiss$unit_name == "A-340 Airbus"] <- "TPT"

iiss$equipment_name[iiss$unit_name == "BN-2A Maritime Defender"] <- "TPT"

iiss$equipment_name[iiss$unit_name == "Cessna 172"] <- "TPT"

iiss$equipment_name[iiss$equipment_name == "ANG" &
                      iiss$unit_name == "F-15A/B/C/D"] <- "TRG"

iiss$equipment_name[iiss$equipment_name == "AT" &
                      iiss$unit_name == "C-130B"] <- "TPT"

iiss$equipment_name[iiss$unit_name == "AC 1 Cessa U206G" |
                      iiss$unit_name == "BN-2T" |
                      iiss$unit_name == "Helio 269" |
                      iiss$unit_name == "Helio 391" |
                      iiss$unit_name == "OV-1D" |
                      iiss$unit_name == "PC-12" |
                      iiss$unit_name == "RU-21" |
                      iiss$unit_name == "RV-1D" |
                      iiss$unit_name == "short skyvan"] <- "UTL"

# iiss$equipment_name[iiss$unit_name == "Albatros" |
#                      iiss$unit_name == "Albatross"] <- "TRG"

iiss$equipment_name[iiss$unit_name == "AN-2" |
                      iiss$unit_name == "An-2" |
                      iiss$unit_name == "B-707" |
                      iiss$unit_name == "B-727" |
                      iiss$unit_name == "B-737-200" |
                      iiss$unit_name == "C-47 (tpt)" |
                      iiss$unit_name == "Cessna 402C" |
                      iiss$unit_name == "DC-9" |
                      iiss$unit_name == "Falcon 20 (civil registration)" |
                      iiss$unit_name == "Gulfstream (C-20)" |
                      iiss$unit_name == "Gulfstream I" |
                      iiss$unit_name == "Gulfstream II" |
                      iiss$unit_name == "Gulfstream III (C-20E)" |
                      iiss$unit_name == "Gulfstream IV (C-20F)" |
                      iiss$unit_name == "Gulfstream V(C-37A)" |
                      iiss$unit_name == "Gulfstream(C-20)" |
                      iiss$unit_name == "TMB-700" |
                      iiss$unit_name == "Tu-154 Careless" |
                      iiss$unit_name == "Yak-40"] <- "TPT"

iiss$equipment_name[iiss$unit_name == "F-16CG (FGA)/DG (trg)" |
                      iiss$unit_name == "Mirage 2000N (ASMP)" |
                      iiss$unit_name == "Super Entendard"] <- "FGA"

iiss$equipment_name[iiss$unit_name == "MiG-21MF Fishbed J Mi-G 21/MiG-21UB Mongol Mongol A trg;" |
                      iiss$unit_name == "Mirage F-1 CG (ftr)" |
                      iiss$unit_name == "TA-7P"] <- "FTR"

iiss$equipment_name[iiss$unit_name == "Be-12 Mail"] <- "MR"

iiss$equipment_name[iiss$unit_name == "MiG-21" |
                      iiss$unit_name == "MiG-21 Fishbed"] <- "FTR"

iiss$equipment_name[iiss$unit_name == "Su-7"] <- "FGA"

iiss$equipment_name[iiss$unit_name == "Su-7/-20"] <- "FGA"

iiss$equipment_name[iiss$equipment_type == "armoured fighting vehicles" &
                      iiss$equipment_subtype == "AIRCRAFT" &
                      (iiss$unit_name == "Beech Queen Air" |
                         iiss$unit_name == "Beech Queen Air" |
                         iiss$unit_name == "C-37 Cessna 182 Skylane" |
                         iiss$unit_name == "Cessna 207" |
                         iiss$unit_name == "Cessna 500" |
                         iiss$unit_name == "Cessna U-17A" |
                         iiss$unit_name == "Cessna U-17A/B" |
                         iiss$unit_name == "Citation" |
                         iiss$unit_name == "Commander 690" |
                         iiss$unit_name == "DHC-5" |
                         iiss$unit_name == "DHC-6" |
                         iiss$unit_name == "DCH-6 Twin Otter" |
                         iiss$unit_name == "DHC-6 Twin Otter" |
                         iiss$unit_name == "DHC-6-300" |
                         iiss$unit_name == "G-222" |
                         iiss$unit_name == "Merlin IIIA" |
                         iiss$unit_name == "Merlin IV" |
                         iiss$unit_name == "Navajo" |
                         iiss$unit_name == "PC-6B" |
                         iiss$unit_name == "Queen Air" |
                         iiss$unit_name == "Sabreliner" |
                         iiss$unit_name == "Turbo Commander 690A" |
                         iiss$unit_name == "Turbo-Porter" |
                         iiss$unit_name == "U-17A/B")] <- "TPT"

iiss$equipment_name[iiss$equipment_type == "armoured fighting vehicles" &
                      iiss$equipment_subtype == "AIRCRAFT" &
                      (iiss$unit_name == "T-41" |
                         iiss$unit_name == "T-4D")] <- "TRG"

iiss$equipment_name[iiss$equipment_type == "armoured fighting vehicles" &
                      iiss$equipment_subtype == "AIRCRAFT" &
                      iiss$unit_name == "Swearingen IIIA"] <- "SAR"

iiss$equipment_name[iiss$equipment_type == "armoured fighting vehicles" &
                      iiss$equipment_subtype == "AIRCRAFT" &
                      (iiss$unit_name == "Commander 560" |
                         iiss$unit_name == "King Air" |
                         iiss$unit_name == "Turbo Navajo")] <- "UTL"

iiss$equipment_type[iiss$equipment_type == "armoured fighting vehicles" &
                      iiss$equipment_subtype == "AIRCRAFT" &
                      (iiss$unit_name == "Beech Queen Air" |
                         iiss$unit_name == "Beech Queen Air" |
                         iiss$unit_name == "C-37 Cessna 182 Skylane" |
                         iiss$unit_name == "Cessna 207" |
                         iiss$unit_name == "Cessna 500" |
                         iiss$unit_name == "Cessna U-17A" |
                         iiss$unit_name == "Cessna U-17A/B" |
                         iiss$unit_name == "Citation" |
                         iiss$unit_name == "Commander 690" |
                         iiss$unit_name == "DHC-5" |
                         iiss$unit_name == "DHC-6" |
                         iiss$unit_name == "DCH-6 Twin Otter" |
                         iiss$unit_name == "DHC-6 Twin Otter" |
                         iiss$unit_name == "DHC-6-300" |
                         iiss$unit_name == "G-222" |
                         iiss$unit_name == "Merlin IIIA" |
                         iiss$unit_name == "Merlin IV" |
                         iiss$unit_name == "Navajo" |
                         iiss$unit_name == "PC-6B" |
                         iiss$unit_name == "Queen Air" |
                         iiss$unit_name == "Sabreliner" |
                         iiss$unit_name == "Turbo Commander 690A" |
                         iiss$unit_name == "Turbo-Porter" |
                         iiss$unit_name == "U-17A/B" |
                         iiss$unit_name == "T-41" |
                         iiss$unit_name == "T-4D"|
                         iiss$unit_name == "Swearingen IIIA" |
                         iiss$unit_name == "Commander 560" |
                         iiss$unit_name == "King Air" |
                         iiss$unit_name == "Turbo Navajo")] <- "aircraft"

# Equipment_subtype
iiss$equipment_subtype[iiss$unit_name == "Be-12 Mail"] <- NA

# Equipment_type
iiss$equipment_type[iiss$unit_name == "A-340 Airbus"] <- "aircraft"

iiss$equipment_type[iiss$unit_name == "BN-2A Maritime Defender"] <- "aircraft"

iiss$equipment_type[iiss$unit_name == "Cessna 172"] <- "aircraft"

iiss$equipment_type[iiss$unit_name == "MiG-21" |
                      iiss$unit_name == "MiG-21 Fishbed"] <- "aircraft"

iiss$equipment_type[iiss$unit_name == "Su-7"] <- "aircraft"

iiss$equipment_type[iiss$unit_name == "Su-7/-20"] <- "aircraft"

```

#### Equipment_subname
```{r}
iiss$equipment_subname[iiss$equipment_type == "aircraft" &
                         iiss$equipment_name == "ECM" &
                         iiss$equipment_subname == "ECM"] <- NA

iiss$equipment_subname[iiss$equipment_name == "ARMY CO-OP"] <- "light"

iiss$equipment_subname[iiss$equipment_subtype == "light"] <- "light"
iiss$equipment_subtype[iiss$equipment_subtype == "light"] <- NA

iiss$equipment_subname[iiss$equipment_subtype == "LIGHT"] <- "light"
iiss$equipment_subtype[iiss$equipment_subtype == "LIGHT"] <- NA

iiss$equipment_subname[iiss$equipment_subname == "intercepter"] <- "interceptor"

iiss$equipment_subtype[iiss$equipment_type == "aircraft" &
                         iiss$equipment_subname == "LIGHT"] <- NA

# Collapse synonyms
iiss$equipment_subname[iiss$equipment_type == "aircraft" &
                         iiss$equipment_subname %in% c("LIGHT",
                                                       "LT")] <- "light"

iiss$equipment_subname[iiss$equipment_subname %in% c("long range",
                                                     "long-range",
                                                     "LONG RANGE")] <- "long-range"


iiss$equipment_subname[iiss$equipment_type == "aircraft" &
                         iiss$equipment_subname %in% c("HEAVY",
                                                       "hvy")] <- "heavy"

# Redundant terms
iiss$equipment_subname[iiss$equipment_type == "aircraft" &
                         iiss$equipment_subname %in% c("AC",
                                                       "otherac")] <- NA

# Company names we remove from subname
iiss$equipment_subname[iiss$equipment_type == "aircraft" &
                         iiss$equipment_subname %in% c("Aeritalia",
                                                       "Aermacchi",
                                                       "Arava",
                                                       "BAe",
                                                       "Dassault",
                                                       "DeHaviilland",
                                                       "Fairchild",
                                                       "Fokker",
                                                       "Hercules",
                                                       "Huanquero",
                                                       "Hunter",
                                                       "Lockheed",
                                                       "NorthAmerican",
                                                       "Pilatus",
                                                       "REGIONAL",
                                                       "Rockwell",
                                                       "Sabre")] <- NA

# Unit names we remove from subname
iiss$equipment_subname[iiss$equipment_subname %in% c("AirTractor",
                                                       "Beaver",
                                                       "BirdDog",
                                                       "C-47",
                                                       "Dragonfly",
                                                       "Lama",
                                                       "Pucara",
                                                       "Scout")] <- NA

```

#### Equipment_name
```{r}
# Unit_name
iiss$unit_name[iiss$equipment_name == "Su-22M-4 (Su-17M-4) Fitter K Su-17M Fitter C FGA/Su-22UM-3K (Su-17UM-3) Fitter G Su-17U trg"] <- "Su-22M-4 (Su-17M-4) Fitter K Su-17M Fitter C FGA/Su-22UM-3K (Su-17UM-3) Fitter G Su-17U trg"

iiss$equipment_name[iiss$unit_name == "Tu-134 Crusty"] <- "TPT"

iiss$equipment_name[iiss$unit_name == "Tu-134 Crusty"] <- "TPT"

iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "UTL" &
                      iiss$unit_name %in% c("F-3",
                                            "Tornado",
                                            "Typhoon/Tornado")] <- "FTR"

iiss$equipment_name[iiss$unit_name == "Tornado ADV"] <- "FTR"
iiss$equipment_type[iiss$unit_name == "Tornado ADV"] <- "aircraft"

iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "UTL" &
                      iiss$unit_name == "Harrier"] <- "CLOSE SPT"

iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "UTL" &
                      iiss$unit_name == "Hawk"] <- "ATK"

iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "UTL" &
                      iiss$unit_name == "Jaguar"] <- "STIKE/FGA"

iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "UTL" &
                      iiss$unit_name == "Nimrod"] <- "MR"

iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "UTL" &
                      iiss$unit_name == "Tucano"] <- "TRG"

# Equipment_name
iiss$equipment_name[iiss$unit_name == "AC-47/C-47"] <- "COIN"

iiss$equipment_name[iiss$unit_name == "P-3N Orion"] <- "ASW/MR"

iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_subname == "ECM" &
                      iiss$unit_name == "YS-11 E"] <- "ECM"
iiss$equipment_subname[iiss$equipment_type == "aircraft" &
                         iiss$equipment_name == "ECM" &
                      iiss$unit_name == "YS-11 E"] <- NA

iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "AD"] <- "FTR"

iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "MCR" &
                      iiss$unit_name == "A-4F/M"] <- "FGA"

iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "MCR" &
                      iiss$unit_name == "F-18A"] <- "FTR"

iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "MCR" &
                      iiss$unit_name == "A-4M"] <- "TRG"

iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      (iiss$equipment_name == "TUG" |
                      iiss$equipment_name == "TRG/TUG")] <- "TRG"

iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "RESERVE" &
                      iiss$unit_name == "CP-121"] <- "TPT"

iiss$equipment_name[iiss$equipment_type == "civil defence" &
                      iiss$unit_name == "C-212"] <- "TPT"

iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "STOL" &
                      (iiss$unit_name == "C-7/C-123" |
                         iiss$unit_name == "C-7/C-123B")] <- "TPT"

iiss$equipment_name[iiss$equipment_name == "ARMY CO-OP"] <- "TPT"

iiss$equipment_name[iiss$equipment_name == "BOMBERS"] <- "BBR"

iiss$equipment_name[iiss$unit_name == "C-95"] <- "SAR"

iiss$equipment_name[iiss$unit_name == "RF-35XD"] <- "RECCE"

iiss$equipment_name[iiss$equipment_name == "IA"] <- "FGA"

iiss$equipment_name[iiss$equipment_name == "LEAD-IN FTR TRG"] <- "TRG"

iiss$equipment_name[iiss$unit_name == "P-68 Observer"] <- "TPT"

iiss$equipment_name[iiss$unit_name == "lt tpt ac"] <- "TPT"

iiss$equipment_name[iiss$equipment_name == "MED BBR"] <- "BBR"

iiss$equipment_name[iiss$equipment_name == "Su-22M-4 (Su-17M-4) Fitter K Su-17M Fitter C FGA/Su-22UM-3K (Su-17UM-3) Fitter G Su-17U trg"] <- NA

iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_subname == "OCU"] <- "OCU"
iiss$equipment_subname[iiss$equipment_type == "aircraft" &
                         iiss$equipment_subname == "OCU"] <- NA

iiss$equipment_subname[iiss$equipment_type == "aircraft" &
                         iiss$equipment_subname == "basedefence"] <- NA

iiss$equipment_subname[iiss$equipment_type == "aircraft" &
                         iiss$equipment_subname == "survey"] <- NA

iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "TPT" &
                      iiss$equipment_subname == "tanker"] <- "TPT/TKR"
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_subname == "tanker"] <- NA

iiss$equipment_name[iiss$unit_name == "(incl ocu): schools"] <- "TRG"

iiss <- iiss %>%
  dplyr::filter(equipment_name != "BR" |
                  is.na(equipment_name))

iiss$equipment_name[iiss$unit_name == "Tu-134 Crusty"] <- "TPT"


# Equipment subtype
iiss$equipment_name[iiss$equipment_type == "aircraft" & 
                      iiss$equipment_subtype == "interceptor"] <- "FTR"
iiss$equipment_subtype[iiss$equipment_type == "aircraft" & 
                      iiss$equipment_subtype == "interceptor"] <- NA

iiss$equipment_name[iiss$equipment_subtype == "light, fixed wing"] <- "UTL"
iiss$equipment_subtype[iiss$equipment_subtype == "light, fixed wing"] <- NA
```


#### Equipment_subtype

Fix incorrect equipment_subtype that should have equipment_subtype = TBD
```{r}
iiss$equipment_type[iiss$equipment_subtype == "AIRCRAFT"] <- "aircraft"

iiss$equipment_subtype[iiss$equipment_type == "aircraft" &
                         iiss$equipment_subtype == "AIRCRAFT"] <- NA

iiss$equipment_subtype[iiss$equipment_subtype == "air defence"] <- NA

iiss$equipment_subtype[iiss$equipment_type == "aircraft" &
                         iiss$equipment_subtype == "frigates"] <- NA

iiss$equipment_name[iiss$equipment_subtype == "FGA"] <- "FGA"

iiss$equipment_type[iiss$equipment_subtype == "FGA"] <- "aircraft"

iiss$equipment_subtype[iiss$equipment_subtype == "FGA"] <- NA

iiss$equipment_subtype[iiss$equipment_subtype == "gunships"] <- NA

iiss$equipment_subtype[iiss$equipment_subtype == "gunships/TPT"] <- NA
```

#### Equipment_type

Fix incorrect unit_name that should have equipment_type = aircraft
```{r}
iiss$unit_name[iiss$equipment_type == "aircraft" &
                 iiss$equipment_name == "F-15A/B"] <- "F-15A/B"
iiss$unit_name[iiss$equipment_type == "aircraft" &
                 iiss$equipment_name == "F-15C/D"] <- "F-15C/D"
iiss$unit_name[iiss$equipment_type == "aircraft" &
                 iiss$equipment_name == "F-16A/B"] <- "F-16A/B"
iiss$unit_name[iiss$equipment_type == "aircraft" &
                         iiss$equipment_subname == "A-37BDragonfly/OA-37BDragonfly"] <- "A-37BDragonfly/OA-37BDragonfly"
iiss$equipment_type[iiss$unit_name == "lt tpt ac"] <- "aircraft"
iiss$equipment_type[iiss$unit_name == "C-95"] <- "aircraft"

iiss$equipment_name[iiss$equipment_type == "miscellaneous" &
                      iiss$unit_name == "JJ-5/-6"] <- "TRG"
iiss$equipment_type[iiss$equipment_type == "miscellaneous" &
                      iiss$unit_name == "JJ-5/-6"] <- "aircraft"

iiss$equipment_type[iiss$equipment_type == "miscellaneous" &
                      iiss$unit_name == "Tracker"] <- "aircraft"

iiss$equipment_name[iiss$equipment_type == "miscellaneous" &
                      iiss$unit_name == "Y-8"] <- "TPT"
iiss$equipment_type[iiss$equipment_type == "miscellaneous" &
                      iiss$unit_name == "Y-8"] <- "aircraft"

iiss$equipment_type[iiss$unit_name == "Y-8"] <- "aircraft"
```

Fix incorrect equipment_subname that should have equipment_type = aircraft
```{r}
# Convert to light 
iiss$equipment_subname[iiss$equipment_subtype == "TPT" &
                         iiss$equipment_name == "light"] <- "light"

# Convert to PAX
iiss$equipment_subname[iiss$equipment_type == "aircraft" &
                         iiss$equipment_name == "PAX"] <- "PAX"

# Convert to NA 
iiss$equipment_subname[iiss$equipment_type == "aircraft" &
                         iiss$equipment_name == "ELINT" &
                         (iiss$equipment_subname == "ELINT" |
                            iiss$equipment_subname == "Elint")] <- NA
iiss$equipment_subname[iiss$equipment_type == "aircraft" &
                         iiss$equipment_subname == "ARL"] <- NA
iiss$equipment_subname[iiss$equipment_type == "aircraft" &
                         iiss$equipment_subname == "7.0"] <- NA
iiss$equipment_subname[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "TRG" &
                      iiss$equipment_subname == "TRG"] <- NA
iiss$equipment_subname[iiss$equipment_type == "aircraft" &
                         iiss$equipment_name == "TPT" &
                         iiss$equipment_subname == "TPT"] <- NA
iiss$equipment_subname[iiss$equipment_type == "aircraft" &
                         iiss$equipment_subname == "ACWG"] <- NA
iiss$equipment_subname[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "AEW" &
                      iiss$equipment_subname == "AEW"] <- NA
iiss$equipment_subname[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "MR/SAR" &
                      iiss$equipment_subname == "MR/SAR"] <- NA
iiss$equipment_subname[iiss$equipment_type == "aircraft" &
                         iiss$equipment_subname == "hel"] <- NA
iiss$equipment_subname[iiss$equipment_type == "aircraft" &
                      iiss$equipmemt_name == "MP/ASW" &
                      iiss$equipment_subname == "ASW"] <- NA
iiss$equipment_subname[iiss$equipment_type == "aircraft" &
                         (iiss$equipment_subname == "TT" |
                          iiss$equipment_subname == "ASW" |
                            iiss$equipment_subname == "ac")] <- NA
iiss$equipment_subname[iiss$equipment_type == "aircraft" & 
                         iiss$equipment_subname == "A-37BDragonfly/OA-37BDragonfly"] <- NA
iiss$equipment_subname[iiss$equipment_type == "aircraft" & 
                         iiss$equipment_name == "RECCE" & 
                         iiss$equipment_subname == "BirdDog"] <- NA

```

Fix incorrect equipment_name that should have equipment_type = aircraft
```{r}
# Convert to AEW
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "EW" &
                      iiss$equipment_subname == "AEW"] <- "AEW"
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      is.na(iiss$equipment_name) &
                      iiss$unit_name %in% c("E-3D Sentry", "Saab 340H Erieye", "ZDK-03")] <- "AEW"

# Convert to AEWandC
iiss$equipment_name[iiss$equipment_type == "aircraft" & 
                      (iiss$equipment_subtype == "AEW AND CONTROL" | 
                      iiss$equipment_subtype == "AEWandC")] <- "AEWandC"

# Convert to ASW
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      is.na(iiss$equipment_name) &
                      iiss$unit_name %in% c("Be-12 Mail", "P-3", "P-3C", "P-3N Orion", "P-3P", "S-2T Tracker")] <- "ASW"

# Convert to BBR 
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      is.na(iiss$equipment_name) &
                      iiss$unit_name %in% c("B-1B", "B-2", "B-2A Spirit", "B-52", "B-52G Stratofortress", "B-52H Stratofortress",
                                            "Tu-16", "Tu-22", "Tu-22M", "Tu-26")] <- "BBR"

# Convert to C2
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "CandC"] <- "C2"

# Convert to ELINT
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "EW" &
                      (iiss$equipment_subname == "ELINT" |
                         iiss$equipment_subname == "Elint")] <- "ELINT"
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                       iiss$equipment_name == "Elint"] <- "ELINT"
iiss$equipment_name[iiss$equipment_type == "radars" & 
                      iiss$equipment_subtype == "air" & 
                      iiss$equipment_name == "early warning"] <- "ELINT"

# Convert to EW
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      is.na(iiss$equipment_name) &
                      iiss$unit_name %in% c("II-20")] <- "EW"

# Convert to FGA
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "ARM"] <- "FGA"
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "ASMP"] <- "FGA"
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      (iiss$equipment_name == "FGA/SWN" |
                         iiss$equipment_name == "FGA/STRIKE")] <- "FGA"
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "ac"] <- "FGA"
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      is.na(iiss$equipment_name) &
                      iiss$unit_name %in% c("A-7", "A-7E", "A-7H", "A-7H/TA-7H", "Alpha Jet", "AMX", "Entendard IV P", "FGA",
                                            "Harrier", "Hunter F9", "Jaguar", "Jaguar-A", "Jastreb", "Kraguj", "L-29", "L-29 Delfin",
                                            "MiG-15 U7", "MiG-17", "MiG-21", "MiG-21 Fishbed", "MiG-21 BIS/UM","MiG-21 Lancer B (two seat trainers)",
                                            "MiG-21MF Fishbed J Mi-G 21/MiG-21UB Mongol Mongil A trg;", "MiG-21MF/UB", "MiG-21R", "MiG-21U",
                                            "MiG-23", "MiG-23B/E", "MiG-25", "MiG-27", "MiG-29", "MiG-29 Fulcrum/MiG-29UB Fulcrum Mig-29U",
                                            "MiG-29/Su-22/Su-24/Su-27", "MiG-29/UB", "MiG-31", "Mirage 2000", "Mirage 2000 (EG (FGA)/BG (trg))",
                                            "Mirage 2000B", "Mirage 2000C", "Mirage 2000N", "Mirage 2000N (ASMP", "Mirage 5", "Mirage 5D/E", "Mirage EL3",
                                            "Mirage F-1 EG (ftr)", "Mirage M-2000D", "Orao", "Phantom", "Su-17", "Su-20", "Su-22",
                                            "Su-22M-4 (Su-17M-4) Fitter K Su-17M Fitter C FGA/Su-22UM-3K (Su-17UM-3) Fitter G Su-17U trg",
                                            "Su-22M4/UM3K", "Su-24", "Su-25", "Su-25 Frogfoot", "Su-25K Frogfoot A FGA/Su-25UBK Frogfoot B trg", "Su-25K/UBK",
                                            "Su-27", "Su-7B/U", "Super Etendard", "Super Etendard", "TA-7H", "TH-7P", "TF-104G", "Tornado",
                                            "Typhoon/Tornado")] <- "FGA"

iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "GA" &
                      iiss$unit_name %in% c("BAC-167",
                                            "Hunter")] <- "FGA"
# Convert to FTR
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_subtype == "FTR"] <- "FTR"
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      is.na(iiss$equipment_name) &
                      iiss$unit_name %in% c("Crusader", "F-104", "F-16", "F-16A", "F-16B", "F-16-A", "F-16-B", "F-16A/B", "F-16AM Fighting Falcon",
                                            "F-16BM Fighting Falcon", " F16CG (FGA)/DG (trg)", "F-27", "F-27M", "F-28 (VIP)", "F-3", "F-4",
                                            "F-4E/RF-4E", "F-4F Phantom II", "F-5", "F-50", "F-5A/B", "F-60", "F104G", "F-104G/TF-104G",  "G-91", "NF- 5B",
                                            "NF-5A", "NF-5B", "Su-15")] <- "FTR"
iiss$equipment_name[is.na(iiss$equipment_type) &
                      is.na(iiss$equipment_name) &
                      iiss$unit_name %in% c("F-5")] <- "FTR"
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      (iiss$equipment_name == "F-15A/B" |
                         iiss$equipment_name == "F-15C/D" |
                         iiss$equipment_name == "F-16A/B")] <- "FTR"

# Convert to MR 
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "Multi Role"] <- "MR"
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "vvv"] <- "MR"
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      is.na(iiss$equipment_name) &
                      iiss$unit_name %in% c("Atlantic (MR)", "MR-2", "Nimrod")] <- "MR"

# Convert to MR/SAR
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "TPT" &
                      iiss$equipment_subname == "MR/SAR"] <- "MR/SAR"

# Convert to MP/ASW
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipmemt_name == "MP" &
                      iiss$equipment_subname == "ASW"] <- "MP/ASW"

# Convert to RECCE
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "OBS"] <- "RECCE"
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      is.na(iiss$equipment_name) &
                      iiss$unit_name %in% c("RF-10", "RF-104G", "RF-35", "RF-4E", "RF-5A", "RU-21")] <- "RECCE"

# Convert to SAR
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      is.na(iiss$equipment_name) &
                      iiss$unit_name %in% c("HU-16B", "SA-360")] <- "SAR"

# Convert to SPT
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      is.na(iiss$equipment_name) &
                      iiss$unit_name %in% c("AT-802F Air Tractor")] <- "SPT"
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      is.na(iiss$equipment_name) &
                      iiss$unit_name %in% c("CL-215", "CL-415")] <- "SPT"

# Convert to TKR
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      is.na(iiss$equipment_name) &
                      iiss$unit_name %in% c("KC-135", "VC10")] <- "TKR"

# Convert to TRG
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_subtype == "TRG"] <- "TRG"
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_subname == "TRG"] <- "TRG"
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "CCT"] <- "TRG"
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      (iiss$equipment_name == "LIFT" |
                         iiss$equipment_name == "OCU")] <- "TRG"
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      is.na(iiss$equipment_name) &
                      iiss$unit_name %in% c("CAP 10", "Chipmunk", "CM-170", "Dominie TI (trg) plus 2 in reserve", "Epsilon", "Fouga",
                                            "Hawk", "Jetstream", "L-39", "MB- 339CD", "MB-326", "MB-339", "MB-339CD", "MFI-15", "MS-760", 
                                            "MS-760 Paris", "Mystere-Falcon", "N-262", "Nord-262", "Rallye 880", "SAAB T-17", "SF-260M",
                                            "Super Galeb", "T-2", "T-2C", "T-2E (trg)", "T-3", "T-33", "T-33A", "T-37", "T-37B", 
                                            "T-37B/C (trg)", "T-38", "T-38A Talon", "T-4/T-8", "T-41", "T-41D", "T-6A", "T-6B", "TS-11",
                                            "Tucano (trg) (plus 52 in reserve)", "Tutor (trg)", "UTVA", "Utva-75", "UTVA-75", "Xingu", 
                                            "Z-143L", "Zlin-242")] <- "TRG"

# Convert to TPT
iiss$equipment_name[iiss$equipment_type == "radars" &
                      iiss$unit_name == "C-212 MR"] <- "TPT"
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "AVN"] <- "TPT"
iiss$equipment_name[iiss$equipment_subtype == "TPT" &
                      iiss$equipment_name == "light" &
                      iiss$equipment_subname == "light"] <- "TPT"
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_subtype == "TPT"] <- "TPT"
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_subtype == "civil defence" &
                      (iiss$equipment_name == "AC" |
                         is.na(iiss$equipment_name))] <- "TPT"
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "AIRCRAFT"] <- "TPT"
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_subname == "TPT"] <- "TPT"
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      (iiss$equipment_name == "LIAISON" |
                         iiss$equipment_name == "LIAISON/TRG" |
                         iiss$equipment_name == "TBT")] <- "TPT"
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "VIP"] <- "TPT"
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      is.na(iiss$equipment_name) &
                      iiss$unit_name %in% c("A310-300", "Aero Commander", "AN-2", "An-2", "An-21", "An-24", "AN-24", "An-24 Coke",
                                            "An-26", "AN-26", "An-26 Curl", "AN-26 Curl", "An-28", "An-28RM", "An-72",
                                            "BAe125", "BAe146 Mk2", "BN-2", "BN-2 Islander", "BN-2A Islander", "BN-2T",
                                            "Boeing-707", "Boeing-707-320", "Boeing 707", "Boeing 707-320 (VIP)",
                                            "C-12A", "C-130", "C-130B (tpt)", "C-130H", "C-130H-30", "C-130H (tpt)",
                                            "C-130H Hercules", "C-130H/J", "C-160", "C-160 Astarte", "C-160 Gabriel", "C-160AG",
                                            "C-160G-2", "C-160H", "C-160NG", "C-17A", "C-212", "C-212A Aviocar", "C-212B Aviovar", "
                                            C-47 (tpt)", "Cessna", "Cessna-U206", "Cessna 206C", "Cessna 337", "Cessna 402", "Cessna Caravan II",
                                            "CF-5-A", "CF-5-D", "CN-235", "Commander", "Commander 500B", "CV-22A Osprey", "CV-22A/B Osprey",
                                            "DC-10-30", "DC-3", "DC-3 (C-47 Skytrain)", "DC-8", "DC-8E", "DC-8F", "DC9-32", "DH-6", "DHC-6",
                                            "DHC-6 Twin Otter", "DHC-7R", "Do-128", "Do-228", "Do-27", "Do-28 (tpt)", "EMB-121", "Falcon 10MER",
                                            "Falcon 20", "Falcon 20C", "Falcon 50", "Falcon 50MER", "Falcon 900", "G-222", "G-4 Super Galeb", "Galeb",
                                            "Gulfstream G-III", "Gulfstram I", "Gulfstream I/V (VIP tpt)", "Gulfstream III", "Hercules C-130",
                                            "HFB-320", "HS-748", "Il-18", "IL-28", "Il-62", "Il-76", "Il-76M/MD", "IL 62", "Islander CC2/2A",
                                            "King Air 200\r\n(leased)", "L-19", "L-410", "L-410-S", "L-410 Turbolet", "Let L-410", "MH-1521",
                                            "Navajo", "NC-212", "O-1", "O-1E", "P-149D", "P-166", "P-180", "PA-31T", "PA-NAVAJO", "PC-6", "PC-7",
                                            "PC-9", "PC-9M", "PD-808", "Pzl-104", "Reims-Cessna 406", "Shrike Commander", "SIAI-208", "SM-1019", "SM-92",
                                            "Super King Air", "SW-111 Merlin (VIP)", "TBM-700", "Tristar", "Tu-128", "Tu-134", "Tu-154", "U-17A",
                                            "VFW-614", "YAK-40", "YS-11-200 (tpt)")] <- "TPT"
iiss$equipment_name[is.na(iiss$equipment_type) &
                      is.na(iiss$equipment_name) &
                      iiss$unit_name %in% c("Gulfstream II")] <- "TPT"

iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "FLT" &
                      iiss$unit_name %in% c("A-320 Airbus",
                                            "Andover",
                                            "B727-200",
                                            "B747-400",
                                            "Devon C-2/2",
                                            "Gulfstream III",
                                            "Gulfstream IV",
                                            "Sea Devon C-20",
                                            "Sea Heron C-2",
                                            "Sea Heron C-4")] <- "TPT"

iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$unit_name %in% c("Cessna U-17A",
                                            "Reims Cessna 337",
                                            "Reims Cessna F-337",
                                            "C-9",
                                            "C-9A")] <- "TPT"

# Convert to TT
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      is.na(iiss$equipment_name) &
                      iiss$unit_name %in% c("CAP-231")] <- "TT"

# Convert to TRG
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "FLT" &
                      iiss$unit_name %in% c("Chipmunk T-40")] <- "TRG"

iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "Flying School" &
                      iiss$unit_name %in% c("T-17")] <- "TPT"

# Convert to UTL
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "AC"] <- "UTL"
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "AIR ARM"] <- "UTL"
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      is.na(iiss$equipment_name) &
                      iiss$unit_name %in% c("OV-1D", "PA-22", "RV-1D", "U-9E")] <- "UTL"

iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$unit_name %in% c("KZ VII",
                                            "Piper L-18C")] <- "UTL"

# Convert to NA 
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "PAX" &
                      iiss$equipment_subname == "PAX"] <- NA
iiss$equipment_name[iiss$equipment_type == "aircraft" &
                      (iiss$equipment_name == "In Store" |
                         iiss$equipment_name == "IN STORE" |
                         iiss$equipment_name == "STORAGE")] <- NA
```

Fix incorrect equipment_subtype that should have equipment_type = aircraft
```{r}
# Convert to NA
iiss$equipment_subtype[iiss$equipment_subtype == "TPT" &
                         iiss$equipment_name == "TPT" &
                         iiss$equipment_subname == "light"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "aircraft" &
                      (iiss$equipment_subtype == "AEW AND CONTROL" |
                         iiss$equipment_subtype == "AEWandC")] <- NA
iiss$equipment_subtype[iiss$equipment_type == "aircraft" &
                         iiss$equipment_subtype == "FTR" &
                         iiss$equipment_subtype == "FTR"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "aircraft" &
                         iiss$equipment_subtype == "TPT" &
                         iiss$equipment_subtype == "TPT"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "aircraft" &
                         iiss$equipment_subtype == "TRG" &
                         iiss$equipment_subtype == "TRG"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "aircraft" &
                      iiss$equipment_subtype == "civil defence" &
                      iiss$equipment_name == "TPT"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "aircraft" & 
                         iiss$equipment_subtype == "aircraft"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "aircraft" & 
                      iiss$equipment_subtype == "air" & 
                      iiss$equipment_name == "ELINT"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "aircraft" & 
                         iiss$equipment_subtype == "space-based systems" &
                         iiss$equipment_name == "TPT"] <- NA

```

Fix incorrect equipment_type that should have equipment_type = aircraft
```{r}
# Helicopters
iiss$equipment_type[iiss$equipment_type == "helicopters" &
                      grepl("Tu-", iiss$unit_name)] <- "aircraft"
iiss$equipment_type[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "Bomber"] <- "aircraft"
iiss$equipment_type[iiss$equipment_type == "helicopters" &
                      (iiss$unit_name == "Alize" |
                      iiss$unit_name == "AP-3C Orion" |
                      iiss$unit_name == "Atlantique 2" |
                      iiss$unit_name == "Be-12 Mail" |
                      iiss$unit_name == "Be-6 Madge" |
                      iiss$unit_name == "BR1150 Atlantic" |
                      iiss$unit_name == "C-212" |
                      iiss$unit_name == "C-295ASW Persuader" |
                      iiss$unit_name == "CP-121" |
                      iiss$unit_name == "CP-121 (modified) Tracker" |
                      iiss$unit_name == "CS2F-3 Tracker" |
                      iiss$unit_name == "Dornier 228" |
                      iiss$unit_name == "Dornier 228-212" |
                      iiss$unit_name == "EMB-111A" |
                      iiss$unit_name == "ES-3A" |
                      iiss$unit_name == "F-27" |
                      iiss$unit_name == "F-27 Maritime Enforcer (ESM/ELINT)" |
                      iiss$unit_name == "F-27 MPA" |
                      iiss$unit_name == "Fokker F.27 Mk 200" |
                      iiss$unit_name == "Il-38 May" |
                      iiss$unit_name == "N-24A Nomad" |
                      iiss$unit_name == "P-1" |
                      iiss$unit_name == "P-3" |
                      iiss$unit_name == "P-3 Orion" |
                      iiss$unit_name == "P-3 Orion (CP-140 Aurora)" |
                      iiss$unit_name == "P-3A Orion" |
                      iiss$unit_name == "P-3A Orion (P-3T)" |
                      iiss$unit_name == "P-3ACH Orion" |
                      iiss$unit_name == "P-3AM Orion" |
                      iiss$unit_name == "P-3B Orion" |
                      iiss$unit_name == "P-3C" |
                      iiss$unit_name == "P-3C Orion" |
                      iiss$unit_name == "P-3CK Orion" |
                      iiss$unit_name == "P-3F Orion" |
                      iiss$unit_name == "P-3K Orion" |
                      iiss$unit_name == "P-3K2 Orion" |
                      iiss$unit_name == "P-3M Orion" |
                      iiss$unit_name == "P-3MP Orion" |
                      iiss$unit_name == "P-3N Orion" |
                      iiss$unit_name == "P-3T Orion" |
                      iiss$unit_name == "P-81 Poseidon" |
                      iiss$unit_name == "P-8A Poseidon" |
                      iiss$unit_name == "S-2" |
                      iiss$unit_name == "S-2A" |
                      iiss$unit_name == "S-2E" |
                      iiss$unit_name == "S-2E Tracker" |
                      iiss$unit_name == "S-2F" |
                      iiss$unit_name == "S-2G" |
                      iiss$unit_name == "S-2G Tracker" |
                      iiss$unit_name == "S-2T Tracjer" |
                      iiss$unit_name == "S-2T Tracker" |
                      iiss$unit_name == "S-3B Viking" |
                      iiss$unit_name == "UP-\r3T (UP-3A) Orion" |
                      iiss$unit_name == "UP-3T")] <- "aircraft"
iiss$equipment_type[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "AC"] <- "aircraft"
iiss$equipment_type[iiss$equipment_type == "helicopters" &
                      is.na(iiss$equipment_name) &
                      (iiss$unit_name == "MiG-29" |
                         iiss$unit_name == "Su-17" |
                         iiss$unit_name == "Su-25" |
                         iiss$unit_name == "Su-25 Frogfoot")] <- "aircraft"
iiss$equipment_type[iiss$equipment_type == "helicopters" & 
                      iiss$equipment_name == "FTR" &
                      iiss$unit_name == "MiG-21U"] <- "aircraft"

iiss$equipment_type[iiss$equipment_type == "helicopters" & 
                      (iiss$unit_name == "A-320 Airbus" |
                         iiss$unit_name == "B727-200" |
                         iiss$unit_name == "B747-400" |
                         iiss$unit_name == "Gulfstream III" |
                         iiss$unit_name == "Gulfstream IV")] <- "aircraft"
iiss$equipment_name[iiss$equipment_type == "helicopters" & 
                      (iiss$unit_name == "A-320 Airbus" |
                         iiss$unit_name == "B727-200" |
                         iiss$unit_name == "B747-400" |
                         iiss$unit_name == "Gulfstream III" |
                         iiss$unit_name == "Gulfstream IV")] <- "TPT"

iiss$equipment_type[iiss$equipment_type == "helicopters" & 
                      (iiss$unit_name == "Beechcraft Sierra 200" |
                         iiss$unit_name == "Beechcraft Sundowner" |
                         iiss$unit_name == "T-17")] <- "aircraft"
iiss$equipment_name[iiss$equipment_type == "helicopters" & 
                      (iiss$unit_name == "Beechcraft Sierra 200" |
                         iiss$unit_name == "Beechcraft Sundowner" |
                         iiss$unit_name == "T-17")] <- "TRG"

# Radars
iiss$equipment_type[iiss$equipment_type == "radars" &
                      iiss$equipment_subtype == "civil defence"] <- "aircraft"
iiss$equipment_type[iiss$equipment_type == "radars" &
                      iiss$equipment_name == "AC"] <- "aircraft"
iiss$equipment_type[iiss$equipment_type == "radars" &
                      iiss$equipment_name == "TPT" &
                      iiss$unit_name == "C-212 MR"] <- "aircraft"
iiss$equipment_subtype[iiss$equipment_type == "aircraft" &
                      iiss$equipment_subtype == "space-based systems" &
                      iiss$unit_name == "C-212 MR"] <- NA

iiss$equipment_type[iiss$equipment_type == "radars" & 
                      iiss$equipment_subtype == "air" & 
                      iiss$equipment_name == "ELINT"] <- "aircraft"

iiss$equipment_type[iiss$equipment_type == "radars" & 
                      iiss$equipment_name == "FTR"] <- "aircraft"

iiss$equipment_type[iiss$equipment_type == "radars" &
                      iiss$equipment_name == "TPT" &
                      iiss$unit_name == "C-212"] <- "aircraft"

# NA
iiss$equipment_type[is.na(iiss$equipment_type) &
                      (iiss$equipment_name == "BBR" |
                         iiss$equipment_name == "FGA" |
                         iiss$equipment_name == "CONTROL" |
                         iiss$equipment_name == "Fighter" |
                         iiss$equipment_name == "FTR" |
                         iiss$equipment_name == "MR" |
                         iiss$equipment_name == "TANKERS" |
                         (iiss$service == "air force" &
                            iiss$equipment_name == "TBT") |
                         iiss$equipment_name == "TKR" |
                         iiss$equipment_name == "TPT" |
                         iiss$equipment_name == "FGA/ISR" |
                         iiss$equipment_name == "MRH" |
                         iiss$equipment_name == "MP" |
                         iiss$equipment_name == "training" |
                         iiss$equipment_name == "Training" |
                         iiss$equipment_name == "Transport" |
                         iiss$equipment_name == "TRG" |
                         iiss$equipment_name == "SURVEY" |
                         iiss$equipment_subname == "TRG" |
                         iiss$unit_name == "JJ-5/-6" |
                         iiss$unit_name == "Y-8" |
                         iiss$unit_name == "Hawker 800XP (EU-93A)" |
                           iiss$unit_name == "Learjet 35A" |
                           iiss$unit_name == "Kobalt M")] <- "aircraft"
iiss$equipment_type[is.na(iiss$equipment_type) &
                      (iiss$unit_name == "C-160" |
                        iiss$unit_name == "Do-27" |
                        iiss$unit_name == "Falcon 20" |
                        iiss$unit_name == "Jaguar" |
                        iiss$unit_name == "MiG-21 BIS/UM" |
                        iiss$unit_name == "MiG-23B/E" |
                        iiss$unit_name == "Mirage 2000" |
                        iiss$unit_name == "Mirage 5D/E" |
                        iiss$unit_name == "P-149D" |
                        iiss$unit_name == "P-3" |
                        iiss$unit_name == "Su-27" |
                        iiss$unit_name == "Tu-154")] <- "aircraft"
iiss$equipment_type[is.na(iiss$equipment_type) &
                      is.na(iiss$equipment_name) &
                      iiss$unit_name %in% c("Gulfstream II")] <- "aircraft"
iiss$equipment_type[is.na(iiss$equipment_type) &
                      is.na(iiss$equipment_name) &
                      iiss$unit_name %in% c("F-5")] <- "aircraft"

iiss$equipment_type[is.na(iiss$equipment_type) &
                      iiss$equipment_name == "BBR"] <- "aircraft"

iiss$equipment_type[is.na(iiss$equipment_type) &
                      iiss$equipment_name == "LIAISON"] <- "aircraft"
iiss$equipment_type[is.na(iiss$equipment_type) &
                      iiss$equipment_name == "LIAISON/FAC"] <- "aircraft"
iiss$equipment_type[iiss$equipment_type == "LIAISON" |
                      iiss$equipment_type == "liaison"] <- "aircraft"

# Air defence
iiss$equipment_type[iiss$equipment_type == "air defence" &
                      iiss$equipment_name == "TRG"] <- "aircraft"
iiss$equipment_type[iiss$equipment_type == "air defence" &
                      iiss$equipment_name == "FTR"] <- "aircraft"

# Naval aviation
iiss$equipment_type[iiss$equipment_type == "Naval Aviation"] <- "aircraft"

# Patrol and coastal combatants
iiss$equipment_type[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_name == "AVN"] <- "aircraft"

# offensive
iiss$equipment_type[iiss$equipment_type == "offensive" & 
                      iiss$equipment_subtype == "aircraft"] <- "aircraft"

# Armoured fighting vehicles
iiss$equipment_type[iiss$equipment_type == "armoured fighting vehicles" & 
                      iiss$equipment_name == "RECCE" & 
                      iiss$equipment_subname == "BirdDog"] <- "aircraft"

# gendarmerie royale
iiss$equipment_type[iiss$equipment_type == "gendarmerie royale" &
                      iiss$unit_name == "Ralleye ac"] <- "aircraft"
```

## Amphibious
### Typos
Here we fix typos, which include spelling errors, capitalization errors, and any other formatting errors that affect merging or equipment similarity

#### Unit_name typos
```{r}

```

#### Equipment_subname typos
```{r}
iiss$equipment_name[iiss$equipment_type == "amphibious" &
                      iiss$equipment_subname == "Tankers"] <- "LCM/LCU"

iiss$equipment_name[iiss$equipment_type == "amphibious" &
                      iiss$equipment_subname %in% c("69-ton",
                                                    "TPT",
                                                    "RFA")] <- NA

```

#### Equipment_name typos
```{r}
iiss$equipment_name[iiss$equipment_name == "LCU/LCM"] <- "LCM/LCU"

iiss$equipment_name[iiss$equipment_subtype == "LST"] <- "LST"

iiss$equipment_name[iiss$equipment_name == "SP" &
                      iiss$equipment_subname == "T"] <- "SPT"

```

#### Equipment_subtype typos
```{r}
iiss$equipment_subtype[iiss$equipment_subtype %in% c("amphibious",
                                                     "assault boats",
                                                     "assault craft",
                                                     "command ships",
                                                     "dock",
                                                     "inshore",
                                                     "LCVP",
                                                     "LST",
                                                     "medium",
                                                     "patrol craft",
                                                     "tank",
                                                     "TPT")] <- NA

iiss$equipment_subtype[iiss$equipment_subtype == "LPC"] <- "LCT"

iiss$equipment_subtype[iiss$equipment_name %in% c("DDS")] <- "special forces"

iiss$equipment_subtype[iiss$equipment_type == "amphibious" &
                         iiss$equipment_name %in% c("ACV",
                                                    "LCAC",
                                                    "LCM",
                                                    "LCP",
                                                    "LCT",
                                                    "LCU",
                                                    "LCVP",
                                                    "LS",
                                                    "LSM",
                                                    "LST",
                                                    "UCAC")] <- "landing ships"

iiss$equipment_subtype[iiss$equipment_name %in% c("LHA",
                                                  "LPD",
                                                  "LSD")] <- "principal amphibious ships"

```

#### Equipment_type typos
```{r}
iiss$equipment_type[iiss$equipment_type == "ACV"] <- "amphibious"
iiss$equipment_type[iiss$equipment_type == "landing craft"] <- "amphibious"
iiss$equipment_type[iiss$equipment_type == "landng craft"] <- "amphibious"

iiss$equipment_type[iiss$equipment_type == "assault" &
                      iiss$equipment_name == "LPD"] <- "amphibious"
```

### Coding changes

#### Unit_name
Fix incorrect columns based on unit_name value
```{r}
# Unit_name

# Equipment_subname

# Equipment_name

# Equipment_subtype

# Equipment_type

```

#### Equipment_subname
Fix incorrect columns that should have equipment_subname = TBD
```{r}
# Unit_name

# Equipment_subname

# Equipment_name
iiss$equipment_subname[iiss$equipment_type == "amphibious" &
                         iiss$equipment_subtype == "river"] <- NA

# Equipment_subtype

# Equipment_type

```

  REPEAT FOR EACH EQUIPMENT_SUBNAME AS NEEDED

#### Equipment_name
Fix incorrect columns that should have equipment_name = TBD
```{r}
# Unit_name
iiss$equipment_name[iiss$equipment_type == "amphibious" &
                      iiss$unit_name == "D'Avila (US LST-511)"] <- "LST"

iiss$equipment_name[iiss$equipment_type == "amphibious" &
                      iiss$unit_name == "Jervis Bay"] <- "LKA"

# Equipment_subname

# Equipment_name
iiss$equipment_type[iiss$equipment_name == "amphibious" |
                      iiss$equipment_name == "Amphibious"] <- "amphibious"

iiss$equipment_type[iiss$equipment_type == "mine warfare" &
                      iiss$equipment_subtype == "amphibious"] <- "amphibious"

iiss$equipment_name[iiss$equipment_type == "amphibious" &
                      iiss$unit_name %in% c("DDS")] <- "DDS"

iiss$equipment_name[iiss$equipment_type == "amphibious" &
                      iiss$unit_name %in% c("landing craft")] <- "LC"

iiss$equipment_name[iiss$equipment_type == "amphibious" &
                      iiss$unit_name %in% c("Damen Assault Craft 540",
                                            "Darnen Assault Craft 540")] <- "LCA"

iiss$equipment_name[iiss$equipment_type == "amphibious" &
                      iiss$unit_name %in% c("LCM")] <- "LCM"

iiss$equipment_name[iiss$equipment_type == "amphibious" &
                      iiss$equipment_name == "ILS"] <- "LCM"

iiss$equipment_name[iiss$equipment_type == "amphibious" &
                      iiss$unit_name %in% c("LCVP")] <- "LCVP"

iiss$equipment_name[iiss$equipment_type == "amphibious" &
                      iiss$unit_name %in% c("LCA")] <- "LCA"

iiss$equipment_name[iiss$equipment_type == "amphibious" &
                      iiss$unit_name %in% c("CDIC")] <- "LCT"

iiss$equipment_name[iiss$equipment_type == "amphibious" &
                      iiss$unit_name %in% c("LCU")] <- "LCU"

iiss$equipment_name[iiss$equipment_type == "amphibious" &
                      iiss$unit_name %in% c("service vessel",
                                            "tug",
                                            "LCVP")] <- "LCVP"

iiss$equipment_name[iiss$equipment_type == "amphibious" &
                      iiss$unit_name %in% c("Chung Ho (ex-US Newport)",
                                            "control craft",
                                            "EDA-R",
                                            "hovercrat and boats",
                                            "landing ships",
                                            "Landing Ships")] <- "LS"

iiss$equipment_name[iiss$equipment_type == "amphibious" &
                      iiss$unit_name %in% c("LSM")] <- "LSM"

iiss$equipment_name[iiss$equipment_type == "amphibious" &
                      iiss$unit_name %in% c("Ro=Ro 1300 (crocodile)",
                                            "Batral")] <- "LST"

iiss$equipment_name[iiss$equipment_type == "amphibious" &
                      iiss$unit_name %in% c("MTB")] <- "MTB"

iiss$equipment_name[iiss$equipment_type == "amphibious" &
                      iiss$unit_name %in% c("river craft",
                                            "river tpts",
                                            "riverine craft")] <- "PCR"

# Equipment_subtype
iiss$equipment_subtype[iiss$equipment_subtype == "amphibian"] <- NA

# Equipment_type
iiss$equipment_name[iiss$equipment_type == "amphibious" &
                      iiss$equipment_subtype == "tank"] <- "LST"
```

  REPEAT FOR EACH EQUIPMENT_NAME AS NEEDED
  
#### Equipment_subtype
Fix incorrect columns that should have equipment_subtype = TBD
```{r}
# Unit_name

# Equipment_subname

# Equipment_name

# Equipment_subtype
iiss$equipment_subtype[iiss$equipment_type == "amphibious" &
                      iiss$equipment_subtype == "mine countermeasures" &
                      iiss$equipment_name == "LCC"] <- NA

# Equipment_type

```

  REPEAT FOR EACH EQUIPMENT_SUBTYPE AS NEEDED

#### Equipment_type

Fix incorrect unit_name that should have equipment_type = equipment_type
```{r}

```

Fix incorrect equipment_subname that should have equipment_type = equipment_type
```{r}
# Convert to NA
iiss$equipment_subname[iiss$equipment_type == "amphibious" &
                      iiss$equipment_name == "LSM" &
                      iiss$equipment_subname == "LSM"] <- NA
iiss$equipment_subname[iiss$equipment_subtype == "landing craft" &
                         iiss$equipment_name == "LCAC" &
                         iiss$equipment_subname == "LCAC"] <- NA
iiss$equipment_subname[iiss$equipment_type == "amphibious" &
                      iiss$equipment_name == "LACV" &
                      iiss$equipment_subname == "LACV"] <- NA
iiss$equipment_subname[iiss$equipment_type == "amphibious" &
                         iiss$equipment_name == "LCAC" &
                         iiss$equipment_subname == "LCAC"] <- NA
iiss$equipment_subname[iiss$equipment_type == "amphibious" &
                         iiss$equipment_name == "LSLH" &
                         iiss$equipment_subname == "LSLH"] <- NA
iiss$equipment_subname[iiss$equipment_type == "amphibious" &
                         iiss$equipment_name == "RRC" &
                         iiss$equipment_subname == "RRC"] <- NA
iiss$equipment_subname[iiss$equipment_type == "amphibious" &
                         iiss$equipment_name == "LST" &
                      iiss$equipment_subname == "LST"] <- NA
iiss$equipment_subname[iiss$equipment_type == "amphibious" &
                         iiss$equipment_subname == "LSL"] <- NA
iiss$equipment_subname[iiss$equipment_type == "amphibious" & 
                         iiss$equipment_name == "LCVP" & 
                         iiss$equipment_subname == "LCVP"] <- NA
iiss$equipment_subname[iiss$equipment_type == "amphibious" & 
                         iiss$equipment_name == "LCU" & 
                         iiss$equipment_subname == "LCU"] <- NA

# Convert to UCAC
iiss$equipment_subname[iiss$equipment_type == "amphibious" & 
                         iiss$equipment_subname == "utilitycraftaircushion"] <- "UCAC"

```

Fix incorrect equipment_name that should have equipment_type = equipment_type
```{r}
# Convert to LSM
iiss$equipment_name[iiss$equipment_type == "amphibious" &
                      iiss$equipment_name == "LS" &
                      iiss$equipment_subname == "LSM"] <- "LSM"

iiss$equipment_name[iiss$equipment_type == "amphibious" & 
                      iiss$equipment_subtype == "LSM" & 
                      is.na(iiss$equipment_name)] <- "LSM"

# Convert to LCM
iiss$equipment_name[iiss$equipment_type == "amphibious" &
                      iiss$equipment_subtype == "LCM"] <- "LCM"

iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_subtype %in% c("LCM",
                                                    "LCM/TPT")] <- "LCM"
iiss$equipment_type[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_subtype %in% c("LCM",
                                                    "LCM/TPT")] <- "amphibious"
iiss$equipment_subtype[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_subtype %in% c("LCM",
                                                    "LCM/TPT")] <- NA

# Convert to LCU
iiss$equipment_name[iiss$equipment_type == "amphibious" &
                      (iiss$equipment_name == "AMPHIBIOUS" |
                         iiss$equipment_name == "AMPH") &
                      (iiss$unit_name == "LC" |
                         iiss$unit_name == "LCU" |
                         iiss$equipment_subname == "LCU")] <- "LCU"

iiss$equipment_name[iiss$equipment_type == "amphibious" &
                      iiss$equipment_name == "PB"] <- "LCU"

# Convert to LCVP
iiss$equipment_name[iiss$equipment_type == "amphibious" & 
                      iiss$equipment_name == "AMPH" & 
                      iiss$equipment_subname == "LCVP"] <- "LCVP"

# Convert to LCAC
iiss$equipment_name[iiss$equipment_subtype == "landing craft" &
                      iiss$equipment_name == "LC" &
                      iiss$equipment_subname == "LCAC"] <- "LCAC"
iiss$equipment_name[iiss$equipment_type == "amphibious" &
                      iiss$equipment_subname == "LCAC"] <- "LCAC"

# Convert to LCAV
iiss$equipment_name[iiss$equipment_type == "amphibious" &
                      iiss$equipment_subname == "LACV"] <- "LACV"

# Convert to LSLH
iiss$equipment_name[iiss$equipment_type == "amphibious" &
                      iiss$equipment_subname == "LSLH"] <- "LSLH"

# Convert to LST
iiss$equipment_name[iiss$equipment_type == "amphibious" &
                      iiss$equipment_subname == "LST"] <- "LST"

# Convert to RRC
iiss$equipment_name[iiss$equipment_type == "amphibious" &
                      iiss$equipment_subname == "RRC"] <- "RRC"

# Convert to NA
iiss$equipment_name[iiss$equipment_type == "amphibious" &
                      iiss$equipment_name == "amphibious"] <- NA

```

Fix incorrect equipment_subtype that should have equipment_type = equipment_type
```{r}
# Convert to landing craft
iiss$equipment_subtype[iiss$equipment_type == "amphibious" & 
                         iiss$equipment_name == "LC" &
                         iiss$equipment_subname == "LCAC"] <- "landing craft"
iiss$equipment_subtype[iiss$equipment_type == "amphibious" &
                         iiss$equipment_subtype == "CRAFT"] <- "landing craft"

# Convert to landing ships
iiss$equipment_subtype[iiss$equipment_type == "amphibious" &
                         (iiss$equipment_subtype == "landing craft" |
                            iiss$equipment_subtype == "landing ships")] <- "landing ships"

# Convert to principal amphibious ships 
iiss$equipment_subtype[iiss$equipment_type == "amphibious" &
                         (iiss$equipment_subtype == "principal amphibious vessels" |
                            iiss$equipment_subtype == "principal amphibious ships")] <- "principal amphibious ships"

iiss$equipment_type[iiss$equipment_name == "LCC"] <- "amphibious"

# Convert to special forces 
iiss$equipment_subtype[iiss$equipment_type == "amphibious" &
                         iiss$equipment_subtype == "SF"] <- "special forces"

# Convert to assault craft
iiss$equipment_subtype[iiss$equipment_type == "amphibious" &
                         iiss$equipment_subtype == "ASLT CRAFT"] <- "assault craft"

# Convert to NA
iiss$equipment_subtype[iiss$equipment_type == "amphibious" &
                         iiss$equipment_subtype == "mine countermeasures" &
                         iiss$equipment_name == "amphibious"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "amphibious" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "amphibious"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "amphibious" &
                      iiss$equipment_subtype == "LCM" &
                      iiss$equipment_name == "LCM"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "amphibious" &
                      iiss$equipment_subtype == "LSM" &
                      iiss$equipment_name == "LSM"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "amphibious" &
                      iiss$equipment_subtype == "mine countermeasures" &
                      is.na(iiss$equipment_name) & 
                        is.na(iiss$equipment_subname)] <- "principal amphibious ships"
```

Fix incorrect equipment_type that should have equipment_type = equipment_type
```{r}
# Aircraft
iiss$equipment_type[iiss$equipment_type == "aircraft" &
                      (iiss$equipment_name == "LCU" |
                         iiss$equipment_name == "LCA" |
                         iiss$equipment_name == "LCM")] <- "amphibious"
iiss$equipment_type[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "SF"] <- "amphibious"

# Armoured fighting vehicles
iiss$equipment_type[iiss$equipment_type == "armoured fighting vehicles" &
                      iiss$equipment_name == "LCAC"] <- "amphibious"

# Craft
iiss$equipment_type[iiss$subservice == "amphibious" &
                      iiss$equipment_type == "craft"] <- "amphibious"

# Logistics and support
iiss$equipment_type[iiss$equipment_type == "logistics and support" &
                      iiss$equipment_name %in% c("LC",
                                                 "LCP",
                                                 "LS",
                                                 "LSH")] <- "amphibious"

# minor surface combatants
iiss$equipment_type[iiss$equipment_type == "minor surface combatants" &
                      iiss$equipment_name == "LPD"] <- "amphibious"

iiss$equipment_type[iiss$equipment_type == "minor surface combatants" &
                      iiss$equipment_name == "LST"] <- "amphibious"

# Mine warfare
iiss$equipment_type[iiss$equipment_type == "mine warfare" &
                      iiss$equipment_subtype == "mine countermeasures" &
                      iiss$equipment_name == "amphibious"] <- "amphibious"

iiss$equipment_type[iiss$equipment_type == "mine warfare" &
                      iiss$equipment_name == "amphibious"] <- "amphibious"

iiss$equipment_subtype[iiss$equipment_type == "mine warfare" &
                      iiss$equipment_name == "amphibious"] <- NA

iiss$equipment_type[iiss$equipment_type == "mine warfare" &
                      iiss$equipment_name %in% c("LC",
                                                 "LCA",
                                                 "LCM",
                                                 "LCT",
                                                 "LCU",
                                                 "LSD")] <- "amphibious"

# Patrol and coastal combatants
iiss$equipment_type[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_name == "AMPHIBIOUS"] <- "amphibious"

iiss$equipment_type[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_name %in% c("LCU",
                                                 "LC",
                                                 "Landing craft",
                                                 "LCM",
                                                 "LCP",
                                                 "LSD")] <- "amphibious"

# NA
iiss$equipment_type[is.na(iiss$equipment_type) &
                      (iiss$equipment_name == "LCT")] <- "amphibious"
iiss$equipment_type[is.na(iiss$equipment_type) &
                      (iiss$unit_name == "LCM" |
                         iiss$unit_name == "Yudao LSM")] <- "amphibious"

```

## Anti-tank/anti-infrastructure

### Typos
Here we fix typos, which include spelling errors, capitalization errors, and any other formatting errors that affect merging or equipment similarity

#### Unit_name typos
```{r}

```

#### Equipment_subname typos
```{r}
iiss$equipment_subname[iiss$equipment_subname == "75mm/82mm/105mm/120mm)"] <- "75mm/82mm/105mm/120mm"

iiss$equipment_subname[iiss$equipment_subname == "107mm"] <- "107mm"
iiss$equipment_subname[iiss$equipment_subname == "82mm,107mm"] <- "82mm/107mm"
iiss$equipment_subname[iiss$equipment_subname == "85mmand100mm"] <- "85mm/100mm"

```

#### Equipment_name typos
```{r}
iiss$equipment_name[iiss$equipment_name == "MLRS"] <- "MLR"

iiss$equipment_subname[iiss$equipment_name == "RL 94mm"] <- "94mm"
iiss$equipment_subtype[iiss$equipment_name == "RL 94mm"] <- "RL"
iiss$equipment_name[iiss$equipment_name == "RL 94mm"] <- NA
```

#### Equipment_subtype typos
```{r}
iiss$equipment_subtype[iiss$equipment_subtype == "GUN"] <- "GUNS"

```

#### Equipment_type typos
```{r}
iiss$equipment_type[iiss$equipment_type == "anti-tank/guns" |
                      iiss$equipment_type == "anti-tank guided weapon"] <- "anti-tank/anti-infrastructure"
iiss$equipment_type[iiss$equipment_type == "ATGW"] <- "anti-tank/anti-infrastructure"
iiss$equipment_type[iiss$equipment_type == "anti-tank"] <- "anti-tank/anti-infrastructure"
iiss$equipment_type[iiss$equipment_type == "RL" |
                      iiss$equipment_type == "RCL"] <- "anti-tank/anti-infrastructure"
```

### Coding changes

#### Unit_name
Fix incorrect columns based on unit_name value
```{r}
# Unit_name

# Equipment_subname
iiss$equipment_subname[iiss$unit_name == "M-60PB"] <- "APC(T)"

# Equipment_name
iiss$equipment_name[iiss$unit_name == "M-60PB"] <- "APC"

# Equipment_subtype
iiss$equipment_subtype[iiss$unit_name == "M-60PB"] <- NA

# Equipment_type
iiss$equipment_type[iiss$unit_name=="AT-4"] <- "anti-tank/anti-infrastructure"
iiss$equipment_type[iiss$unit_name == "M-60PB"] <- "armoured fighting vehicles"

```

#### Equipment_subname
Fix incorrect columns that should have equipment_subname = TBD
```{r}
# Unit_name

# Equipment_subname

# Equipment_name

# Equipment_subtype

# Equipment_type

```

  REPEAT FOR EACH EQUIPMENT_SUBNAME AS NEEDED

#### Equipment_name
Fix incorrect columns that should have equipment_name = TBD
```{r}
# Unit_name
iiss$unit_name[iiss$equipment_subname == "SS-11/-12"] <- "SS-11/-12"
iiss$equipment_subname[iiss$equipment_subname == "SS-11/-12"] <- NA

iiss$equipment_name[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                      iiss$unit_name == "NASAMS"] <- "TOW"

# Equipment_subname
iiss$equipment_subname[iiss$equipment_name == "106mm"] <- "106mm"
iiss$equipment_name[iiss$equipment_name == "106mm"] <- NA

iiss$equipment_subname[iiss$equipment_name == "ATGW"] <- "ATGW"
iiss$equipment_name[iiss$equipment_name == "ATGW"] <- NA

iiss$equipment_subname[iiss$equipment_name == "MANPATS"] <- "MANPATS"
iiss$equipment_name[iiss$equipment_name == "MANPATS"] <- NA

# Equipment_name
iiss$equipment_name[iiss$equipment_name == "BRDM" |
                      iiss$equipment_name == "ENTAC"] <- "ATGW"

iiss$equipment_name[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                      iiss$equipment_name == "SPT"] <- "SP"

# Equipment_subtype
iiss$equipment_name[iiss$equipment_subtype == "ATGW"] <- "TOW"

# Equipment_type

```

  REPEAT FOR EACH EQUIPMENT_NAME AS NEEDED
  
#### Equipment_subtype
Fix incorrect columns that should have equipment_subtype = TBD
```{r}
# Unit_name

# Equipment_subname

# Equipment_name
iiss$equipment_name[iiss$equipment_name == "anti-tank/anti-infrastructure" &
                      iiss$equipment_subtype == "RL" &
                      iiss$equipment_name == "RL"] <- NA

iiss$equipment_name[iiss$equipment_name == "anti-tank/anti-infrastructure" &
                      iiss$equipment_name == "TOWED"] <- "TOW"

# Equipment_subtype

# Equipment_type

```

  REPEAT FOR EACH EQUIPMENT_SUBTYPE AS NEEDED

#### Equipment_type

Fix incorrect unit_name that should have equipment_type = equipment_type
```{r}

```

Fix incorrect equipment_subname that should have equipment_type = equipment_type
```{r}
# Convert to MANPATS
iiss$equipment_subname[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                         iiss$equipment_subtype == "missiles" &
                         iiss$equipment_name == "MANPATS" &
                         is.na(iiss$equipment_subname)] <- "MANPATS"
iiss$equipment_subname[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                         is.na(iiss$equipment_subtype) &
                         (iiss$equipment_name == "MANPAT" |
                            iiss$equipment_name == "MANPATS" |
                            iiss$equipment_name == "MANPADS")] <- "MANPATS"
iiss$equipment_subname[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                         iiss$equipment_name == "MANPATS"] <- "MANPATS"

# Convert to MLR
iiss$equipment_subname[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                         iiss$equipment_subtype == "missiles" &
                         iiss$equipment_name == "MLR" &
                         is.na(iiss$equipment_subname)] <- "MLR"

# Convert to SP
iiss$equipment_subname[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                         iiss$equipment_subtype == "missiles" &
                         iiss$equipment_name == "SP" &
                         is.na(iiss$equipment_subname)] <- "SP"

# Convert to TOW
iiss$equipment_subname[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                         iiss$equipment_subtype == "missiles" &
                         iiss$equipment_name == "TOWED" &
                         is.na(iiss$equipment_subname)] <- "TOW"

# Convert to 94mm
iiss$equipment_subname[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                         iiss$equipment_subtype == "RL" &
                         iiss$equipment_name == "RL 94mm"] <- "94mm"

# Convert to NA 
iiss$equipment_subname[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                         iiss$equipment_subtype == "missiles" &
                         iiss$equipment_name == "MLR" &
                         iiss$equipment_subname == "MLR"] <- NA
iiss$equipment_subname[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                      iiss$equipment_subtype == "missiles" &
                      iiss$equipment_name == "TOWED" &
                      iiss$equipment_subname == "TOW"] <- NA
iiss$equipment_subname[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                      iiss$equipment_name == "TOWED" &
                      iiss$equipment_subname == "TOW"] <- NA
iiss$equipment_subname[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                         iiss$equipment_subname == "GUN"] <- NA

```

Fix incorrect equipment_name that should have equipment_type = equipment_type
```{r}
# Convert to ATGW
iiss$equipment_name[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                      is.na(iiss$equipment_subtype) &
                      iiss$equipment_name == "MSL" &
                      is.na(iiss$equipment_subname)] <- "ATGW"
iiss$equipment_name[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                      iiss$equipment_subtype == "ATGW"] <- "ATGW"
iiss$equipment_name[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                      iiss$equipment_subtype == "grenade launchers" & 
                      is.na(iiss$equipment_name) & 
                      (iiss$equipment_subname == "62mm" | 
                         iiss$equipment_subname == "40mm")] <- "ATGW"

# Convert to MLR
iiss$equipment_name[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                      iiss$equipment_subtype == "missiles" &
                      is.na(iiss$equipment_name) &
                      iiss$equipment_subname == "MLR"] <- "MLR"

# Convert to SP
iiss$equipment_name[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                         iiss$equipment_subtype == "GUNS" &
                         iiss$equipment_name == "ATK"] <- "SP"
iiss$equipment_name[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                         iiss$equipment_subtype == "GUNS" &
                         iiss$equipment_name == "ASLT GUN"] <- "SP"

# Convert to TOWED
iiss$equipment_name[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                         iiss$equipment_subtype == "missiles" &
                         iiss$equipment_name == "MSL" &
                         iiss$equipment_subname == "TOW"] <- "TOW"
iiss$equipment_name[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                      iiss$equipment_name == "ATGW" &
                      iiss$equipment_subname == "TOW"] <- "TOW"

# Convert to NA
iiss$equipment_name[iiss$equipment_type == "gun" &
                      iiss$equipment_subtype == "RL" &
                         iiss$equipment_name == "RL"] <- NA
iiss$equipment_name[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                      iiss$equipment_subtype == "missiles" &
                      iiss$equipment_name == "MANPATS" &
                      iiss$equipment_subname == "MANPATS"] <- NA
iiss$equipment_name[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                      iiss$equipment_subtype == "missiles" &
                      iiss$equipment_name == "MLR" &
                      iiss$equipment_subname == "MLR"] <- NA
iiss$equipment_name[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                      iiss$equipment_subtype == "missiles" &
                      iiss$equipment_name == "SP" &
                      iiss$equipment_subname == "SP"] <- NA
iiss$equipment_name[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                      iiss$equipment_subtype == "missiles" &
                      iiss$equipment_name == "TOW" &
                      iiss$equipment_subname == "TOWED"] <- NA
iiss$equipment_name[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                      iiss$equipment_subtype == "missiles" &
                      iiss$equipment_name == "TOWED" &
                      iiss$equipment_subname == "TOWED"] <- NA
iiss$equipment_name[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                      is.na(iiss$equipment_subtype) &
                      iiss$equipment_name == "MSL" &
                      iiss$equipment_subname == "MANPATS"] <- NA
iiss$equipment_name[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                      is.na(iiss$equipment_subtype) &
                      iiss$equipment_name == "MSL" &
                      iiss$equipment_subname == "SP"] <- NA
iiss$equipment_name[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                      is.na(iiss$equipment_subtype) &
                      (iiss$equipment_name == "MANPAT" |
                         iiss$equipment_name == "MANPATS" |
                         iiss$equipment_name == "MANPADS") &
                      iiss$equipment_subname == "MANPATS"] <- NA
iiss$equipment_name[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                      iiss$equipment_subtype == "RCL" &
                      iiss$equipment_name == "RCL"] <- NA
iiss$equipment_name[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                      iiss$equipment_subtype == "RL" &
                      iiss$equipment_name == "RL"] <- NA
iiss$equipment_name[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                      iiss$equipment_subtype == "GUNS" &
                      iiss$equipment_name == "GUNS"] <- NA
iiss$equipment_name[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                         iiss$equipment_subtype == "RL" &
                         iiss$equipment_name == "RL 94mm"] <- NA
iiss$equipment_name[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                      iiss$equipment_subtype == "GUNS" &
                      iiss$equipment_name == "ATK GUNS"] <- "ATK"
iiss$equipment_name[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                         iiss$equipment_name == "MANPATS" &
                      iiss$equipment_subname == "MANPATS"] <- NA
iiss$equipment_name[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                      iiss$equipment_subtype == "GUNS" &
                      iiss$equipment_name == "ATK GUNS"] <- "ATK"
iiss$equipment_name[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                      iiss$equipment_subtype == "GUNS" &
                      iiss$equipment_name == "GUNS"] <- NA

```

Fix incorrect equipment_subtype that should have equipment_type = equipment_type
```{r}
# Convert to RL 
iiss$equipment_subtype[iiss$equipment_type == "gun" &
                         iiss$equipment_name == "RL"] <- "RL"
iiss$equipment_subtype[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                         iiss$equipment_name == "RL"] <- "RL"
iiss$equipment_name[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                         iiss$equipment_subtype == "RL"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "RL 94mm"] <- "RL"

# Convert to RCL
iiss$equipment_subtype[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                         iiss$equipment_name == "RCL"] <- "RCL"
iiss$equipment_subtype[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                         iiss$equipment_subtype == "greande launchers"] <- "RCL"

# Convert to GUNS
iiss$equipment_subtype[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                         iiss$equipment_subtype == "AD"] <- "GUNS"
iiss$equipment_subtype[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                         iiss$equipment_subtype == "ATK"] <- "GUNS"
iiss$equipment_subtype[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                         iiss$equipment_name == "ASLT GUN"] <- "GUNS"
iiss$equipment_subtype[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                         iiss$equipment_subtype == "ATK GUNS"] <- "GUNS"
iiss$equipment_subtype[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                         iiss$equipment_name == "ATK GUNS"] <- "GUNS"
iiss$equipment_subtype[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "GUNS"] <- "GUNS"
iiss$equipment_subtype[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "TOWED"] <- "GUNS"

# Convert to missiles
iiss$equipment_subtype[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                         is.na(iiss$equipment_subtype) &
                         is.na(iiss$equipment_name) &
                         iiss$equipment_subname == "MANPATS"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                         is.na(iiss$equipment_subtype) &
                         is.na(iiss$equipment_name) &
                         iiss$equipment_subname == "SP"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "SAM" &
                         is.na(iiss$equipment_name) &
                         iiss$equipment_subname == "MANPATS"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                         is.na(iiss$equipment_subtype) &
                         is.na(iiss$equipment_name) &
                         iiss$equipment_subname == "MANPATS"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "MSL" &
                         iiss$equipment_subname == "TOW"] <- "missiles"

# Convert to NA
iiss$equipment_subtype[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                         iiss$equipment_subtype == "missiles" &
                         (iiss$equipment_name == "MANPAT" |
                            iiss$equipment_name == "MANPATS" |
                            iiss$equipment_name == "RCL" |
                            iiss$equipment_name == "RL" |
                            iiss$equipment_name == "RL 94mm" |
                            iiss$equipment_name == "MANPAT")] <- NA
iiss$equipment_subtype[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                      iiss$equipment_subtype == "ATGW" &
                    iiss$equipment_name == "ATGW"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                         iiss$equipment_subtype == "GUNS" &
                         iiss$equipment_name == "GUNS"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                      iiss$equipment_subtype == "grenade launchers" & 
                      iiss$equipment_name == "ATGW" & 
                      (iiss$equipment_subname == "62mm" | 
                         iiss$equipment_subname == "40mm")] <- NA

```

Fix incorrect equipment_type that should have equipment_type = equipment_type
```{r}
# gun
iiss$equipment_type[iiss$equipment_subtype == "GUNS" &
                      iiss$equipment_name == "ATK"] <- "anti-tank/anti-infrastructure"

iiss$equipment_type[iiss$equipment_subtype == "gun" &
                      iiss$equipment_subtype == "RL" &
                      is.na(iiss$equipment_name)] <- "anti-tank/anti-infrastructure"

# Air defence
iiss$equipment_type[iiss$equipment_type == "air defence" &
                      iiss$equipment_subtype == "missiles" &
                      is.na(iiss$equipment_name) &
                      iiss$equipment_subname == "MANPATS"] <- "anti-tank/anti-infrastructure"
iiss$equipment_type[iiss$equipment_type == "air defence" &
                      iiss$equipment_subtype == "RL"] <- "anti-tank/anti-infrastructure"
iiss$equipment_type[iiss$equipment_type == "air defence" &
                      iiss$equipment_name == "ATK"] <- "anti-tank/anti-infrastructure"
iiss$equipment_type[iiss$equipment_type == "air defence" & 
                      iiss$equipment_subtype == "SAM" &  
                      iiss$equipment_name == "MANPATS"] <- "anti-tank/anti-infrastructure"

# Armoured fighting vehicles 
iiss$equipment_type[iiss$equipment_type == "armoured fighting vehicles" &
                      iiss$equipment_name %in% c("ATGW",
                                                 "RL")] <- "anti-tank/anti-infrastructure"

# Artillery
iiss$equipment_type[iiss$equipment_type == "artillery" &
                      iiss$equipment_name == "MSL"] <- "anti-tank/anti-infrastructure"
iiss$equipment_type[iiss$equipment_type == "artillery" &
                      iiss$equipment_subtype == "missiles"] <- "anti-tank/anti-infrastructure"

# Surface-to-surface missile launchers
iiss$equipment_type[iiss$equipment_type == "surface-to-surface missile launchers" &
                      iiss$equipment_name == "ATGW"] <- "anti-tank/anti-infrastructure"

# Engineering and maintenance vehicles
iiss$equipment_type[iiss$equipment_type == "engineering and maintenance vehicles" &
                      iiss$equipment_subtype == "RL"] <- "anti-tank/anti-infrastructure"

# Anti-tank guided missile
iiss$equipment_type[iiss$equipment_type == "Anti-tank guided missile"] <- "anti-tank/anti-infrastructure"

# NA
iiss$equipment_type[is.na(iiss$equipment_type) &
                         (iiss$equipment_name == "ASLT" |
                            iiss$equipment_name == "ATGW" |
                            iiss$equipment_name == "ATK GUNS" | 
                            iiss$equipment_name == "GUNS" |
                            iiss$equipment_name == "MANPATS" |
                            iiss$equipment_name == "RL" |
                            iiss$equipment_subtype == "RL" |
                            iiss$equipment_subtype == "ATK GUNS" |
                            iiss$unit_name == "RPG-22" |
                            iiss$unit_name == "M-72 LAW")] <- "anti-tank/anti-infrastructure"
iiss$equipment_type[is.na(iiss$equipment_type) &
                      iiss$unit_name == "9M120 Ataka (AT-12 Swinger)"] <- "anti-tank/anti-infrastructure"
iiss$equipment_type[iiss$equipment_subtype == "ATGW"] <- "anti-tank/anti-infrastructure"

iiss$equipment_type[is.na(iiss$equipment_type) &
                      iiss$equipment_subtype == "RCL"] <- "anti-tank/anti-infrastructure"
```

## Armoured fighting vehicles

### Typos
Here we fix typos, which include spelling errors, capitalization errors, and any other formatting errors that affect merging or equipment similarity

#### Unit_name typos
```{r}
iiss$unit_name[iiss$unit_name == "BMP-1/2"] <- "BMP-1/-2"

iiss$unit_name[iiss$unit_name == "BTR-60/70/80"] <- "BTR-60/-70/-80"

iiss$unit_name[iiss$unit_name == "MOWAG Grenadier (mod Roland)"] <- "MOWAG Grenadier"

iiss$unit_count[iiss$equipment_name == "MOR" &
                 iiss$equipment_subname == "81mm" &
                 iiss$unit_name == "707.0"] <- 707
iiss$unit_name[iiss$equipment_name == "MOR" &
                 iiss$equipment_subname == "81mm" &
                 iiss$unit_name == "707.0"] <- NA

iiss$unit_name[iiss$unit_name == "T-54 and T-59"] <- "T-54/T-59"

iiss$unit_name[iiss$unit_name == "7 > iM"] <- "TAM"

iiss$unit_name[iiss$unit_name == "Type-59-11"] <- "Type-59-II"
```

#### Equipment_subname typos
```{r}
iiss$equipment_subname[iiss$equipment_subname == "APC(T)-4K4"] <- "APC(T)"

iiss$equipment_subname[iiss$equipment_subname == "APC(T)-Ulan"] <- "APC(T)"

iiss$equipment_subname[iiss$equipment_subname == "APC(W)VAB"] <- "APC(W)"

iiss$equipment_subname[iiss$equipment_subname == "APC(T)/APC(W)"] <- "APC(T)/(W)"

iiss$equipment_subname[iiss$equipment_subname == "APC(W)/(T)"] <- "APC(T)/(W)"
```

#### Equipment_name typos
```{r}
iiss$equipment_name[iiss$equipment_name == "APC (w)"] <- "APC (W)"
iiss$equipment_name[iiss$equipment_name == "LT VEH 10"] <- "LT VEH"
iiss$equipment_name[iiss$equipment_name == "LTTK" |
                      iiss$equipment_name == "LT Tank" |
                      iiss$equipment_name == "light tanks" |
                      iiss$equipment_name == "LIGHT TANKs"] <- "LT TK"
iiss$equipment_subname[iiss$equipment_name == "PPV"] <- "PPV"
iiss$equipment_name[iiss$equipment_name == "PPV"] <- "APC"
iiss$equipment_name[iiss$equipment_name == "REECE"] <- "RECCE"
```

#### Equipment_subtype typos
```{r}
iiss$equipment_subtype[iiss$equipment_subtype == "GUNA"] <- "GUNS"
```

#### Equipment_type typos
```{r}
iiss$equipment_type[iiss$equipment_type == "APC"] <- "armoured fighting vehicles"
iiss$equipment_type[iiss$equipment_type == "armed cars"] <- "armoured fighting vehicles"
iiss$equipment_type[iiss$equipment_type == "armoured fighting vehicle"] <- "armoured fighting vehicles"
iiss$equipment_type[iiss$equipment_type == "armoured personnel carriers"] <- "armoured fighting vehicles"
iiss$equipment_type[iiss$equipment_type == "infantry fighting vehicles"] <- "armoured fighting vehicles"
iiss$equipment_type[iiss$equipment_type == "Light Tanks"] <- "armoured fighting vehicles"
iiss$equipment_type[iiss$equipment_type == "light vehicle"] <- "armoured fighting vehicles"
iiss$equipment_type[iiss$equipment_type == "Recce"] <- "armoured fighting vehicles"
iiss$equipment_type[iiss$equipment_type == "Tactical Security Group"] <- "armoured fighting vehicles"
iiss$equipment_type[iiss$equipment_type == "tanks"] <- "armoured fighting vehicles"
```

### Coding changes

#### Unit_name
Fix incorrect columns based on unit_name value
```{r}
# Unit_name


# Equipment_subname
iiss$equipment_subname[iiss$equipment_subname == "Cessna"] <- NA

# Equipment_name
iiss$equipment_name[iiss$unit_name == "Fiat 6616"] <- "RECCE"

# Equipment_subtype

# Equipment_type

```

#### Equipment_subname
Fix incorrect columns that should have equipment_subname = TBD
```{r}
# Unit_name

# Equipment_subname
iiss$equipment_subname[iiss$equipment_subname == "BMD"] <- NA
iiss$equipment_subname[iiss$equipment_subname == "BMP"] <- NA
iiss$equipment_subname[iiss$equipment_subname == "cars"] <- NA
iiss$equipment_subname[iiss$equipment_subname == "VBL"] <- NA

# Equipment_name
iiss$equipment_subtype[iiss$equipment_name == "APC"] <- NA

# Equipment_subtype

# Equipment_type

```

  REPEAT FOR EACH EQUIPMENT_SUBNAME AS NEEDED

#### Equipment_name
Fix incorrect columns that should have equipment_name = TBD
```{r}
# Unit_name
iiss$equipment_name[iiss$unit_name == "AML"] <- "RECCE"
iiss$equipment_name[iiss$unit_name == "AML-245"] <- "LT TK"
iiss$equipment_name[iiss$unit_name == "AML-60"] <- "LT TK"
iiss$equipment_name[iiss$unit_name == "AMX-13"] <- "LT TK"
iiss$equipment_name[iiss$unit_name == "AMX-13 VTT"] <- "LT TK"
iiss$equipment_name[iiss$unit_name == "BLR"] <- "APC"
iiss$equipment_name[iiss$unit_name == "BMD"] <- "AIFV"
iiss$equipment_name[iiss$unit_name == "BMP"] <- "AIFV"
iiss$equipment_name[iiss$unit_name == "BTR APC (W)/M-113A APT (T)"] <- "APC"
iiss$equipment_name[iiss$unit_name == "BTR-40"] <- "RECCE"
iiss$equipment_type[iiss$unit_name == "BTR-40"] <- "armoured fighting vehicles"
iiss$equipment_name[iiss$unit_name == "BTR-40P"] <- "RECCE"
iiss$equipment_name[iiss$unit_name == "BTR-60"] <- "APC"
iiss$equipment_type[iiss$unit_name == "BTR-60"] <- "armoured fighting vehicles"
iiss$equipment_name[iiss$unit_name == "BTR-70"] <- "APC"
iiss$equipment_name[iiss$unit_name == "BTR-80"] <- "APC"
iiss$equipment_name[iiss$unit_name == "EE-9 Cascavel"] <- "RECCE"
iiss$equipment_name[iiss$unit_name == "Fennek"] <- "RECCE"
iiss$equipment_name[iiss$unit_name == "Fiat 6616"] <- "RECCE"
iiss$equipment_name[iiss$unit_name == "FUG"] <- "RECCE"
iiss$equipment_name[iiss$unit_name == "FUG 65"] <- "RECCE"
iiss$equipment_name[iiss$unit_name == "FUG-66"] <- "RECCE"
iiss$equipment_name[iiss$unit_name == "FUG-70"] <- "RECCE"
iiss$equipment_name[iiss$unit_name == "FUG-A"] <- "RECCE"
iiss$equipment_name[iiss$unit_name == "FUG-M"] <- "RECCE"
iiss$equipment_name[iiss$unit_name == "LVTP-7 AAV"] <- "AAV"
iiss$equipment_name[iiss$unit_name == "M-20"] <- "RECCE"
iiss$equipment_name[iiss$unit_name == "M-551 Sheridan" &
                      iiss$equipment_name == "TRG"] <- "LT TK"
iiss$equipment_name[iiss$unit_name == "M-60PB"] <- "APC"
iiss$equipment_name[iiss$unit_name == "M-706"] <- "APC"
iiss$equipment_name[iiss$unit_name == "M-9"] <- "APC"
iiss$equipment_name[iiss$unit_name == "MOWAG Roland"] <- "RECCE"
iiss$equipment_subtype[iiss$unit_name == "MOWAG Roland"] <- NA
iiss$equipment_name[iiss$equipment_subtype == "scout"] <- "RECCE"
iiss$equipment_name[iiss$unit_name == "OT-65"] <- "RECCE"
iiss$equipment_name[iiss$unit_name == "PSZH"] <- "APC"
iiss$equipment_name[iiss$unit_name == "PT-76"] <- "LT TK"
iiss$equipment_name[iiss$unit_name == "Saladin"] <- "RECCE"
iiss$equipment_name[iiss$unit_name == "Scorpion lt tk"] <- "LT TK"
iiss$equipment_name[iiss$unit_name == "Tpz-1 Fuchs"] <- "APC"
iiss$equipment_name[iiss$unit_name == "TM-170"] <- "APC"
iiss$equipment_name[iiss$unit_name == "VAB Reco NBC"] <- "APC"
iiss$equipment_name[iiss$unit_name == "VBL M-11"] <- "RECCE"
iiss$equipment_name[iiss$unit_name == "VCC2"] <- "APC"
iiss$equipment_name[iiss$unit_name == "VCTP"] <- "APC"
iiss$equipment_name[iiss$unit_name == "Wiesel"] <- "LT TK"

# Equipment_subname
iiss$equipment_name[iiss$equipment_subtype == "scout cars"] <- "RECCE"

iiss$equipment_name[iiss$equipment_subname == "AAV"] <- "AAV"
iiss$equipment_subname[iiss$equipment_subname == "AAV"] <- NA

iiss$equipment_name[iiss$equipment_subname == "APC"] <- "APC"
iiss$equipment_subname[iiss$equipment_subname == "APC"] <- NA

iiss$equipment_name[iiss$equipment_subname == "APC(T)"] <- "APC(T)"
iiss$equipment_subname[iiss$equipment_subname == "APC(T)"] <- NA

iiss$equipment_name[iiss$equipment_subname == "APC(T)/(W)"] <- "APC(T)/(W)"
iiss$equipment_subname[iiss$equipment_subname == "APC(T)/(W)"] <- NA

iiss$equipment_name[iiss$equipment_subname == "APC(W)"] <- "APC(W)"
iiss$equipment_subname[iiss$equipment_subname == "APC(W)"] <- NA

iiss$equipment_name[iiss$equipment_subname == "LTTK"] <- "LT TK"
iiss$equipment_subname[iiss$equipment_subname == "LTTK"] <- NA

iiss$equipment_name[iiss$equipment_subname == "PPV"] <- "PPV"
iiss$equipment_subname[iiss$equipment_subname == "PPV"] <- NA

iiss$equipment_subname[iiss$equipment_type == "armoured fighting vehicles" &
                         iiss$equipment_subname == "PPC"] <- "PPV"

# Equipment_name
iiss$equipment_name[iiss$equipment_name == "MRH" &
                      iiss$equipment_type == "armoured fighting vehicles"] <- "RECCE"

iiss$equipment_type[iiss$equipment_name == "MBT"] <- "armoured fighting vehicles"

iiss$equipment_name[iiss$equipment_name == "heavy tanks"] <- "HY TK"

iiss$equipment_name[iiss$equipment_name == "LT"] <- "LT TK"

iiss$equipment_name[iiss$equipment_name == "MD TK"] <- "MED TK"
iiss$equipment_name[iiss$equipment_name == "MEDIUM TANKS"] <- "MED TK"

# Equipment_subtype
iiss$equipment_name[iiss$equipment_subtype == "LT TK"] <- "LT TK"
iiss$equipment_name[iiss$equipment_subtype == "lt."] <- "LT TK"

iiss$equipment_subtype[iiss$equipment_subtype == "LT TK"] <- NA
iiss$equipment_subtype[iiss$equipment_subtype == "lt."] <- NA
iiss$equipment_subtype[iiss$equipment_subtype == "missiles"] <- NA

iiss$equipment_subtype[iiss$equipment_subtype == "missiles" &
                         iiss$equipment_name == "RECCE"] <- NA

# Equipment_type
iiss$equipment_type[iiss$equipment_name == "APC" |
                      iiss$equipment_name == "APC(T)" |
                      iiss$equipment_name == "APC(W)" |
                      iiss$equipment_name == "APC(T)/(W)"] <- "armoured fighting vehicles"

```

  REPEAT FOR EACH EQUIPMENT_NAME AS NEEDED
  
#### Equipment_subtype
Fix incorrect columns that should have equipment_subtype = TBD
```{r}
# Unit_name

# Equipment_subname
iiss$equipment_subname[iiss$equipment_type == "armoured fighting vehicles" &
                         iiss$equipment_subname %in% c("armedcars",
                                                       "GrenadeLauncher",
                                                       "scoutcar",
                                                       "Stuart",
                                                       "VCTP(inclvarients)",
                                                       "VEH")] <- NA

# Equipment_name
iiss$equipment_subtype[iiss$equipment_type == "artillery" &
                         iiss$equipment_name == "other"] <- "MOR"

# Equipment_subtype
iiss$equipment_subtype[iiss$equipment_type == "armoured fighting vehicles" &
                         iiss$equipment_subtype %in% c("AFV",
                                                       "APC",
                                                       "MICV",
                                                       "scout cars")] <- NA

iiss$equipment_type[iiss$equipment_type == "artillery" &
                         iiss$equipment_subtype == "APC"] <- "armoured fighting vehicles"
iiss$equipment_name[iiss$equipment_type == "armoured fighting vehicles" &
                         iiss$equipment_subtype == "APC"] <- "APC"
iiss$equipment_subtype[iiss$equipment_type == "armoured fighting vehicles" &
                         iiss$equipment_subtype == "APC"] <- NA

# Equipment_type

```

  REPEAT FOR EACH EQUIPMENT_SUBTYPE AS NEEDED

#### Equipment_type

Fix incorrect unit_name that should have equipment_type = equipment_type
```{r}
iiss$unit_name[iiss$equipment_type == "armoured fighting vehicles" &
                 iiss$equipment_name == "AIFV" &
                 iiss$equipment_subname == "BRM-1K"] <- "BRM-1K"

iiss$equipment_type[iiss$unit_name == "SK-105 Kuerassier"] <- "armoured fighting vehicles"
iiss$equipment_subname[iiss$unit_name == "SK-105 Kuerassier"] <- NA

iiss$equipment_type[iiss$unit_name %in% c("SK-105 Kuerassier",
                                          "Kuerassier SP",
                                          "SK-105  Kuerassier SP")] <- "armoured fighting vehicles"
iiss$equipment_subname[iiss$unit_name %in% c("SK-105 Kuerassier",
                                          "Kuerassier SP",
                                          "SK-105  Kuerassier SP")] <- NA
iiss$equipment_name[iiss$unit_name %in% c("SK-105 Kuerassier",
                                          "Kuerassier SP",
                                          "SK-105  Kuerassier SP")] <- "LT TK"

iiss$equipment_type[iiss$unit_name %in% c("BTR-60",
                                          "M-101",
                                          "M-109",
                                          "M32 Recovery Sherman")] <- "armoured fighting vehicles"
iiss$equipment_subtype[iiss$unit_name %in% c("BTR-60",
                                          "M-101",
                                          "M-109",
                                          "M32 Recovery Sherman")] <- NA
iiss$equipment_name[iiss$unit_name %in% c("BTR-60",
                                          "M-101",
                                          "M-109",
                                          "M32 Recovery Sherman")] <- "APC"
iiss$equipment_subname[iiss$unit_name %in% c("BTR-60",
                                          "M-101",
                                          "M-109",
                                          "M32 Recovery Sherman")] <- NA

iiss$equipment_subname[iiss$unit_name == "M-48"] <- NA

iiss$equipment_type[iiss$unit_name == "AT-105"] <- "armoured fighting vehicles"

iiss$equipment_type[iiss$equipment_name == "APC" |
                      iiss$equipment_name == "APC(T)" |
                      iiss$equipment_name == "APC(W)" |
                      iiss$equipment_name == "APC(T)/(W)"] <- "armoured fighting vehicles"

iiss$equipment_name[iiss$equipment_subtype == "ARV"] <- "armoured fighting vehicles"
iiss$equipment_type[iiss$equipment_name == "ARV"] <- "armoured fighting vehicles"
iiss$equipment_subtype[iiss$equipment_name == "ARV" &
                      iiss$equipment_subtype == "ARV"] <- NA

```

Fix incorrect equipment_subname that should have equipment_type = equipment_type
```{r}
# Convert to APC (W)
iiss$equipment_subname[iiss$equipment_type == "armoured fighting vehicles" &
                         is.na(iiss$equipment_subtype) &
                         (iiss$equipment_name == "APC (W)" |
                            iiss$equipment_name == "APC (w)")] <- "APC (W)"
iiss$equipment_subname[iiss$equipment_type == "armoured fighting vehicles" &
                      iiss$equipment_subtype == "APC(W)"] <- "APC (W)"
iiss$equipment_subname[iiss$equipment_type == "armoured fighting vehicles" &
                         iiss$equipment_name == "APAPC (W)"] <- "APC (W)"
iiss$equipment_subname[iiss$equipment_type == "armoured fighting vehicles" &
                         iiss$equipment_name == "APC(W)"] <- "APC (W)"

# Convert to APC (T)
iiss$equipment_subname[iiss$equipment_type == "armoured fighting vehicles" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "APC (T)"] <- "APC(T)"

# Convert to PPV
iiss$equipment_subname[iiss$equipment_type == "armoured fighting vehicles" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "PPV" &
                            is.na(iiss$equipment_subname)] <- "PPV"

# Convert to L-A-L
iiss$equipment_subname[iiss$equipment_type == "armoured fighting vehicles" &
                         iiss$equipment_name == "L-A-L" &
                         iiss$equipment_subname == "AIFV/APC"] <- "L-A-L"
iiss$equipment_subname[iiss$equipment_type == "armoured fighting vehicles" &
                         iiss$equipment_subname == "TYPEVARIANTS"] <- "L-A-L"

# Convert to NA 
iiss$equipment_subname[iiss$equipment_type == "armoured fighting vehicles" &
                      iiss$equipment_name == "LFV" &
                      iiss$equipment_subname == "LFV"] <- NA
iiss$equipment_subname[iiss$equipment_type == "armoured fighting vehicles" &
                         iiss$equipment_name == "AIFV/APC" &
                         iiss$equipment_subname == "APC"] <- NA
iiss$equipment_subname[iiss$equipment_type == "armoured fighting vehicles" &
                         iiss$equipment_name == "MBT" &
                         iiss$equipment_subname == "MBT"] <- NA
iiss$equipment_subname[iiss$equipment_type == "armoured fighting vehicles" &
                         iiss$equipment_name == "LT TK" &
                         iiss$equipment_subname == "LTLK"] <- NA
iiss$equipment_subname[iiss$equipment_type == "armoured fighting vehicles" &
                      iiss$equipment_name == "LT TK" &
                      iiss$equipment_subname == "TK"] <- NA
iiss$equipment_subname[iiss$equipment_type == "armoured fighting vehicles" &
                         iiss$equipment_name == "LT VEH" &
                         iiss$equipment_subname == "VEH"] <- NA
iiss$equipment_subname[iiss$equipment_type == "armoured fighting vehicles" &
                 iiss$equipment_name == "AIFV" &
                 iiss$equipment_subname == "BRM-1K"] <- NA
iiss$equipment_subname[iiss$equipment_type == "armoured fighting vehicles" &
                      iiss$equipment_name == "VCTP" &
                      iiss$equipment_subname == "VCTP(inclvarients)"] <- NA
iiss$equipment_subname[iiss$equipment_type == "armoured fighting vehicles" & 
                         (iiss$equipment_name == "RECCE" | 
                            iiss$equipment_name == "AFV") & 
                         iiss$equipment_subname == "90mm"] <- NA
```

Fix incorrect equipment_name that should have equipment_type = equipment_type
```{r}
# Convert to LT TK
iiss$equipment_name[iiss$equipment_type == "armoured fighting vehicles" &
                      is.na(iiss$equipment_subtype) &
                      (iiss$equipment_name == "Light Tanks" |
                         iiss$equipment_name == "LIGHT TANK" |
                         iiss$equipment_name == "LIGHT TANKS")] <- "LT TK"
iiss$equipment_name[iiss$equipment_type == "armoured fighting vehicles" &
                      iiss$equipment_subname == "LTLK"] <- "LT TK"
iiss$equipment_name[iiss$equipment_type == "armoured fighting vehicles" &
                      iiss$equipment_name == "LT" &
                      iiss$equipment_subname == "TK"] <- "LT TK"

# Convert to LT VEH
iiss$equipment_name[iiss$equipment_type == "armoured fighting vehicles" &
                      iiss$equipment_name == "LT" &
                      iiss$equipment_subname == "VEH"] <- "LT VEH"

# Convert to MBT
iiss$equipment_name[iiss$equipment_type == "armoured fighting vehicles" &
                      is.na(iiss$equipment_subtype) &
                      iiss$equipment_name == "TK MBT"] <- "MBT"
iiss$equipment_name[iiss$equipment_type == "armoured fighting vehicles" &
                      iiss$equipment_subname == "MBT"] <- "MBT"

# Convert to APC 
iiss$equipment_name[iiss$equipment_type == "armoured fighting vehicles" &
                      is.na(iiss$equipment_subtype) &
                      (iiss$equipment_name == "APC (W)" |
                         iiss$equipment_name == "APC (w)") &
                      iiss$equipment_subname == "APC (W)"] <- "APC"
iiss$equipment_name[iiss$equipment_type == "armoured fighting vehicles" &
                      is.na(iiss$equipment_subtype) &
                      (iiss$equipment_name == "APC (T)" |
                         iiss$equipment_name == "APC(T)") &
                      iiss$equipment_subname == "APC (T)"] <- "APC"
iiss$equipment_name[iiss$equipment_type == "armoured fighting vehicles" &
                      is.na(iiss$equipment_subtype) &
                      iiss$equipment_name == "PPV" &
                      iiss$equipment_subname == "PPV"] <- "APC"
iiss$equipment_name[iiss$equipment_type == "armoured fighting vehicles" &
                      iiss$equipment_subtype == "APC(W)" &
                      iiss$equipment_subname == "APC (W)"] <- "APC"
iiss$equipment_name[iiss$equipment_type == "armoured fighting vehicles" &
                         iiss$equipment_name == "APAPC (W)" &
                      iiss$equipment_subname == "APC (W)"] <- "APC"
iiss$equipment_name[iiss$equipment_type == "armoured fighting vehicles" &
                      iiss$equipment_name == "APC (W)" &
                      iiss$equipment_subname == "APC (W)"] <- "APC"
iiss$equipment_name[iiss$equipment_type == "armoured fighting vehicles" &
                       iiss$equipment_subname == "APC(W)VAB"] <- "APC"
iiss$equipment_name[iiss$equipment_type == "radars" &
                      iiss$unit_name == "M-113 Land"] <- "APC"
iiss$equipment_name[iiss$equipment_type == "armoured fighting vehicles" & 
                      iiss$equipment_name == "APC(W)" & 
                      iiss$equipment_subname == "APC (W)"] <- "APC"

iiss$equipment_type[iiss$equipment_name == "APC" |
                      iiss$equipment_name == "APC(T)" |
                      iiss$equipment_name == "APC(W)" |
                      iiss$equipment_name == "APC(T)/(W)"] <- "armoured fighting vehicles"

# Convert to ASLT
iiss$equipment_name[iiss$equipment_type == "armoured fighting vehicles" &
                      iiss$equipment_name == "ASLT GUN"] <- "ASLT"

# Convert to RECCE
iiss$equipment_name[iiss$equipment_type == "armoured fighting vehicles" &
                      iiss$equipment_subtype == "RECCE"] <- "RECCE"
iiss$equipment_name[iiss$equipment_type == "armoured fighting vehicles" &
                      iiss$equipment_subname == "RECCE"] <- "RECCE"

# Convert to LFV
iiss$equipment_name[iiss$equipment_type == "armoured fighting vehicles" &
                      iiss$equipment_subname == "LFV"] <- "LFV"

# Convert to AIFV/APC
iiss$equipment_name[iiss$equipment_type == "armoured fighting vehicles" &
                         iiss$equipment_name == "L-A-L" &
                         iiss$equipment_subname == "L-A-L"] <- "AIFV/APC"
iiss$equipment_name[iiss$equipment_type == "armoured fighting vehicles" &
                      iiss$equipment_name == "AIFV" &
                      iiss$equipment_subname == "APC"] <- "AIFV/APC"
iiss$equipment_name[iiss$equipment_type == "armoured fighting vehicles" &
                      iiss$equipment_name == "AIFV/APC (W)"] <- "AIFV/APC"
iiss$equipment_name[iiss$equipment_type == "armoured fighting vehicles" &
                      iiss$equipment_name == "RECCE/AIFV/APC (W)"] <- "AIFV/APC"

# Convert to VCTP
iiss$equipment_name[iiss$equipment_type == "armoured fighting vehicles" &
                      iiss$equipment_subname == "VCTP(inclvarients)"] <- "VCTP"
```

Fix incorrect equipment_subtype that should have equipment_type = equipment_type
```{r}
# Convert to NA
iiss$equipment_subtype[iiss$equipment_type == "armoured fighting vehicles" &
                         (iiss$equipment_subtype == "TK" |
                            iiss$equipment_subtype == "XA Series")] <- NA
iiss$equipment_subtype[iiss$equipment_type == "armoured fighting vehicles" &
                      iiss$equipment_subtype == "APC(W)" &
                        iiss$equipment_name == "APC" &
                      iiss$equipment_subname == "APC (W)"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "armoured fighting vehicles" &
                         iiss$equipment_subtype == "RECCE" &
                         iiss$equipment_name == "RECCE"] <- NA
iiss$equipment_subname[iiss$equipment_type == "armoured fighting vehicles" &
                         iiss$equipment_name == "RECCE" &
                      iiss$equipment_subname == "RECCE"] <- NA
```

Fix incorrect equipment_type that should have equipment_type = equipment_type
```{r}
# Artillery
iiss$equipment_type[iiss$equipment_type == "artillery" &
                      (iiss$equipment_name == "AIFV" |
                         iiss$equipment_name == "APC" |
                         iiss$equipment_name == "APC(T)" |
                         iiss$equipment_name == "MBT" |
                         iiss$equipment_name == "LT TK")] <- "armoured fighting vehicles"

# Radars
iiss$equipment_type[iiss$equipment_type == "radars" &
                      iiss$equipment_name == "APC" &
                      iiss$unit_name == "M-113 Land"] <- "armoured fighting vehicles"

# NA
iiss$equipment_type[is.na(iiss$equipment_type) &
                      (iiss$equipment_name == "AIFV" |
                       iiss$equipment_name == "APC" |
                         iiss$equipment_name == "LT" |
                         iiss$equipment_name == "LT TK" |
                         iiss$equipment_name == "MBT" |
                         iiss$equipment_name == "RECCE" |
                         iiss$equipment_name == "APC(T)" |
                         iiss$equipment_name == "APC (T)" |
                         iiss$equipment_name == "APC (W)" |
                         (iiss$service == "Joint Forces Command (JFC)" &
                            iiss$equipment_name == "RCL") |
                         iiss$equipment_subtype == "RECCE" |
                         iiss$equipment_subtype == "APC(W)" |
                         iiss$equipment_subname == "MBT" |
                         iiss$equipment_subname == "RECCE" |
                         iiss$equipment_subname == "LTLK")] <- "armoured fighting vehicles"
iiss$equipment_type[is.na(iiss$equipment_type) &
                      (iiss$unit_name == "AML" |
                         iiss$unit_name == "AMX-30" |
                         iiss$unit_name == "AMX-VTT" |
                         iiss$unit_name == "BTR-80" |
                         iiss$unit_name == "Fiat 6616" |
                         iiss$unit_name == "PSZH" |
                         iiss$unit_name == "TM-170" |
                         iiss$unit_name == "VCC2")] <- "armoured fighting vehicles"

iiss$equipment_type[iiss$equipment_name == "AAV"] <- "armoured fighting vehicles"
iiss$equipment_type[iiss$equipment_name == "AFV"] <- "armoured fighting vehicles"

iiss$equipment_type[iiss$equipment_type == "gendarmerie royale" &
                      iiss$unit_name == "armed cars"] <- "armoured fighting vehicles"
iiss$equipment_name[iiss$equipment_type == "gendarmerie royale" &
                      iiss$unit_name == "armed cars"] <- "APC"

iiss$equipment_subtype[iiss$equipment_type == "artillery" &
                      iiss$equipment_name == "RECCE"] <- NA
iiss$equipment_type[iiss$unit_name == "M-20"] <- "armoured fighting vehicles"

# Surface-to-surface missile launchers
iiss$equipment_type[iiss$equipment_type == "surface-to-surface missile launchers" &
                      iiss$equipment_name == "MBT"] <- "armoured fighting vehicles"

iiss$equipment_type[iiss$equipment_name == "APC" |
                      iiss$equipment_name == "APC(T)" |
                      iiss$equipment_name == "APC(W)" |
                      iiss$equipment_name == "APC(T)/(W)"] <- "armoured fighting vehicles"
```

## Artillery

### Typos
Here we fix typos, which include spelling errors, capitalization errors, and any other formatting errors that affect merging or equipment similarity

#### Unit_name typos
```{r}

```

#### Equipment_subname typos
```{r}
iiss$equipment_subname[iiss$equipment_subname == "R120mm"] <- "120mm"

iiss$equipment_subname[iiss$equipment_subname == "R81mm"] <- "81mm"

iiss$equipment_subname[iiss$equipment_subname == "-107mm"] <- "107mm"

iiss$equipment_subname[iiss$equipment_subname == "R120mm"] <- "120mm"

iiss$equipment_subname[iiss$equipment_subname == "/107mm"] <- "107mm"

iiss$equipment_subname[iiss$equipment_subname == "100m"] <- "100mm"

iiss$equipment_subname[iiss$equipment_subname == "105/155mm"] <- "105mm/155mm"

iiss$equipment_subname[iiss$equipment_subname == "105mmtowed"] <- "105mm"

iiss$equipment_subname[iiss$equipment_subname == "1155mm"] <- "115mm"

iiss$equipment_subname[iiss$equipment_subname == "122/227mm"] <- "122mm/227mm"

iiss$equipment_subname[iiss$equipment_subname == "122m" |
                         iiss$equipment_subname == "122MM"] <- "122mm"

iiss$equipment_subname[iiss$equipment_subname == "12mm"] <- "122mm"

iiss$equipment_subname[iiss$equipment_subname == "20MM"] <- "20mm"

iiss$equipment_subname[iiss$equipment_subname == "152MM"] <- "152mm"

iiss$equipment_subname[iiss$equipment_subname == "155m" |
                         iiss$equipment_subname == "155MM"] <- "155mm"

iiss$equipment_subname[iiss$equipment_subname == "20/3mm" |
                         iiss$equipment_subname == "203MM"] <- "203mm"

iiss$equipment_subname[iiss$equipment_subname == "30MM"] <- "30mm"

iiss$equipment_subname[iiss$equipment_subname == "35mm,57mm,85mm,and100mm"] <- "35mm/57mm/85mm/100mm"

iiss$equipment_subname[iiss$equipment_subname == "37mm,57mm,85mm,100mm"] <- "37mm/57mm/85mm/100mm"

iiss$equipment_subname[iiss$equipment_subname == "37mm,85mm,100mm"] <- "37mm/85mm/100mm"

iiss$equipment_subname[iiss$equipment_subname == "57mm,85mm,and100mm"] <- "57mm/85mm/100mm"

iiss$equipment_subname[iiss$equipment_subname == "76mm,122mm,122mm,130mm"] <- "76mm/122mm/130mm"

iiss$equipment_subname[iiss$equipment_subname == "81mm;82mm"] <- "81mm/82mm"

iiss$equipment_subname[iiss$equipment_subname == "85mm,100mm"] <- "85mm/100mm"

iiss$equipment_subname[iiss$equipment_subname == "85mm,100mm,130mm"] <- "85mm/100mm/130mm"

iiss$equipment_subname[iiss$equipment_subname == "85mm,152mm"] <- "85mm/152mm"

iiss$equipment_subname[iiss$equipment_subname == "M-140mm"] <- "140mm"

iiss$equipment_subname[iiss$equipment_subname == "14.5mm/23mm/37mm/57mm/85mm/"] <- "14.5mm/23mm/37mm/57mm/85mm"

iiss$equipment_subname[iiss$equipment_subname == "MIM-23"] <- NA

```

#### Equipment_name typos
```{r}
iiss$equipment_name[iiss$equipment_name == "MORTARS"] <- "MOR"

iiss$equipment_name[iiss$equipment_name == "ROCKETS"] <- "RL"

iiss$equipment_name[iiss$equipment_name == "AD ARTY"] <- "AA"

iiss$equipment_name[iiss$equipment_name == "GUN/HOW"] <- "GUNS/HOW"

iiss$equipment_name[iiss$equipment_name == "GUN/TOWED"] <- "GUNS/TOWED"

iiss$equipment_name[iiss$equipment_name == "GUNS-SP"] <- "GUNS/SP"

iiss$equipment_name[iiss$equipment_name == "MR;"] <- "MRL"

iiss$equipment_name[iiss$equipment_name == "MPR"] <- "MOR"

iiss$equipment_name[iiss$equipment_type == "artillery" &
                      iiss$equipment_name == "AD"] <- "AA"

iiss$equipment_name[iiss$equipment_name == "Other"] <- "other"

iiss$equipment_name[iiss$equipment_name == "arty/MRL/mors" |
                      iiss$equipment_name == "MRL/MORs" |
                      iiss$equipment_name == "MRL/mor" |
                      iiss$equipment_name == "artillery/MRL/MOR"] <- "MRL/MOR"
iiss$equipment_name[iiss$equipment_name == "Coastal" |
                      iiss$equipment_name == "COASTAL"] <- "coastal"

iiss$equipment_name[iiss$equipment_subtype %in% c("AA",
                                                  "AD GUNS",
                                                  "gun/how",
                                                  "guns",
                                                  "GUNS",
                                                  "GUNS/how",
                                                  "how",
                                                  "HOW",
                                                  "MOR",
                                                  "SP") &
                      iiss$equipment_name == "SPT"] <- "SP"

iiss$equipment_name[iiss$equipment_type == "artillery" &
                      is.na(iiss$equipment_subtype) &
                      iiss$equipment_name == "SPT"] <- "SP"

iiss$equipment_name[iiss$equipment_name == "SP ARTY"] <- "SP"

iiss$equipment_name[iiss$equipment_name %in% c("SP how",
                                               "SP HOW")] <- "SP/HOW"

iiss$equipment_name[iiss$equipment_name == "TOWED/SP"] <- "SP/TOWED"

iiss$equipment_name[iiss$equipment_name == "RCl"] <- "RCL"
```

#### Equipment_subtype typos
```{r}
iiss$equipment_subtype[iiss$equipment_name == "guns"] <- "GUNS"

iiss$equipment_subtype[iiss$equipment_subtype == "gun/how"] <- "GUNS/HOW"
iiss$equipment_subtype[iiss$equipment_subtype == "GUNS/how"] <- "GUNS/HOW"
iiss$equipment_subtype[iiss$equipment_subtype == "guns"] <- "GUNS"
iiss$equipment_subtype[iiss$equipment_subtype == "how"] <- "HOW"
```

#### Equipment_type typos
```{r}
iiss$equipment_type[iiss$equipment_type == "ARTY"] <- "artillery"
iiss$equipment_type[iiss$equipment_type == "Torpedoes"] <- "artillery"
iiss$equipment_type[iiss$equipment_type == "infantry mortar"] <- "artillery"
iiss$equipment_type[iiss$equipment_type == "launch vehicle"] <- "artillery"
iiss$equipment_type[iiss$equipment_type %in% c("Mortars",
                                               "mortars")] <- "artillery"
iiss$equipment_type[iiss$equipment_type == "Towed Arty"] <- "artillery"
iiss$equipment_type[iiss$equipment_type == "towed field artillery"] <- "artillery"

iiss$equipment_type[iiss$equipment_type == "mobile emergency police force" &
                      iiss$equipment_subtype == "artillery"] <- "artillery"
iiss$equipment_subtype[iiss$equipment_type == "artillery" &
                      iiss$equipment_subtype == "artillery"] <- NA
```

### Coding changes

#### Unit_name
Fix incorrect columns based on unit_name value
```{r}
# Unit_name

# Equipment_subname

# Equipment_name
iiss$equipment_name[iiss$unit_name == "M-198"] <- "TOWED"

# Equipment_subtype
iiss$equipment_subtype[iiss$unit_name == "M-1938"] <- "MOR"

# Equipment_type
iiss$equipment_type[iiss$unit_name == "M-1938"] <- "artillery"

iiss$equipment_type[iiss$unit_name == "M-198"] <- "artillery"

iiss$equipment_type[iiss$unit_name == "AMX-VTT"] <- "artillery"

```

#### Equipment_subname
Fix incorrect columns that should have equipment_subname = TBD
```{r}
# Unit_name
iiss$equipment_subname[iiss$unit_name == "AMX-VTT"] <- "81mm"

# Equipment_subname

# Equipment_name
iiss$equipment_subname[iiss$equipment_name == "152mm"] <- "152mmmm"
iiss$equipment_name[iiss$equipment_name == "152mm" &
                      iiss$equipment_subname == "152mm"] <- NA

iiss$equipment_subname[iiss$equipment_name == "152mm" &
                      iiss$equipment_subtype == "GUNS"] <- "152mm"
iiss$equipment_name[iiss$equipment_name == "152mm" &
                      iiss$equipment_subtype == "GUNS"] <- NA

# Equipment_subtype

# Equipment_type

```

  REPEAT FOR EACH EQUIPMENT_SUBNAME AS NEEDED

#### Equipment_name
Fix incorrect columns that should have equipment_name = TBD
```{r}
# Unit_name
iiss$equipment_name[iiss$unit_name == "25-pdr"] <- "TOWED"
iiss$equipment_subtype[iiss$unit_name == "Blowpipe"] <- NA
iiss$equipment_name[iiss$unit_name == "Blowpipe"] <- "SAM"
iiss$equipment_subname[iiss$unit_name == "Blowpipe"] <- "MANPAD"
iiss$equipment_name[iiss$unit_name == "BM-21"] <- "MRL"
iiss$equipment_name[iiss$unit_name == "M-1931/37"] <- "TOWED"
iiss$equipment_name[iiss$unit_name == "SS-C-3"] <- "COAST"
iiss$equipment_name[iiss$unit_name == "Steyr SK-105"] <- "GUNS"

iiss$equipment_type[iiss$equipment_type == "air defence" &
                      iiss$unit_name == "BM-21"] <- "artillery"

iiss$equipment_type[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                      (iiss$unit_name == "40/L-70" |
                       iiss$unit_name == "L-70")] <- "artillery"

iiss$equipment_subtype[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                      (iiss$unit_name == "M-42" |
                         iiss$unit_name == "M-117")] <- "GUNS"
iiss$equipment_type[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                      (iiss$unit_name == "M-42" |
                         iiss$unit_name == "M-117")] <- "artillery"

iiss$equipment_name[iiss$equipment_type == "artillery" &
                      iiss$equipment_name == "ATK" &
                      iiss$unit_name %in% c("JPK C-80",
                                            "JPK C-90",
                                            "JPz-4K",
                                            "JPZ4-5")] <- "GUNS"

iiss$equipment_subtype[iiss$equipment_type == "armoured fighting vehicles" &
                      iiss$unit_name == "M-77"] <- "MRL"
iiss$equipment_type[iiss$equipment_type == "armoured fighting vehicles" &
                      iiss$unit_name == "M-77"] <- "artillery"
iiss$equipment_type[iiss$equipment_name == "MBT" &
                      iiss$unit_name == "M-77"] <- NA

# Equipment_subname

# Equipment_name
iiss$equipment_name[iiss$equipment_name == "AA guns"] <- "GUNS"
iiss$equipment_name[iiss$equipment_name == "AD/SAM"] <- "SAM"

iiss$equipment_name[iiss$equipment_type == "artillery" &
                      iiss$equipment_subname == "ATGW"] <- "ATGW"
iiss$equipment_subname[iiss$equipment_type == "artillery" &
                      iiss$equipment_subname == "ATGW"] <- NA

iiss$equipment_name[iiss$equipment_type == "artillery" &
                      iiss$equipment_subtype == "ATK"] <- "GUNS"

iiss$equipment_subtype[iiss$equipment_type == "artillery" &
                      iiss$equipment_subtype == "ATK"] <- NA

iiss$equipment_name[iiss$equipment_type == "artillery" &
                      iiss$equipment_subtype %in% c("AA SP",
                                                    "AD",
                                                    "AD GUNS")] <- "AA"

iiss$equipment_name[iiss$equipment_type == "artillery" &
                      iiss$equipment_name == "ATK GUNS"] <- "ATK"

iiss$equipment_name[iiss$equipment_subtype == "GUNS" &
                      iiss$equipment_name %in% c("ATK GUNS",
                                                 "GUNS")] <- "ATK"

iiss$equipment_name[iiss$equipment_type == "artillery" &
                      iiss$equipment_name == "ASLT GUN"] <- NA

iiss$equipment_name[iiss$equipment_name == "twin"] <- "SP"

iiss$equipment_subtype[iiss$equipment_type == "artillery" &
                      iiss$equipment_name == "rifles"] <- NA
iiss$equipment_name[iiss$equipment_type == "artillery" &
                      iiss$equipment_name == "rifles"] <- "RCL"

# Equipment_subtype
iiss$equipment_subtype[iiss$equipment_name == "Combined GUN/MOR"] <- "GUNS/MOR"
iiss$equipment_subtype[iiss$equipment_name == "GUN"] <- "GUNS"
iiss$equipment_subtype[iiss$equipment_name == "GUN/MOR"] <- "GUNS/MOR"

iiss$equipment_subtype[iiss$equipment_name == "GUNS"] <- "GUNS"
iiss$equipment_name[iiss$equipment_name == "GUNS"] <- NA

iiss$equipment_subtype[iiss$equipment_name %in% c("GUNS/HOW",
                                                  "guns and how")] <- "GUNS/HOW"
iiss$equipment_subtype[iiss$equipment_subtype == "guns and how"] <- "GUNS/HOW"
iiss$equipment_name[iiss$equipment_name %in% c("GUNS/HOW",
                                               "guns and how")] <- NA

iiss$equipment_subtype[iiss$equipment_name == "MOR"] <- "MOR"
iiss$equipment_name[iiss$equipment_name == "MOR"] <- NA

iiss$equipment_subtype[iiss$equipment_name == "MRL"] <- "MRL"
iiss$equipment_name[iiss$equipment_name == "MRL"] <- NA

iiss$equipment_subtype[iiss$equipment_name == "RCL"] <- "RCL"
iiss$equipment_name[iiss$equipment_name == "RCL"] <- NA

iiss$equipment_name[iiss$equipment_subtype == "TOWED"] <- "TOWED"
iiss$equipment_subtype[iiss$equipment_subtype == "TOWED"] <- NA

iiss$equipment_subtype[iiss$unit_name == "25-pdr" &
                         iiss$equipment_name == "LT TK"] <- "GUNS"
iiss$equipment_name[iiss$unit_name == "25-pdr" &
                         iiss$equipment_name == "LT TK"] <- NA

iiss$equipment_subtype[iiss$equipment_subname == "105mm" &
                         iiss$equipment_name == "LT TK"] <- "GUNS"
iiss$equipment_name[iiss$equipment_subtype == "GUNS" &
                         iiss$equipment_name == "LT TK"] <- NA

iiss$equipment_name[iiss$equipment_name == "CDO"] <- NA
iiss$equipment_subtype[iiss$equipment_subtype == "lt"] <- NA

# Equipment_type
iiss$equipment_type[iiss$unit_name == "Blowpipe"] <- "air defence"
```

  REPEAT FOR EACH EQUIPMENT_NAME AS NEEDED
  
#### Equipment_subtype
Fix incorrect columns that should have equipment_subtype = TBD
```{r}
# Unit_name

# Equipment_subname

# Equipment_name
iiss$equipment_name[iiss$equipment_subtype == "GUNS/MOR" &
                      iiss$equipment_name == "Combined GUN/MOR"] <- NA
iiss$equipment_name[iiss$equipment_subtype == "GUNS" &
                      iiss$equipment_name == "GUN"] <- NA
iiss$equipment_name[iiss$equipment_subtype == "GUNS/MOR" &
                      iiss$equipment_name == "GUN/MOR"] <- NA
iiss$equipment_name[iiss$equipment_type == "artillery" &
                      iiss$equipment_subtype == "GUNS" &
                         iiss$equipment_name == "guns"] <- NA

# Equipment_subtype
iiss$equipment_subtype[iiss$equipment_type == "artillery" &
                      iiss$equipment_name == "GUNS/TOWED"] <- "GUNS"
iiss$equipment_name[iiss$equipment_type == "artillery" &
                      iiss$equipment_subtype == "GUNS" &
                      iiss$equipment_name == "GUNS/TOWED"] <- "TOWED"

iiss$equipment_subtype[iiss$equipment_type == "artillery" &
                         iiss$equipment_subtype == "GUNS" &
                      iiss$equipment_name == "HOW"] <- "GUNS/HOW"
iiss$equipment_name[iiss$equipment_type == "artillery" &
                      iiss$equipment_subtype == "GUNS/HOW" &
                      iiss$equipment_name == "HOW"] <- NA

iiss$equipment_subtype[iiss$equipment_type == "artillery" &
                         iiss$equipment_subtype == "MOR" &
                      iiss$equipment_name == "HOW"] <- "MOR/HOW"
iiss$equipment_name[iiss$equipment_type == "artillery" &
                      iiss$equipment_subtype == "MOR/HOW" &
                      iiss$equipment_name == "HOW"] <- NA

iiss$equipment_subtype[iiss$equipment_type == "artillery" &
                         is.na(iiss$equipment_subtype) &
                      iiss$equipment_name == "HOW"] <- "HOW"
iiss$equipment_name[iiss$equipment_type == "artillery" &
                      iiss$equipment_subtype == "HOW" &
                      iiss$equipment_name == "HOW"] <- NA

iiss$equipment_subtype[iiss$equipment_type == "artillery" &
                         is.na(iiss$equipment_subtype) &
                      iiss$equipment_name == "SP/HOW"] <- "HOW"
iiss$equipment_name[iiss$equipment_type == "artillery" &
                      iiss$equipment_subtype == "HOW" &
                      iiss$equipment_name == "SP/HOW"] <- "SP"

iiss$equipment_name[iiss$equipment_type == "artillery" &
                      iiss$equipment_subtype %in% c("AA",
                                                    "AD",
                                                    "AD GUNS")] <- "AA"

iiss$equipment_subtype[iiss$equipment_type == "artillery" &
                      iiss$equipment_subtype %in% c("AA",
                                                    "AD",
                                                    "AD GUNS")] <- NA

iiss$equipment_name[iiss$equipment_type == "artillery" &
                      iiss$equipment_name %in% c("AA SP")] <- "SP"

# Equipment_type
iiss$equipment_type[iiss$equipment_type == "armoured fighting vehicles" &
                      iiss$equipment_subtype %in% c("MOR",
                                                    "RCL")] <- "artillery"

```

  REPEAT FOR EACH EQUIPMENT_SUBTYPE AS NEEDED

#### Equipment_type

Fix incorrect unit_name that should have equipment_type = equipment_type
```{r}
iiss$unit_name[iiss$equipment_type == "artillery" &
                 iiss$equipment_subname == "BM-21Grad"] <- "BM-21 Grad"
iiss$unit_name[iiss$equipment_type == "artillery" &
                 iiss$equipment_subname == "AT49K111"] <- "AT49K111 Spigot"
iiss$unit_name[iiss$equipment_type == "artillery" &
                 iiss$equipment_subname == "AT4"] <- "AT4 Spigot"
```

Fix incorrect equipment_subname that should have equipment_type = equipment_type
```{r}
# Convert to 120mm
iiss$equipment_subname[iiss$equipment_type == "artillery" &
                         iiss$equipment_subtype == "MOR" &
                         iiss$equipment_subname == "MOR120mm"] <- "120mm"

# Convert to NA
iiss$equipment_subname[iiss$equipment_type == "artillery" &
                 iiss$equipment_subname == "BM-21Grad" &
                   iiss$unit_name == "BM-21 Grad"] <- NA
iiss$equipment_subname[iiss$equipment_type == "artillery" &
                         iiss$equipment_subname == "AT49K111" &
                         iiss$unit_name == "AT49K111 Spigot"] <- NA
iiss$equipment_subname[iiss$equipment_type == "artillery" &
                         iiss$equipment_subname == "AT4" &
                         iiss$unit_name == "AT4 Spigot"] <- NA
iiss$equipment_subname[iiss$equipment_type == "artillery" &
                         iiss$equipment_subtype == "MOR" &
                         iiss$equipment_subname == "MOR"] <- NA
iiss$equipment_subname[iiss$equipment_type == "artillery" &
                         iiss$equipment_subname == "light"] <- NA
```

Fix incorrect equipment_name that should have equipment_type = equipment_type
```{r}
# Convert to SP
iiss$equipment_name[iiss$equipment_type == "artillery" &
                      iiss$equipment_subtype == "GUNS" &
                         iiss$equipment_name == "ATK"] <- "SP"
iiss$equipment_name[iiss$equipment_type == "artillery" &
                         iiss$equipment_subtype == "MOR" &
                         (iiss$equipment_name == "MOR-SP" |
                            iiss$equipment_name == "MOR * SP")] <- "SP"
iiss$equipment_name[iiss$equipment_type == "artillery" &
                      iiss$equipment_name == "KIFV SPAAG SP"] <- "SP"

# Convert to TOWED
iiss$equipment_name[iiss$equipment_type == "artillery" &
                      iiss$equipment_subtype == "MOR" &
                      iiss$equipment_name == "MOR-TOWED"] <- "TOWED"
iiss$equipment_name[iiss$equipment_type == "artillery" &
                      iiss$equipment_name == "MRL-TOWED"] <- "TOWED"

iiss$equipment_type[iiss$equipment_name == "TOWED ARTY"] <- "artillery"
iiss$equipment_name[iiss$equipment_name == "TOWED ARTY"] <- "TOWED"

iiss$equipment_name[iiss$equipment_type == "artillery" &
                      iiss$equipment_name == "TOW"] <- "TOWED"
iiss$equipment_name[iiss$equipment_type == "artillery" &
                      iiss$equipment_name == "KIFV SPAAG TOWED"] <- "TOWED"

# Convert to MRL
iiss$equipment_name[iiss$equipment_type == "artillery" &
                      iiss$equipment_name == "MLR"] <- "MRL"

iiss$equipment_type[iiss$equipment_type == "armoured fighting vehicles" &
                      iiss$equipment_subtype == "MRL"] <- "artillery"

# Convert to NA
iiss$equipment_name[iiss$equipment_type == "artillery" &
                      iiss$equipment_subtype == "RCL" &
                      iiss$equipment_name == "RCL"] <- NA
iiss$equipment_name[iiss$equipment_type == "artillery" &
                      iiss$equipment_subtype == "GUNS" &
                         iiss$equipment_name == "GUNS"] <- NA
iiss$equipment_name[iiss$equipment_type == "artillery" &
                         iiss$equipment_subtype == "MOR" &
                         iiss$equipment_name == "MOR"] <- NA
iiss$equipment_name[iiss$equipment_type == "artillery" &
                      iiss$equipment_subtype == "MOR" &
                      (iiss$equipment_name == "MORTAR" |
                         iiss$equipment_name == "MORTARS")] <- NA
iiss$equipment_name[iiss$equipment_type == "artillery" &
                         iiss$equipment_subtype == "RL" &
                         iiss$equipment_name == "RL"] <- NA
iiss$equipment_name[iiss$equipment_type == "artillery" &
                      iiss$equipment_name == "ARTY"] <- NA
iiss$equipment_name[iiss$equipment_type == "artillery" &
                         iiss$equipment_subtype == "GUNS" &
                         iiss$equipment_name == "ASLT GUNS"] <- NA
iiss$equipment_name[iiss$equipment_type == "artillery" &
                      iiss$equipment_name == "coastal"] <- NA
iiss$equipment_name[iiss$equipment_type == "artillery" &
                         iiss$equipment_name == "FORTRESS"] <- NA
iiss$equipment_name[iiss$equipment_type == "infantry convoy" & 
                      iiss$equipment_subtype == "RL" & 
                      iiss$equipment_name == "RL"] <- NA

```

Fix incorrect equipment_subtype that should have equipment_type = equipment_type
```{r}
# Convert to RL
iiss$equipment_subtype[iiss$equipment_type == "artillery" &
                         iiss$equipment_name == "RL"] <- "RL"
iiss$equipment_subtype[iiss$equipment_type == "infantry convoy"] <- "RL"

# Convert to RCL
iiss$equipment_subtype[iiss$equipment_type == "artillery" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "RCL"] <- "RCL"

# Convert to GUNS
iiss$equipment_subtype[iiss$equipment_type == "artillery" &
                         iiss$equipment_name == "ATK GUNS"] <- "GUNS"
iiss$equipment_subtype[iiss$equipment_type == "artillery" &
                         iiss$equipment_name == "GUNS"] <- "GUNS"
iiss$equipment_subtype[iiss$equipment_type == "artillery" &
                         iiss$equipment_name == "ASLT GUNS"] <- "GUNS"
iiss$equipment_subtype[iiss$equipment_type == "artillery" &
                         iiss$equipment_name == "FORTRESS"] <- "GUNS"
iiss$equipment_subtype[iiss$equipment_type == "guns" &
                         iiss$equipment_name == "AD GUNS"] <- "GUNS"
iiss$equipment_type[(iiss$equipment_type == "guns" |
                       iiss$equipment_type == "armoured fighting vehicles") &
                         iiss$equipment_name == "AD GUNS"] <- "artillery"

# Convert to MOR
iiss$equipment_subtype[iiss$equipment_type == "artillery" &
                         (iiss$equipment_name == "MORTAR" |
                            iiss$equipment_name == "MORTARS")] <- "MOR"
iiss$equipment_subtype[iiss$equipment_type == "artillery" &
                         iiss$equipment_name == "MOR"] <- "MOR"
iiss$equipment_subtype[iiss$equipment_type == "artillery" &
                         (iiss$equipment_name == "MOR-SP" |
                            iiss$equipment_name == "MOR * SP")] <- "MOR"
iiss$equipment_subtype[iiss$equipment_type == "artillery" &
                         iiss$equipment_name == "MOR-TOWED"] <- "MOR"
iiss$equipment_subtype[iiss$equipment_type == "artillery" &
                         iiss$equipment_name == "MOR-TOWED"] <- "MOR"
iiss$equipment_subtype[iiss$equipment_type == "artillery" &
                         (iiss$equipment_subname == "MOR" |
                            iiss$equipment_subname == "MOR120mm")] <- "MOR"

# Convert to GUNS/MOR
iiss$equipment_subtype[iiss$equipment_type == "artillery" &
                         iiss$equipment_name == "coastal"] <- "GUNS/MOR"

# Convert to NA
iiss$equipment_subtype[iiss$equipment_type == "artillery" &
                         iiss$equipment_subtype == "ARTY"] <- NA

iiss$equipment_subtype[iiss$equipment_type == "artillery" &
                         iiss$equipment_subtype == "GUNS" &
                         iiss$equipment_name == "SAM"] <- NA
```

Fix incorrect equipment_type that should have equipment_type = equipment_type
```{r}
# Armoured fighting vehicles
iiss$equipment_type[iiss$equipment_type == "armoured fighting vehicles" &
                      iiss$equipment_name == "SP" &
                      iiss$equipment_subname == "122mm"] <- "artillery"

iiss$equipment_type[iiss$equipment_type == "armoured fighting vehicles" &
                      (iiss$equipment_name == "MOR" |
                         iiss$equipment_name == "TOWED")] <- "artillery"

iiss$equipment_type[iiss$equipment_type == "armoured fighting vehicles" &
                         iiss$equipment_name == "ATK GUNS"] <- "artillery"

# Coastal and regional defence forces 
iiss$equipment_type[iiss$equipment_type == "Coastal regional defence forces" &
                      iiss$equipment_name == "GUNS"] <- "artillery"

# Artillery
iiss$equipment_type[is.na(iiss$equipment_type) &
                      (iiss$subservice == "coastal arty" &
                         iiss$equipment_name == "GUN" |
                         iiss$equipment_name == "GUNS" |
                         iiss$equipment_name == "guns" |
                         iiss$equipment_name == "MOR" |
                         iiss$equipment_name == "MRL" |
                         iiss$equipment_name == "TOWED") |
                      iiss$equipment_subtype == "ARTY MOR" |
                      iiss$equipment_name == "ARTY" |
                      iiss$equipment_name == "RCL" |
                      iiss$equipment_subtype == "GUNS" |
                      iiss$unit_name == "540 AT-4" |
                      (iiss$equipment_subname == "122mm"  |
                         iiss$equipment_subname == "130mm")] <- "artillery"
iiss$equipment_type[iiss$subservice == "costal defence" &
                      is.na(iiss$equipment_type) &
                      (iiss$equipment_subname == "120mm" |
                        iiss$equipment_subname == "127mm" |
                        iiss$equipment_subname == "150mm" |
                        iiss$equipment_subname == "75mm")] <- "artillery"
iiss$equipment_type[is.na(iiss$equipment_type) &
                      (iiss$unit_name == "guns" |
                         iiss$unit_name == "M-106" |
                         iiss$unit_name == "M-113" |
                         iiss$unit_name == "torpedo bty")] <- "artillery"
iiss$equipment_type[iiss$equipment_type == "guns"] <- "artillery"

# infantry convoy 
iiss$equipment_type[iiss$equipment_type == "infantry convoy"] <- "artillery"
```

## Ballistic missiles

### Typos

Here we fix typos, which include spelling errors, capitalization errors, and any other formatting errors that affect merging or equipment similarity

#### Unit_name typos
```{r}

```

#### Equipment_subname typos
```{r}
iiss$equipment_subname[iiss$equipment_subname == "Heavy"] <- "heavy"
iiss$equipment_subname[iiss$equipment_subname == "Light"] <- "light"
iiss$equipment_subname[iiss$equipment_subname == "long-range"] <- "long-range"
iiss$equipment_subname[iiss$equipment_subname == "Medium"] <- "medium"
iiss$equipment_subname[iiss$equipment_subname == "short-range"] <- "short-range"
iiss$equipment_subname[iiss$equipment_subname == "Strategic"] <- "strategic"
iiss$equipment_subname[iiss$equipment_subname == "Tactical"] <- "tactical"
iiss$equipment_subname[iiss$equipment_subname == "TACTICAL"] <- "tactical"
```

#### Equipment_name typos
```{r}
# Convert to MRBM
iiss$equipment_name[iiss$equipment_name == "MRMB"] <- "MRBM"
iiss$equipment_name[iiss$equipment_name == "MBBR"] <- "MRBM"
```

#### Equipment_subtype typos
```{r}
iiss$equipment_subtype[iiss$equipment_subtype == "mobile long-range"] <- "long-range"
iiss$equipment_subtype[iiss$equipment_subtype == "tactical mobile"] <- "tactical"
iiss$equipment_subtype[iiss$equipment_subtype == "TACTICAL"] <- "tactical"
```

#### Equipment_type typos
```{r}
iiss$equipment_type[iiss$equipment_type == "missile and strategic"] <- "ballistic missiles"
```

### Coding changes

#### Unit_name
Fix incorrect columns based on unit_name value
```{r}
# Unit_name

# Equipment_subname

# Equipment_name

# Equipment_subtype

# Equipment_type

```

#### Equipment_subname
```{r}

```

  REPEAT FOR EACH EQUIPMENT_SUBNAME AS NEEDED

#### Equipment_name
Fix incorrect columns that should have equipment_name = TBD
```{r}
# Unit_name
iiss$equipment_name[iiss$equipment_type == "surface-to-surface missile launchers" &
                      iiss$unit_name == "SLBM"] <- "SLBM"

iiss$equipment_type[iiss$equipment_type == "surface-to-surface missile launchers" &
                      iiss$unit_name == "SLBM"] <- "ballistic missiles"

iiss$equipment_type[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                      iiss$unit_name == "SLBM"] <- "ballistic missiles"
```

  REPEAT FOR EACH EQUIPMENT_NAME AS NEEDED
  
#### Equipment_subtype
Fix incorrect columns that should have equipment_subtype = TBD
```{r}
iiss$equipment_subtype[iiss$equipment_type == "ballistic missiles"] <- "missiles"

```

#### Equipment_type
Fix incorrect unit_name that should have equipment_type = ballistic missiles
```{r}
iiss$equipment_name[iiss$unit_name == "SLBM opcon strategic forces"] <- "SLBM"
iiss$equipment_type[iiss$unit_name == "SLBM opcon strategic forces"] <- "ballistic missiles"

# Convert to NA 
iiss$unit_name[iiss$equipment_type == "ballistic missiles" &
                 iiss$equipment_subtype == "missiles" &
                 iiss$equipment_name == "SLBM" &
                 iiss$equipment_subname == "strategic" &
                 iiss$unit_name == "SLBM"] <- NA
```

Fix incorrect equipment_subname that should have equipment_type = ballistic missiles
```{r}
# Convert to NA
iiss$equipment_subname[iiss$equipment_type == "missiles" &
                         (iiss$equipment_subname == "liquid-fueled" |
                            iiss$equipment_subname == "solid-fueled")] <- NA

# convert to tactical
iiss$equipment_subname[iiss$equipment_type == "surface-to-surface missile launchers" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SRBM" &
                         is.na(iiss$equipment_subname)] <- "tactical"
iiss$equipment_subname[iiss$equipment_type == "surface-to-surface missile launchers" &
                         iiss$equipment_subtype == "tactical" &
                         iiss$equipment_name == "AShM" &
                         is.na(iiss$equipment_subname)] <- "tactical"
iiss$equipment_subname[iiss$equipment_type == "surface-to-surface missile launchers" &
                         iiss$equipment_subtype == "tactical" &
                         iiss$equipment_name == "SRBM" &
                         is.na(iiss$equipment_subname)] <- "tactical"
iiss$equipment_subname[iiss$equipment_type == "surface-to-surface missile launchers" &
                         iiss$equipment_subtype == "tactical" &
                         iiss$equipment_name == "SSM" &
                         is.na(iiss$equipment_subname)] <- "tactical"
iiss$equipment_subname[iiss$equipment_type == "surface-to-surface missile launchers" &
                         iiss$equipment_subtype == "tactical" &
                         iiss$equipment_name == "MSL" &
                         iiss$equipment_subname == "ASM"] <- "tactical"
iiss$equipment_subname[iiss$equipment_type == "surface-to-surface missile launchers" &
                         iiss$equipment_subtype == "tactical" &
                         iiss$equipment_name == "MRMB" &
                         is.na(iiss$equipment_subname)] <- "tactical"

# convert to strategic
iiss$equipment_subname[iiss$equipment_type == "surface-to-surface missile launchers" &
                         iiss$equipment_subtype == "strategic" &
                         iiss$equipment_name == "ICBM" &
                         is.na(iiss$equipment_subname)] <- "strategic"
iiss$equipment_subname[iiss$equipment_type == "surface-to-surface missile launchers" &
                         iiss$equipment_subtype == "strategic" &
                         iiss$equipment_name == "IRBM" &
                         is.na(iiss$equipment_subname)] <- "strategic"
iiss$equipment_subname[iiss$equipment_type == "surface-to-surface missile launchers" &
                         iiss$equipment_subtype == "strategic" &
                         iiss$equipment_name == "MRBM" &
                         is.na(iiss$equipment_subname)] <- "strategic"
iiss$equipment_subname[iiss$equipment_type == "surface-to-surface missile launchers" &
                         iiss$equipment_subtype == "strategic" &
                         is.na(iiss$equipment_name) &
                         is.na(iiss$equipment_subname)] <- "strategic"
iiss$equipment_subname[iiss$equipment_type == "surface-to-surface missile launchers" &
                         iiss$equipment_subtype == "strategic" &
                         iiss$equipment_name == "SRBM" &
                         is.na(iiss$equipment_subname)] <- "strategic"
iiss$equipment_subname[iiss$equipment_name == "MRBM" |
                         iiss$equipment_name == "IRBM"] <- "strategic"
iiss$equipment_subname[iiss$equipment_type == "surface-to-surface missile launchers" &
                         iiss$equipment_subtype == "missiles" &
                         iiss$equipment_name == "SLBM" &
                         iiss$unit_name == "SLBM"] <- "strategic"
iiss$equipment_subname[iiss$equipment_type == "missiles" &
                         iiss$equipment_subtype == "strategic" &
                         iiss$equipment_name == "IRBM/MRBM"] <- "strategic"
iiss$equipment_subname[iiss$equipment_type == "missiles" &
                         iiss$equipment_subtype == "strategic" &
                         iiss$equipment_name == "ICBM" &
                         is.na(iiss$equipment_subname)] <- "strategic"
iiss$equipment_subname[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                         iiss$equipment_subtype == "missiles" &
                         iiss$equipment_name == "STRATEGIC" &
                         is.na(iiss$equipment_subname)] <- "strategic"
```

Fix incorrect equipment_name that should have equipment_type = ballistic missiles
```{r}
# Convert to SLBM
iiss$equipment_name[iiss$equipment_type == "surface-to-surface missile launchers" &
                      iiss$equipment_subtype == "strategic" &
                      is.na(iiss$equipment_name) &
                      iiss$equipment_subname == "strategic"] <- "SLBM"

# Convert to IRBM
iiss$equipment_name[iiss$equipment_type == "ballistic missiles" &
                      iiss$equipment_name == "MSL"] <- "IRBM"

# Convert to air defence
iiss$equipment_type[iiss$equipment_type == "ballistic missiles" &
                      iiss$equipment_name == "ABM"] <- "air defence"

# Convert to ICBM
iiss$equipment_name[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                      iiss$equipment_subtype == "missiles" &
                      iiss$equipment_name == "STRATEGIC" &
                      iiss$equipment_subname == "strategic"] <- "ICBM"
```

Fix incorrect equipment_subtype that should have equipment_type = ballistic missiles
```{r}
# convert to missiles
iiss$equipment_subtype[iiss$equipment_type == "surface-to-surface missile launchers" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SRBM" &
                         iiss$equipment_subname == "tactical"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "surface-to-surface missile launchers" &
                         iiss$equipment_subtype == "strategic" &
                         iiss$equipment_name == "ICBM" &
                         iiss$equipment_subname == "strategic"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "surface-to-surface missile launchers" &
                         iiss$equipment_subtype == "strategic" &
                         iiss$equipment_name == "IRBM" &
                         iiss$equipment_subname == "strategic"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "surface-to-surface missile launchers" &
                         iiss$equipment_subtype == "strategic" &
                         iiss$equipment_name == "MRBM" &
                         iiss$equipment_subname == "strategic"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "surface-to-surface missile launchers" &
                         iiss$equipment_subtype == "tactical" &
                         iiss$equipment_name == "SRBM" &
                         iiss$equipment_subname == "tactical"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "surface-to-surface missile launchers" &
                         iiss$equipment_subtype == "tactical" &
                         iiss$equipment_name == "AShM" &
                         iiss$equipment_subname == "tactical"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "surface-to-surface missile launchers" &
                         iiss$equipment_subtype == "strategic" &
                         iiss$equipment_name == "SLBM" &
                         iiss$equipment_subname == "strategic"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "surface-to-surface missile launchers" &
                         iiss$equipment_subtype == "strategic" &
                         iiss$equipment_name == "SRBM" &
                         iiss$equipment_subname == "strategic"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "surface-to-surface missile launchers" &
                         iiss$equipment_subtype == "tactical" &
                         iiss$equipment_name == "MRBM" &
                         iiss$equipment_subname == "tactical"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "surface-to-surface missile launchers" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "ICBM" &
                         (iiss$equipment_subname == "nuclear" |
                            is.na(iiss$equipment_subname))] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "surface-to-surface missile launchers" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "SRBM" &
                         iiss$equipment_subname == "conventional"] <- "missiles"
iiss$equipment_subtype[(iiss$equipment_name == "MRBM" |
                          iiss$equipment_name == "IRBM") &
                         iiss$equipment_subname == "strategic"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "surface-to-surface missile launchers" &
                         iiss$equipment_name == "SLBM" &
                         iiss$unit_name == "SLBM"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "missiles" &
                         iiss$equipment_subtype == "strategic" &
                         iiss$equipment_name == "IRBM/MRBM" &
                         iiss$equipment_subname == "strategic"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "missiles" &
                         iiss$equipment_subtype == "strategic" &
                         iiss$equipment_name == "ICBM" &
                         iiss$equipment_subname == "strategic"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "ballistic missiles" &
                         iiss$equipment_subtype == "AD"] <- "missiles"
```

Fix incorrect equipment_type that should have equipment_type = ballistic missiles
```{r}
# Warheads
iiss$equipment_type[iiss$equipment_type == "warheads"] <- "ballistic missiles"

# Air defence
iiss$equipment_type[iiss$equipment_type == "air defence" &
                      iiss$equipment_subtype == "strategic"] <- "ballistic missiles"

# surface-to-surface missile launchers
iiss$equipment_type[iiss$equipment_type == "surface-to-surface missile launchers" &
                      iiss$equipment_subtype == "missiles" &
                      iiss$equipment_name == "SRBM" &
                      iiss$equipment_subname == "tactical"] <- "ballistic missiles"
iiss$equipment_type[iiss$equipment_type == "surface-to-surface missile launchers" &
                      iiss$equipment_subtype == "missiles" &
                      iiss$equipment_name == "ICBM" &
                      iiss$equipment_subname == "strategic"] <- "ballistic missiles"
iiss$equipment_type[iiss$equipment_type == "surface-to-surface missile launchers" &
                      iiss$equipment_subtype == "missiles" &
                      iiss$equipment_name == "IRBM" &
                      iiss$equipment_subname == "strategic"] <- "ballistic missiles"
iiss$equipment_type[iiss$equipment_type == "surface-to-surface missile launchers" &
                      iiss$equipment_subtype == "missiles" &
                      iiss$equipment_name == "MRBM" &
                      iiss$equipment_subname == "strategic"] <- "ballistic missiles"
iiss$equipment_type[iiss$equipment_type == "surface-to-surface missile launchers" &
                      iiss$equipment_subtype == "missiles" &
                      iiss$equipment_name == "SRBM" &
                      iiss$equipment_subname == "tactical"] <- "ballistic missiles"
iiss$equipment_type[iiss$equipment_type == "surface-to-surface missile launchers" &
                      iiss$equipment_subtype == "missiles" &
                      iiss$equipment_name == "SLBM" &
                      iiss$equipment_subname == "strategic"] <- "ballistic missiles"
iiss$equipment_type[iiss$equipment_type == "surface-to-surface missile launchers" &
                      iiss$equipment_subtype == "missiles" &
                      iiss$equipment_name == "SRBM" &
                      iiss$equipment_subname == "strategic"] <- "ballistic missiles"
iiss$equipment_type[iiss$equipment_type == "surface-to-surface missile launchers" &
                      iiss$equipment_subtype == "missiles" &
                      iiss$equipment_name == "MRBM" &
                      iiss$equipment_subname == "tactical"] <- "ballistic missiles"
iiss$equipment_type[iiss$equipment_type == "surface-to-surface missile launchers" &
                      iiss$equipment_subtype == "missiles" &
                      iiss$equipment_name == "ICBM" &
                      iiss$equipment_subname == "nuclear"] <- "ballistic missiles"
iiss$equipment_type[iiss$equipment_type == "surface-to-surface missile launchers" &
                      iiss$equipment_subtype == "missiles" &
                      iiss$equipment_name == "SRBM" &
                      iiss$equipment_subname == "conventional"] <- "ballistic missiles"
iiss$equipment_type[iiss$equipment_subtype == "missiles" &
                      (iiss$equipment_name == "MRBM" |
                         iiss$equipment_name == "IRBM") &
                      iiss$equipment_subname == "strategic"] <- "ballistic missiles"
iiss$equipment_type[iiss$equipment_type == "surface-to-surface missile launchers" &
                      (iiss$equipment_name == "ICBM" |
                         iiss$equipment_name == "SLBM")] <- "ballistic missiles"
iiss$equipment_type[iiss$equipment_type == "surface-to-surface missile launchers" &
                      iiss$equipment_subtype == "missiles" &
                      iiss$equipment_name == "SLBM" &
                      iiss$equipment_subname == "strategic" &
                      iiss$unit_name == "SLBM"] <- "ballistic missiles"

# Missiles
iiss$equipment_type[iiss$equipment_type == "missiles" &
                         iiss$equipment_subtype == "missiles" &
                         iiss$equipment_name == "IRBM/MRBM" &
                         iiss$equipment_subname == "strategic"] <- "ballistic missiles"
iiss$equipment_type[iiss$equipment_type == "missiles" &
                      iiss$equipment_subtype == "missiles" &
                      iiss$equipment_name == "ICBM" &
                      iiss$equipment_subname == "strategic"] <- "ballistic missiles"

# Anti-tank/anti-infrastructure 
iiss$equipment_type[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                      iiss$equipment_subtype == "missiles" &
                      iiss$equipment_name == "ICBM" &
                      iiss$equipment_subname == "strategic"] <- "ballistic missiles"

# Offensive
iiss$equipment_type[iiss$equipment_type == "offensive" &
                      iiss$equipment_name == "ICBM"] <- "ballistic missiles"
iiss$equipment_type[iiss$equipment_type == "offensive" &
                      iiss$equipment_name == "MBBR"] <- "ballistic missiles"

# NA
iiss$equipment_type[is.na(iiss$equipment_type) &
                      (iiss$equipment_name == "ICBM" |
                      iiss$unit_name == "Jericho 1 SRBM/Jericho 2 IRBM")] <- "ballistic missiles"
```


## Bombs

### Typos
Here we fix typos, which include spelling errors, capitalization errors, and any other formatting errors that affect merging or equipment similarity

#### Unit_name typos
```{r}
iiss$equipment_type[iiss$equipment_name == "infrared/TV"] <- "bombs"
```

#### Equipment_subname typos
```{r}

```

#### Equipment_name typos
```{r}
iiss$equipment_name[iiss$equipment_name == "Conventional"] <- "conventional"
iiss$equipment_name[iiss$equipment_name == "Infra-red"] <- "infrared/TV"
iiss$equipment_name[iiss$equipment_name == "infrared"] <- "infrared/TV"
iiss$equipment_name[iiss$equipment_name == "INS/GPS-guided"] <- "INS/GPS guided"
iiss$equipment_name[iiss$equipment_name == "laser-guided"] <- "laser-guided/GPS"
iiss$equipment_name[iiss$equipment_name == "infrared"] <- "infrared/TV"
```

#### Equipment_subtype typos
```{r}
iiss$equipment_subtype[iiss$equipment_subtype == "TV-guided"] <- "INS/GPS-guided"
iiss$equipment_subtype[iiss$equipment_subtype == "XA Series"] <- NA
```

#### Equipment_type typos
```{r}

```

### Coding changes

#### Unit_name
Fix incorrect columns based on unit_name value
```{r}
# Unit_name

# Equipment_subname

# Equipment_name

# Equipment_subtype

# Equipment_type
```

#### Equipment_subname
Fix incorrect columns that should have equipment_subname = TBD
```{r}
# Unit_name

# Equipment_subname

# Equipment_name
iiss$equipment_subname[iiss$equipment_type == "bombs" &
                           iiss$equipment_name == "laser-guided" &
                           iiss$equipment_subname == "Laser-guided"] <- NA

# Equipment_subtype

# Equipment_type

```

  REPEAT FOR EACH EQUIPMENT_SUBNAME AS NEEDED

#### Equipment_name
Fix incorrect columns that should have equipment_name = TBD
```{r}
# Unit_name
iiss$equipment_name[iiss$equipment_type == "bombs" &
                        (iiss$equipment_name == "PAVEWAY II" |
                           iiss$equipment_name == "PAVEWAY III")] <- "laser-guided/GPS"

# Equipment_subname
iiss$equipment_name[iiss$equipment_type == "bombs" &
                        iiss$equipment_subname == "Laser-guided"] <- "laser-guided"

# Equipment_name
iiss$equipment_name[iiss$equipment_subname == "Infared/TV"] <- "Infrared/TV"
iiss$equipment_subname[iiss$equipment_subname == "Infared/TV"] <- NA

iiss$unit_name[iiss$equipment_name == "PAVEWAY IV"] <- "PAVEWAY IV"
iiss$equipment_name[iiss$equipment_name == "PAVEWAY IV"] <- "laser-guided/GPS"

# Equipment_subtype
iiss$equipment_name[iiss$equipment_type == "bombs" &
                        iiss$equipment_subtype == "INS/GPS/GLONASS guided"] <- "INS/GPS/GLONASS-guided"

 iiss$equipment_name[iiss$equipment_type == "bombs" &
                        iiss$equipment_subtype == "laser-guided"] <- "laser-guided"
# Equipment_type

```

  REPEAT FOR EACH EQUIPMENT_NAME AS NEEDED
  
#### Equipment_subtype
Fix incorrect columns that should have equipment_subtype = TBD
```{r}
# Unit_name

# Equipment_subname

# Equipment_name
iiss$equipment_name[iiss$equipment_type == "bombs" &
                        iiss$equipment_subtype == "conventional"] <- "conventional"

iiss$equipment_name[iiss$equipment_type == "bombs" &
                        iiss$equipment_subtype == "INS/GPS-guided"] <- "INS/GPS-guided"
# Equipment_subtype
iiss$equipment_subtype[iiss$equipment_type == "bombs" &
                           iiss$equipment_subtype == "conventional" &
                           iiss$equipment_name == "conventional"] <- NA

iiss$equipment_subtype[iiss$equipment_type == "bombs" &
                           iiss$equipment_subtype == "INS/GPS-guided" &
                           iiss$equipment_name == "INS/GPS-guided"] <- NA

iiss$equipment_subtype[iiss$equipment_type == "bombs" &
                         iiss$equipment_subtype == "INS/GPS/GLONASS guided" &
                         iiss$equipment_name == "INS/GPS/GLONASS-guided"] <- NA

iiss$equipment_subtype[iiss$equipment_type == "bombs" &
                           iiss$equipment_subtype == "laser-guided" &
                           iiss$equipment_name == "laser-guided"] <- NA
# Equipment_type

```

  REPEAT FOR EACH EQUIPMENT_SUBTYPE AS NEEDED

#### Equipment_type

Fix incorrect unit_name that should have equipment_type = equipment_type
```{r}
iiss$unit_name[iiss$equipment_type == "bombs" &
                      iiss$equipment_name == "JSOW" &
                 iiss$unit_name == "AGM-145"] <- "AGM-154 JSOW"
```

Fix incorrect equipment_subname that should have equipment_type = equipment_type
```{r}
# Convert to conventional
iiss$equipment_subname[iiss$equipment_type == "bombs" &
                    iiss$equipment_name == "JSOW" &
                    iiss$unit_name == "AGM-154 JSOW"] <- "conventional"

# Convert to NA 
iiss$equipment_subname[iiss$equipment_type == "bombs" & 
                         iiss$equipment_name == "laser-guided" & 
                         iiss$equipment_subname == "Laser-guided"] <- NA
```

Fix incorrect equipment_name that should have equipment_type = equipment_type
```{r}
# Convert to PGM
iiss$equipment_name[iiss$equipment_type == "bombs" &
                      iiss$equipment_subtype == "PGM"] <- "PGM"
```

Fix incorrect equipment_subtype that should have equipment_type = equipment_type
```{r}
# Convert to NA
iiss$equipment_subtype[iiss$equipment_type == "bombs" &
                      iiss$equipment_name == "PGM" &
                      iiss$equipment_subtype == "PGM"] <- NA

```

Fix incorrect equipment_type that should have equipment_type = equipment_type
```{r}
# Surface-to-surface missile launchers
iiss$equipment_type[iiss$equipment_type == "surface-to-surface missile launchers" &
                      (iiss$equipment_name == "BOMBS" |
                         iiss$equipment_name == "conventional")] <- "bombs"
```


## Engineering and maintenance

### Typos
Here we fix typos, which include spelling errors, capitalization errors, and any other formatting errors that affect merging or equipment similarity

#### Unit_name typos
```{r}

```

#### Equipment_subname typos
```{r}

```

#### Equipment_name typos
```{r}

```

#### Equipment_subtype typos
```{r}

```

#### Equipment_type typos
```{r}
iiss$equipment_type[iiss$equipment_type == "engineering & maintenance vehicles"] <- "engineering and maintenance vehicles"
iiss$equipment_type[iiss$equipment_type == "armoured recovery vehicle"] <- "engineering and maintenance vehicles"
```

### Coding changes

#### Unit_name
Fix incorrect columns based on unit_name value
```{r}
# Unit_name

# Equipment_subname

# Equipment_name

# Equipment_subtype

# Equipment_type

```

#### Equipment_subname
Fix incorrect columns that should have equipment_subname = TBD
```{r}
# Unit_name

# Equipment_subname

# Equipment_name

# Equipment_subtype

# Equipment_type

```

  REPEAT FOR EACH EQUIPMENT_SUBNAME AS NEEDED

#### Equipment_name
Fix incorrect columns that should have equipment_name = TBD
```{r}
# Unit_name

# Equipment_subname

# Equipment_name

# Equipment_subtype

# Equipment_type

```

  REPEAT FOR EACH EQUIPMENT_NAME AS NEEDED
  
#### Equipment_subtype
Fix incorrect columns that should have equipment_subtype = TBD
```{r}
# Unit_name

# Equipment_subname

# Equipment_name

# Equipment_subtype

# Equipment_type

```

  REPEAT FOR EACH EQUIPMENT_SUBTYPE AS NEEDED

#### Equipment_type

Fix incorrect unit_name that should have equipment_type = equipment_type
```{r}

```

Fix incorrect equipment_subname that should have equipment_type = equipment_type
```{r}

```

Fix incorrect equipment_name that should have equipment_type = equipment_type
```{r}
# Convert to AEV
iiss$equipment_name[iiss$equipment_type == "engineering and maintenance vehicles" &
                      iiss$equipment_subtype == "AEV"] <- "AEV"

# Convert to ARV
iiss$equipment_name[iiss$equipment_type == "engineering and maintenance vehicles" &
                      iiss$equipment_subtype == "ARV"] <- "ARV"

# Convert to VLB
iiss$equipment_name[iiss$equipment_type == "engineering and maintenance vehicles" &
                      iiss$equipment_subtype == "VLB"] <- "VLB"
```

Fix incorrect equipment_subtype that should have equipment_type = equipment_type
```{r}
# Convert to NA
iiss$equipment_subtype[iiss$equipment_type == "air defence" &
                         iiss$equipment_subtype == "GUNS" &
                         iiss$equipment_name == "ARV"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "engineering and maintenance vehicles" &
                         iiss$equipment_subtype == "AEV"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "engineering and maintenance vehicles" &
                         iiss$equipment_subtype == "ARV"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "engineering and maintenance vehicles" &
                         iiss$equipment_subtype == "VLB"] <- NA
```

Fix incorrect equipment_type that should have equipment_type = equipment_type
```{r}
# Air defence
iiss$equipment_type[iiss$equipment_type %in% c("air defence",
                                               "artillery") &
                      is.na(iiss$equipment_subtype) &
                      iiss$equipment_name == "ARV"] <- "engineering and maintenance vehicles"

# NA
iiss$equipment_type[is.na(iiss$equipment_type) &
                      iiss$equipment_name == "ACV"] <- "engineering and maintenance vehicles"
```

## Helicopters

### Typos

#### Unit_name typos
```{r}
iiss$unit_name[iiss$unit_name == "HELICOPTERS ATK 31: 6 MD-500MD Defender; 4 MD530MG Escorpion; 7 H369HM; 10 Sikorksy/Elbit AH-60L Arpia III; 4 S-70 A-41 Arapia II UTL 45: 8 Bell 212 Rapaz ; 19 UH-1H Iroquois; 8 H500C; 2 H500M; 2 UH- 60Q; 6 UH-1H TPT 23: 8 UH-1P Huey II; 5 Bell 212 Twin Huey; 2 Bell 412HP/SP; 8 UH-60A Blackhawk; ( 15 UH-60L ordered) TRG 45: 11 Bell 206B3; 2 H500C; 1 H500ME; 1 Bell 212"] <- "UH-60L Black Hawk"

iiss$unit_name[iiss$unit_name == "412.0"] <- "Bell 412"

iiss$unit_name[iiss$unit_name == "Allouette II"] <- "Alouette II"
iiss$unit_name[iiss$unit_name == "Allouette III"] <- "Alouette III"
iiss$unit_name[iiss$unit_name == "Mi-24"] <- "Mi-24 Hind"
iiss$unit_name[iiss$unit_name == "Mi-24R"] <- "Mi-24R Hind"
iiss$unit_name[iiss$unit_name == "Mi-2 hel"] <- "Mi-2"
iiss$unit_name[iiss$unit_name %in% c("PZL MI-2 Hoplite",
                                     "PZL MI-2")] <- "PZL Mi-2 Hoplite"

```

#### Equipment_subname typos
```{r}
iiss$equipment_subname[iiss$equipment_type == "helicopters" &
                         iiss$equipment_subname %in% c("20mm",
                                                       "ARMEDHEL",
                                                       "ATGW",
                                                       "Gazelle",
                                                       "HEL",
                                                       "HOT",
                                                       "Robinson",
                                                       "SeaLynx",
                                                       "Sikorsky/Elbit",
                                                       "SikorskyS-55",
                                                       "TAC",
                                                       "TOW")] <- NA

iiss$equipment_subname[iiss$equipment_subname == "Sikorksy/Elbit"] <- NA


iiss$equipment_subname[iiss$equipment_type == "helicopters" &
                         iiss$equipment_subname %in% c("Heavy",
                                                       "Hy",
                                                       "hy")] <- "heavy"

iiss$equipment_subname[iiss$equipment_type == "helicopters" &
                         iiss$equipment_subname %in% c("LIGHT",
                                                       "Light")] <- "light"

iiss$equipment_subname[iiss$equipment_type == "helicopters" &
                         iiss$equipment_subname %in% c("MEDIUM",
                                                       "Medium")] <- "medium"

```

#### Equipment_name typos
```{r}
iiss$equipment_type[iiss$equipment_name == "HELLICOPTERS"] <- "helicopters"

iiss$equipment_name[iiss$equipment_name == "COMM"] <- "COMMS"
iiss$equipment_name[iiss$equipment_name == "Comm/trg"] <- "COMMS/TRG"
iiss$equipment_name[iiss$equipment_name == "COMM/SAR/TRG"] <- "COMMS/SAR/TRG"
iiss$equipment_name[iiss$equipment_name == "Liason/COMM"] <- "COMMS/LIAISON"
iiss$equipment_name[iiss$equipment_name == "liaison"] <- "LIAISON"
iiss$equipment_name[iiss$equipment_name == "mr"] <- "MR"
iiss$equipment_name[iiss$equipment_name == "SAR/TRG/Liason"] <- "SAR/TRG/LIAISON"
iiss$equipment_name[iiss$equipment_name == "SPEC"] <- "SPEC OPS"
iiss$equipment_name[iiss$equipment_name == "SPEC OP"] <- "SPEC OPS"
iiss$equipment_name[iiss$equipment_name == "SPT/OBERVATION/LIAISON"] <- "SPT/OBS/LIAISON"
iiss$equipment_name[iiss$equipment_name == "support"] <- "SPT"
iiss$equipment_name[iiss$equipment_name == "TPT HEffL"] <- "TPT"
iiss$equipment_name[iiss$equipment_name == "Trials"] <- "trials"
iiss$equipment_name[iiss$equipment_name == "UAISON"] <- "LIAISON"
iiss$equipment_name[iiss$equipment_name == "UTILITY"] <- "UTL"
iiss$equipment_name[iiss$equipment_name == "UTILTY"] <- "UTL"

```

#### Equipment_subtype typos
```{r}

```

#### Equipment_type typos
```{r}
iiss$equipment_type[iiss$equipment_type == "air"] <- "helicopters"
iiss$equipment_type[iiss$equipment_type == "Attack Helicopters"] <- "helicopters"
iiss$equipment_type[iiss$equipment_type == "helicopter"] <- "helicopters"
iiss$equipment_type[iiss$equipment_type == "Helicopter"] <- "helicopters"
iiss$equipment_type[iiss$equipment_type == "Helicopters"] <- "helicopters"
iiss$equipment_type[iiss$equipment_type == "helipcopters"] <- "helicopters"
iiss$equipment_type[iiss$equipment_type == "hellicopter"] <- "helicopters"
iiss$equipment_type[iiss$equipment_type == "HELLICOPTERS"] <- "helicopters"
iiss$equipment_type[iiss$equipment_type == "hellicopters"] <- "helicopters"
```

### Coding changes

#### Branch
```{r}
iiss$equipment_name[iiss$equipment_type == "Air Training Command" &
                    iiss$equipment_name == "HEL"] <- "TPT"

iiss$equipment_type[iiss$equipment_type == "Air Training Command"] <- "helicopters"
```

#### Unit_name
```{r}
# Equipment subname
iiss$equipment_subname[iiss$unit_name == "Hughes 300"] <- NA

# Equipment_name
iiss$equipment_name[iiss$unit_name == "Ka-25 Hormone"] <- "ASW"
iiss$equipment_name[iiss$unit_name == "KV-107"] <- "SAR"

iiss$equipment_name[iiss$unit_name == "SE-3160"] <- "UTL"

iiss$equipment_name[iiss$unit_name == "Shabaviz 2061 and 2-75" |
                      iiss$unit_name == "V-107"] <- "TPT"

iiss$equipment_name[iiss$unit_name %in% c("Mi-24", "Mi-24 Hind") &
                      iiss$equipment_type == "helicopters"] <- "ATK"

iiss$equipment_name[iiss$unit_name == "Wessex HU-5" &
                      iiss$equipment_name == "FLT"] <- "ASLT"

iiss$equipment_name[iiss$unit_name == "Mi-26"] <- "TPT"

iiss$equipment_name[iiss$unit_name == "Mi-8 Hip"] <- "TPT"

iiss$equipment_name[iiss$unit_name == "hel"] <- "UTL"
iiss$unit_name[iiss$unit_name == "hel"] <- NA

# Equipment_subtype
iiss$equipment_subtype[iiss$unit_name == "Ka-25 Hormone"] <- NA

# Equipment_type
iiss$equipment_type[iiss$unit_name == "Ka-25 Hormone"] <- "helicopters"
iiss$equipment_type[iiss$unit_name == "MD-500D"] <- "helicopters"
iiss$equipment_type[iiss$unit_name == "MD-500ME"] <- "helicopters"
iiss$equipment_type[iiss$unit_name == "MD-530F"] <- "helicopters"
iiss$equipment_type[iiss$unit_name == "MD-530F Lifter"] <- "helicopters"
iiss$equipment_type[iiss$unit_name == "Mi-2" |
                      iiss$unit_name == "Mi-2 hel"] <- "helicopters"
iiss$equipment_type[iiss$unit_name == "Hughes 300"] <- "helicopters"

iiss$equipment_name[iiss$equipment_type == "armoured fighting vehicles" &
                      iiss$equipment_subtype == "AIRCRAFT" &
                      (iiss$unit_name == "CH- 47C" |
                         iiss$unit_name == "CH- 47C Chinook" |
                         iiss$unit_name == "Jet Ranger" |
                         iiss$unit_name == "UH-1H" |
                         iiss$unit_name == "Bell UH-7H")] <- "TPT"

iiss$equipment_name[iiss$equipment_type == "armoured fighting vehicles" &
                      iiss$equipment_subtype == "AIRCRAFT" &
                      iiss$unit_name == "FH-1100"] <- "UTL"

iiss$equipment_type[iiss$equipment_type == "armoured fighting vehicles" &
                      iiss$equipment_subtype == "AIRCRAFT" &
                      (iiss$unit_name == "CH- 47C" |
                         iiss$unit_name == "CH- 47C Chinook" |
                         iiss$unit_name == "Jet Ranger" |
                         iiss$unit_name == "UH-1H" |
                         iiss$unit_name == "Bell UH-7H" |
                         iiss$unit_name == "FH-1100")] <- "helicopters"
```

#### Equipment_subname
```{r}
iiss$equipment_subname[iiss$equipment_subname == "Mi-8MTHipH"] <- NA

iiss$equipment_subname[iiss$equipment_subname == "Hiller"] <- NA

iiss$equipment_subname[iiss$equipment_name == "helicopters" &
                         iiss$equipment_subname %in% c("ATGW",
                                                       "HOT")] <- NA


```

#### Equipment_name
```{r}
# Unit name
iiss$equipment_name[iiss$unit_name == "UH-60"] <- "UTL"
iiss$equipment_type[iiss$unit_name == "UH-60"] <- "helicopters"

iiss$equipment_name[iiss$unit_name == "206B"] <- "UTL"
iiss$equipment_name[iiss$unit_name == "206L-1"] <- "UTL"
iiss$equipment_name[iiss$unit_name == "Alouette II"] <- "UTL"
iiss$equipment_name[iiss$unit_name == "Alouette III"] <- "UTL"
iiss$equipment_name[iiss$unit_name == "Bell 412"] <- "UTL"
iiss$equipment_name[iiss$unit_name == "Bell 212"] <- "UTL"
iiss$equipment_name[iiss$unit_name == "Lama"] <- "UTL"
iiss$equipment_type[iiss$unit_name == "Lama"] <- "helicopters"
iiss$equipment_name[iiss$unit_name == "UH-1H (armed)"] <- "UTL"

iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "HELLICOPTERS" &
                      iiss$unit_name %in% c("SA-318C")] <- "MRH"

iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "HELLICOPTERS" &
                      iiss$unit_name %in% c("Alouette II/III",
                                            "Bell 206",
                                            "SA-318/319B Alouette II/III",
                                            "SA-360 (VIP)",
                                            "SA-360 Dauphin")] <- "SAR/TPT"

iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "HELLICOPTERS" &
                      iiss$unit_name %in% c("Hughes 500D",
                                            "SA-365 (VIP")] <- "TPT"

iiss$equipment_name[iiss$unit_name == "SA-365 (VIP)"] <- "TPT"

iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "MCR"] <- "TPT"

iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "HELLICOPTERS" &
                      iiss$unit_name %in% c("OH-6A")] <- "TRG"

iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "HELLICOPTERS" &
                      iiss$unit_name %in% c("SE 3130 Alouette II")] <- "UTL"

iiss$equipment_name[iiss$unit_name %in% c("AS550 Fennec",
                                          "AS550 Fennec (ISR)")] <- "MRH"
iiss$equipment_type[iiss$unit_name %in% c("AS550 Fennec",
                                          "AS550 Fennec (ISR)")] <- "helicopters"

iiss$equipment_name[iiss$unit_name == c("Super Lynx Mk90B")] <- "UTL"
iiss$equipment_type[iiss$unit_name == c("Super Lynx Mk90B")] <- "helicopters"

# Equipment_name
iiss$equipment_name[iiss$equipment_name == "MRH/Tpt"] <- "MRH/TPT"
iiss$equipment_name[iiss$equipment_name == "ASuW"] <- "ASUW"
iiss$equipment_name[iiss$equipment_name == "MAR SPT"] <- "MAR/SPT"

iiss$equipment_type[iiss$equipment_name == "LIASION HEL"] <- "helicopters"
iiss$equipment_name[iiss$equipment_name == "LIASION HEL"] <- "UTL"

iiss$equipment_name[iiss$equipment_name == "ARMED"] <- "UTL"

iiss$equipment_name[iiss$equipment_name == "COMMS/ASR"] <- "COMMS/ASW"

iiss$equipment_name[iiss$equipment_name == "EQPT"] <- "MRH"
iiss$equipment_name[iiss$equipment_name == "liaison"] <- "MRH"

iiss$equipment_type[iiss$equipment_name == "UH-60"] <- "helicopters"
iiss$equipment_name[iiss$equipment_name == "UH-60"] <- "UTL"

iiss$equipment_name[iiss$equipment_name == "UTL -UH-1"] <- "UTL"
iiss$equipment_name[iiss$equipment_name == "UTL- UH-1"] <- "UTL"

iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "SP"] <- "SPT"
iiss$equipment_subname[iiss$equipment_type == "helicopters" &
                         iiss$equipment_name == "T"] <- NA

iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "AVN" &
                      (iiss$unit_name == "A-109" |
                         iiss$unit_name == "Alouette IIC" |
                         iiss$unit_name == "Gazelle AH-1" |
                         iiss$unit_name == "Lynx AH-1" |
                         iiss$unit_name == "SA-341" |
                         iiss$unit_name == "Scout")] <- "ATK"

iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "GUNS"] <- "ATK"

iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "HOT"] <- "ATK"

iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "HOT/ATGW"] <- "ATK"

iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "Maintenance" &
                      iiss$unit_name == "UH-1H (armed)"] <- "ATK"

iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "AVN" &
                      (iiss$unit_name == "A-109" |
                         iiss$unit_name == "Alouette IIC" |
                         iiss$unit_name == "Gazelle AH-1" |
                         iiss$unit_name == "Lynx AH-1" |
                         iiss$unit_name == "SA-341" |
                         iiss$unit_name == "Scout")] <- "ATK"

iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "TOW" &
                      iiss$unit_name == "Lynx AG-1/-7/-9"] <- "ATK"

iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "HELLICOPTERS" &
                      iiss$unit_name == "Bell 205"] <- "ATK"

iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "CDO" &
                      (iiss$unit_name == "Wessex" |
                         iiss$unit_name == "Wessex HU-5")] <- "OCU"

iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "FLT" &
                      iiss$unit_name == "Wessex"] <- "ATK"

iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "Maintenance" &
                      (iiss$unit_name == "206B" |
                         iiss$unit_name == "206L-1" |
                         iiss$unit_name == "Allouette III" |
                         iiss$unit_name == "Bell 212" |
                         iiss$unit_name == "Lama")] <- "SPT"

iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "AVN" &
                      iiss$unit_name == "Sioux"] <- "TPT"

iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "FLT" &
                      (iiss$unit_name == "Bell 212" |
                         iiss$unit_name == "Bo-105" |
                         iiss$unit_name == "S-70" |
                         iiss$unit_name == "S-70A" |
                         iiss$unit_name == "S-76")] <- "TPT"

iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "CCT" &
                      iiss$unit_name == "SF-260"] <- "TRG"

iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "FLT" &
                      iiss$unit_name == "Wasp"] <- "TRG"

iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "LT AC"] <- "TRG"

iiss$equipment_name[iiss$equipment_name == "liaison"] <- "LIAISON"

iiss$equipment_name[iiss$equipment_name == "OBSRV"] <- "OBS"

iiss$equipment_name[iiss$equipment_name == "TPT HEL"] <- "TPT"

iiss$equipment_name[iiss$equipment_name == "trials"] <- "TRIALS"

iiss$equipment_name[iiss$equipment_name == "UTILITY/LIAISON"] <- "UTL/LIAISON"

iiss$equipment_name[iiss$equipment_name == "UTILITY"] <- "UTL"

iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "AVN" &
                      iiss$unit_name == "Alouette II"] <- "UTL"

iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$unit_name == "Lynx AH-1/-7/-9"] <- "UTL"

iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "hel" &
                      iiss$unit_name == "Mi-4"] <- "UTL"

iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "SPT" &
                      iiss$equipment_subname == "SAR"] <- "SPT/SAR"
iiss$equipment_subname[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "SPT/SAR" &
                      iiss$equipment_subname == "SAR"] <- NA

iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "TPT" &
                      iiss$equipment_subname == "SAR"] <- "TPT/SAR"
iiss$equipment_subname[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "TPT/SAR" &
                      iiss$equipment_subname == "SAR"] <- NA

iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "SPT" &
                      iiss$equipment_subname == "SAR"] <- "SPT/SAR"
iiss$equipment_subname[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "SPT/SAR" &
                      iiss$equipment_subname == "SAR"] <- NA

iiss$equipment_subname[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "SPT" &
                      iiss$equipment_subname == "T"] <- NA

iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "ATK" &
                      iiss$equipment_subname == "TOW"] <- NA

iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "ATK" &
                      iiss$equipment_subname == "TPT"] <- "ATK/TPT"
iiss$equipment_subname[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "ATK/TPT" &
                      iiss$equipment_subname == "TPT"] <- NA

iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "SPT" &
                      iiss$equipment_subname == "TRG"] <- "SPT/TRG"
iiss$equipment_subname[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "SPT/TRG" &
                      iiss$equipment_subname == "TRG"] <- NA

```

#### Equipment_subtype
Omit all subtypes for helicopters
```{r}
iiss$equipment_subtype[iiss$equipment_type == "helicopters"] <- NA
```

#### Equipment_type

Fix incorrect unit_name that should have equipment_type = helicopters
```{r}
iiss$equipment_type[iiss$unit_name == "AB-212" |
                      iiss$unit_name == "AB-47J" |
                      iiss$unit_name == "Alouette III" |
                      iiss$unit_name == "Alouette III (SA-319)" |
                      iiss$unit_name == "Bell 205" |
                      iiss$unit_name == "Bell 212" |
                      iiss$unit_name == "Bell 412" |
                      iiss$unit_name == "Bell 412 Twin Huey" |
                      iiss$unit_name == "MD-500D" |
                      iiss$unit_name == "MD-500E" |
                      iiss$unit_name == "MD-500ME" |
                      iiss$unit_name == "MD-500/530" |
                      iiss$unit_name == "MD-500MD Defender" |
                      iiss$unit_name == "SA-319" |
                      iiss$unit_name == "SA-319 Alouette III"] <- "helicopters"

iiss$equipment_type[iiss$equipment_type == "gendarmerie royale" &
                      iiss$equipment_name == "MRH" &
                      iiss$unit_name == "SA-315/-316 Alouette II/IIII"] <- "helicopters"

iiss$equipment_type[iiss$equipment_type == "gendarmerie royale" &
                      iiss$equipment_name == "MRH" &
                      iiss$unit_name == "Puma hel"] <- "helicopters"

iiss$equipment_name[iiss$equipment_type == "gendarmerie royale" &
                      iiss$unit_name == "A-109"] <- "ATK"
iiss$equipment_type[iiss$equipment_type == "gendarmerie royale" &
                      iiss$unit_name == "A-109"] <- "helicopters"

iiss$equipment_name[iiss$equipment_type == "gendarmerie royale" &
                      iiss$unit_name == "Gazelle"] <- "MRH"
iiss$equipment_type[iiss$equipment_type == "gendarmerie royale" &
                      iiss$unit_name == "Gazelle"] <- "helicopters"

iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$unit_name == "Lynx"] <- "SAR"
iiss$equipment_type[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$unit_name == "Lynx"] <- "helicopters"
```

Fix incorrect equipment_subname that should have equipment_type = helicopters
```{r}
# Convert to NA
iiss$equipment_subname[iiss$equipment_type == "helicopters" &
                         (iiss$equipment_subname == "(armed)" |
                            iiss$equipment_subname == "(HB-315BGaviao)" |
                            iiss$equipment_subname == "AlouetteIII\n/SA-319\nAlouetteIII" |
                            iiss$equipment_subname == "Bell205" |
                            iiss$equipment_subname == "EMB-111(P-54/P-95B)" |
                            iiss$equipment_subname == "S-76" |
                            iiss$equipment_subname == "TAC" |
                            iiss$equipment_subname == "PAX")] <- NA
iiss$equipment_subname[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "SAR" &
                      iiss$equipment_subname == "SAR"] <- NA
iiss$equipment_subname[iiss$equipment_type == "helicopters" &
                         (iiss$equipment_subname == "hel" |
                            iiss$equipment_subname == "SA-319" |
                            iiss$equipment_subname == "SA-330" |
                            iiss$equipment_subname == "PZL")] <- NA
iiss$equipment_subname[iiss$equipment_type == "helicopters" &
                      (iiss$equipment_subname == "BELL212" |
                         iiss$equipment_subname == "BELL206" |
                         iiss$equipment_subname == "OH-58" |
                         iiss$equipment_subname == "S-70" |
                         iiss$equipment_subname == "SA-319AlouetteIII")] <- NA
iiss$equipment_subname[iiss$equipment_type == "helicopters" & 
                         iiss$equipment_subname == "AlouetteII"] <- NA
iiss$equipment_subname[iiss$equipment_type == "helicopters" & 
                         iiss$equipment_subname == "Dauphin2(VIP)"] <- NA
```

Fix incorrect equipment_name that should have equipment_type = helicopters
```{r}
# convert to AEW
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      is.na(iiss$equipment_name) &
                      iiss$unit_name == "AEW-2"] <- "AEW"

# convert to ASLT
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      (iiss$equipment_name == "AMPH ASLT" |
                         iiss$equipment_name == "ALST TPT" |
                         iiss$equipment_name == "ASLT TPT")] <- "ASLT"

# convert to ASW
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      is.na(iiss$equipment_name) &
                      iiss$unit_name == "EH-101 Merlin Mk1"] <- "ASW"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      is.na(iiss$equipment_name) &
                      iiss$unit_name == "H-34"] <- "ASW"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      is.na(iiss$equipment_name) &
                      grepl("Lynx", iiss$unit_name)] <- "ASW"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      is.na(iiss$equipment_name) &
                      grepl("Sea King", iiss$unit_name)] <- "ASW"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "PCI"] <- "ASW"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$unit_name == "SH-60J"] <- "ASW"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$unit_name == "UP-2J"] <- "ASW"

# Convert to ASW/ASUW
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      (iiss$equipment_name == "ASW/ASuW" |
                         iiss$equipment_name == "ASW/ASUV")] <- "ASW/ASUW"

# convert to ATK
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      is.na(iiss$equipment_name) &
                      grepl("AH-", iiss$unit_name)] <- "ATK"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      is.na(iiss$equipment_name) &
                      iiss$unit_name == "HC-4"] <- "ATK"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      is.na(iiss$equipment_name) &
                      grepl("Ka-", iiss$unit_name)] <- "ATK"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$equipment_subtype == "ATK"] <- "ATK"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      (iiss$equipment_name == "ATTACK HEL" |
                         iiss$equipment_name == "ATTACK HELICPTERS" |
                         iiss$equipment_name == "ATTACK" |
                         iiss$equipment_name == "ATTACK HEL" |
                         iiss$equipment_name == "ARMED HEL" |
                         iiss$equipment_name == "TAK HEL" |
                         iiss$equipment_name == "attack")] <- "ATK"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "ATTACK HELICOPTERS"] <- "ATK"

# convert to CBT/SPT
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      (iiss$equipment_name == "CBT-SPT" |
                         iiss$equipment_name == "CBT SPT")] <- "CBT/SPT"

# Convert to COMMS/SAR
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "COMMS(SAR)"] <- "COMMS/SAR"

# convert to MRH
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      is.na(iiss$equipment_name) &
                      grepl("Bell", iiss$unit_name)] <- "MRH"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      is.na(iiss$equipment_name) &
                      grepl("Hughes", iiss$unit_name)] <- "MRH"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      is.na(iiss$equipment_name) &
                      grepl("MD", iiss$unit_name)] <- "MRH"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      is.na(iiss$equipment_name) &
                      grepl("PZL-", iiss$unit_name)] <- "MRH"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      is.na(iiss$equipment_name) &
                      grepl("SA-3", iiss$unit_name)] <- "MRH"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      is.na(iiss$equipment_name) &
                      grepl("Z-", iiss$unit_name)] <- "MRH"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "MRh"] <- "MRH"

# convert to OCU
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      is.na(iiss$equipment_name) &
                      iiss$unit_name == "SE-3130"] <- "OCU"

# convert to SAR
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      is.na(iiss$equipment_name) &
                      iiss$unit_name == "HH-3F"] <- "SAR"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      is.na(iiss$equipment_name) &
                      grepl("SAR", iiss$unit_name)] <- "SAR"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "UTL" &
                      iiss$equipment_subname == "SAR"] <- "SAR"

# convert to SPT
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      is.na(iiss$equipment_name) &
                      grepl("IAR-", iiss$unit_name)] <- "SPT"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      is.na(iiss$equipment_name) &
                      grepl("Puma", iiss$unit_name)] <- "SPT"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "SPT HEL"] <- "SPT"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "APT"] <- "SPT"


# convert to TRG
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      is.na(iiss$equipment_name) &
                      grepl("AB-47", iiss$unit_name)] <- "TRG"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      is.na(iiss$equipment_name) &
                      grepl("NH-", iiss$unit_name)] <- "TRG"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      is.na(iiss$equipment_name) &
                      iiss$unit_name == "OH-13HS"] <- "TRG"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$unit_name == "HSS-2B"] <- "TRG"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$unit_name == "N-SH-60B Seahawk"] <- "TRG"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$equipment_subtype == "TRG"] <- "TRG"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "Training"] <- "TRG"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      (iiss$equipment_name == "Traning" |
                         iiss$equipment_name == "TRAINING")] <- "TRG"

# convert to TPT
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      is.na(iiss$equipment_name) &
                      grepl("AB-206", iiss$unit_name)] <- "TPT"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      is.na(iiss$equipment_name) &
                      grepl("CH-", iiss$unit_name)] <- "TPT"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      is.na(iiss$equipment_name) &
                      grepl("Ecureuil", iiss$unit_name)] <- "TPT"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      is.na(iiss$equipment_name) &
                      grepl("S-70", iiss$unit_name)] <- "TPT"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      is.na(iiss$equipment_name) &
                      (iiss$unit_name == "SH-3D" |
                         iiss$unit_name == "Shabaviz" |
                         iiss$unit_name == "W-3" |
                         iiss$unit_name == "W-3 Sokol")] <- "TPT"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      is.na(iiss$equipment_name) &
                      grepl("UH-", iiss$unit_name)] <- "TPT"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$equipment_subtype == "TPT"] <- "TPT"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      (iiss$equipment_name == "tpt" &
                         iiss$equipment_name == "TPt" &
                         iiss$equipment_name == "Transport")] <- "TPT"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      (iiss$equipment_name == "Transport" |
                         iiss$equipment_name == "tpt" |
                         iiss$equipment_name == "TPt")] <- "TPT"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      (iiss$equipment_name == "LIAISON" |
                         iiss$equipment_name == "LIAISON/RECCE" |
                         iiss$equipment_name == "VIP" |
                         iiss$equipment_name == "VIP TPT")] <- "TPT"

# convert to UTL
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      is.na(iiss$equipment_name) &
                      grepl("A-1", iiss$unit_name)] <- "UTL"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      is.na(iiss$equipment_name) &
                      grepl("AB-205", iiss$unit_name)] <- "UTL"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      is.na(iiss$equipment_name) &
                      grepl("AB-212", iiss$unit_name)] <- "UTL"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      is.na(iiss$equipment_name) &
                      grepl("AB-412", iiss$unit_name)] <- "UTL"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      is.na(iiss$equipment_name) &
                      grepl("AS-", iiss$unit_name)] <- "UTL"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      is.na(iiss$equipment_name) &
                      grepl("Bo-", iiss$unit_name)] <- "UTL"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      is.na(iiss$equipment_name) &
                      grepl("BO-", iiss$unit_name)] <- "UTL"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      is.na(iiss$equipment_name) &
                      grepl("Dauphin", iiss$unit_name)] <- "UTL"
iiss$equipment_name[iiss$unit_name == "MD-500D"] <- "UTL"
iiss$equipment_name[iiss$unit_name == "MD-500ME"] <- "UTL"
iiss$equipment_name[iiss$unit_name == "MD-530F"] <- "UTL"
iiss$equipment_name[iiss$unit_name == "MD-530F Lifter"] <- "UTL"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      is.na(iiss$equipment_name) &
                      grepl("Mi-", iiss$unit_name)] <- "UTL"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      is.na(iiss$equipment_name) &
                      grepl("Mi-", iiss$unit_name)] <- "UTL"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      is.na(iiss$equipment_name) &
                      iiss$unit_name == "Mo-24"] <- "UTL"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      is.na(iiss$equipment_name) &
                      grepl("NH-", iiss$unit_name)] <- "UTL"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      is.na(iiss$equipment_name) &
                      grepl("ouette", iiss$unit_name)] <- "UTL"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      is.na(iiss$equipment_name) &
                      grepl("S-5", iiss$unit_name)] <- "UTL"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      is.na(iiss$equipment_name) &
                      (iiss$unit_name == "SE3160" |
                         iiss$unit_name == "Wessex")] <- "UTL"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$unit_name == "U-36A"] <- "UTL"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$equipment_subtype == "UTL"] <- "UTL"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "ULT"] <- "UTL"
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "utility"] <- "UTL"

# convert to NA
iiss$equipment_name[iiss$equipment_type == "helicopters" &
                      (iiss$equipment_name == "HEL" |
                         iiss$equipment_name == "HELICOPTERS")] <- NA
```

Fix incorrect equipment_subtype that should have equipment_type = helicopters
```{r}
# Convert to NA 
iiss$equipment_subtype[iiss$equipment_type == "helicopters" &
                         iiss$equipment_subtype == "missiles"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "helicopters" &
                         iiss$equipment_subtype == "armd"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "helicopters" &
                         iiss$equipment_subtype == "helicopters"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "helicopters" &
                      iiss$equipment_subtype == "ATK" &
                      iiss$equipment_name == "ATK"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "helicopters" &
                         iiss$equipment_subtype == "TPT" &
                         iiss$equipment_name == "TPT"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "helicopters" &
                         iiss$equipment_subtype == "TRG" &
                         iiss$equipment_name == "TRG"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "helicopters" &
                         iiss$equipment_subtype == "UTL" &
                         iiss$equipment_name == "UTL"] <- NA
```

Fix incorrect equipment_type that should have equipment_type = helicopters
```{r}
# Unmanned aerial vehicles
iiss$equipment_type[iiss$equipment_type == "unmanned aerial vehicles" &
                      iiss$equipment_name == "TPT" &
                      iiss$unit_name == "Bo-105"] <- "helicopters"

# NA
iiss$equipment_type[is.na(iiss$equipment_type) &
                      (iiss$equipment_name == "ARMED HEL" |
                         iiss$equipment_name == "HEL" |
                         iiss$equipment_name == "TAK HEL") |
                      (is.na(iiss$equipment_subtype) &
                               iiss$equipment_name == "ASW" |
                         iiss$equipment_name == "ASW/ASUV") |
                      iiss$unit_name == "AS332B Super Puma"] <- "helicopters"
iiss$equipment_type[is.na(iiss$equipment_type) &
                      (iiss$unit_name == "AB-212" |
                         iiss$unit_name == "Allouette II" |
                         iiss$unit_name == "Mi-17" |
                         iiss$unit_name == "Mi-24" |
                         iiss$unit_name == "Mi-24 Hind" |
                         iiss$unit_name == "Mi-35" |
                         iiss$unit_name == "SA-315" |
                         iiss$unit_name == "SA-319")] <- "helicopters"

# Surface-to-surface missile launcher
iiss$equipment_type[iiss$equipment_type == "surface-to-surface missile launchers" &
                      iiss$equipment_name == "HEL"] <- "helicopters"

# Aircraft
iiss$equipment_type[iiss$equipment_type == "aircraft" &
                      (iiss$equipment_name == "ATTACK HEL" |
                         iiss$equipment_name == "ATTACK HELICOPTERS" |
                         iiss$equipment_name == "ARMED HEL")] <- "helicopters"
iiss$equipment_type[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "HELICOPTERS"] <- "helicopters"
iiss$equipment_type[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "HEL"] <- "helicopters"
iiss$equipment_type[iiss$equipment_type == "aircraft" &
                      (iiss$equipment_name == "MRH" |
                         iiss$equipment_name == "hel")] <- "helicopters"
iiss$equipment_type[iiss$equipment_type == "aircraft" &
                      is.na(iiss$equipment_name) &
                      iiss$unit_name %in% c("Bell UH-1H/M", "Bo-105m", "IAR-316", 
                                            "IAR-330", "IAR-93", "Ka-25", "Mi-24", "Mi-24 Hind", 
                                            "Mi-8", "Mi-8 Hip")] <- "helicopters"
iiss$equipment_type[iiss$equipment_type == "aircraft" & 
                      iiss$equipment_subname == "AlouetteII"] <- "helicopters"
iiss$equipment_type[iiss$equipment_type == "aircraft" & 
                      iiss$equipment_subname == "Dauphin2(VIP)"] <- "helicopters"

# Air defence
iiss$equipment_type[iiss$equipment_type == "air defence" &
                      (iiss$equipment_name == "HEL" |
                         iiss$equipment_name == "SPT")] <- "helicopters"

# Logistics and support
iiss$equipment_type[iiss$equipment_type == "logistics and support" &
                      iiss$equipment_subtype == "helicopters"] <- "helicopters"

# misc
iiss$equipment_name[iiss$equipment_type == "miscellaneous" &
                      iiss$unit_name == "Helicopter"] <- "LPH"
iiss$equipment_type[iiss$equipment_type == "miscellaneous" &
                      iiss$unit_name == "Helicopter"] <- "helicopters"

iiss$equipment_name[iiss$equipment_type == "miscellaneous" &
                      iiss$unit_name == "Helicopter Support"] <- "LPH"
iiss$equipment_type[iiss$equipment_type == "miscellaneous" &
                      iiss$unit_name == "Helicopter Support"] <- "helicopters"
```

## Logistics and support

### Typos
Here we fix typos, which include spelling errors, capitalization errors, and any other formatting errors that affect merging or equipment similarity

#### Unit_name typos
```{r}
iiss$unit_name[iiss$unit_name == "fleet suppor ships"] <- "fleet support ships"
```

#### Equipment_subname typos
```{r}

```

#### Equipment_name typos
```{r}
iiss$equipment_name[iiss$equipment_name == "APOT"] <- "AOT"
iiss$equipment_name[iiss$equipment_name == "T-AKT"] <- "T-AKR"
iiss$equipment_name[iiss$equipment_name == "ATG"] <- "ATF"
iiss$equipment_name[iiss$equipment_name == "YFS"] <- "YFD"
iiss$equipment_name[iiss$equipment_name == "YTD"] <- "YTR"
iiss$equipment_name[iiss$equipment_name == "ADT"] <- "ADG"

iiss$equipment_name[iiss$equipment_type == "logistics and support" &
                      iiss$equipment_name == "ATK"] <- "AT"

```

#### Equipment_subtype typos
```{r}
iiss$equipment_subtype[iiss$equipment_subtype == "craft"] <- "landing craft"
iiss$equipment_subtype[iiss$equipment_subtype == "LC"] <- "landing craft"
iiss$equipment_subtype[iiss$equipment_subtype == "LS"] <- "landing ships"
iiss$equipment_subtype[iiss$equipment_subtype == "logistics and support"] <- NA
iiss$equipment_subtype[iiss$equipment_subtype == "transport"] <- "TPT"
iiss$equipment_subtype[iiss$equipment_subtype == "under way support"] <- "support"
```

#### Equipment_type typos
```{r}
iiss$equipment_type[iiss$equipment_type == "support"] <- "logistics and support"
iiss$equipment_type[iiss$equipment_type == "support and miscellaneous"] <- "logistics and support"
iiss$equipment_type[iiss$equipment_type == "support and miscelleneous"] <- "logistics and support"
iiss$equipment_type[iiss$equipment_type == "SUPPORT AND MISCELLANEOUS"] <- "logistics and support"
iiss$equipment_type[iiss$equipment_type == "boats/craft"] <- "logistics and support"
iiss$equipment_type[iiss$equipment_type == "Suuport and Miscellaneous"] <- "logistics and support"
```

### Coding changes

#### Unit_name
Fix incorrect columns based on unit_name value
```{r}
# Unit_name
iiss$equipment_type[iiss$equipment_type == "mine warfare" &
                 iiss$unit_name == "Kondor II"] <- "logistics and support"

# Equipment_subname

# Equipment_name
iiss$unit_name[iiss$equipment_type == "logistics and support" &
                 iiss$equipment_name == "naval ship asset"] <- "floating dock"

# Equipment_subtype

# Equipment_type

```

#### Equipment_subname
Fix incorrect columns that should have equipment_subname = TBD
```{r}
# Unit_name

# Equipment_subname

# Equipment_name

# Equipment_subtype

# Equipment_type

```

#### Equipment_name
Fix incorrect columns that should have equipment_name = TBD
```{r}
# Unit_name
# Convert to AKR, acronym for sealift
iiss$equipment_name[iiss$equipment_type == "logistics and support" &
                 iiss$unit_name == "intelligence collector"] <- "AGI"

# Equipment_subname

# Equipment_name
iiss$equipment_type[iiss$equipment_name == "tugs"] <- "logistics and support"
iiss$equipment_name[iiss$equipment_name == "tugs"] <- "AT"

iiss$equipment_name[iiss$equipment_type == "logistics and support" &
                      iiss$equipment_name == "Luneburg (Type 701)"] <- "ABU"

iiss$equipment_name[iiss$equipment_type == "logistics and support" &
                      iiss$equipment_name == "missile support"] <- "AEM"

iiss$equipment_name[iiss$equipment_type == "logistics and support" &
                      iiss$equipment_name == "O-69"] <- "AGS"

iiss$equipment_name[iiss$equipment_type == "logistics and support" &
                      iiss$equipment_name == "hospital"] <- "AH"

iiss$equipment_name[iiss$equipment_type == "logistics and support" &
                      iiss$equipment_name == "cargo"] <- "AK"

iiss$equipment_name[iiss$equipment_type == "logistics and support" &
                      (iiss$equipment_name == "supply and cargo" |
                         iiss$equipment_name == "supply ships")] <- "AOE"

iiss$equipment_name[iiss$equipment_type == "logistics and support" &
                      (iiss$equipment_name == "repair" |
                         iiss$equipment_name == "repair ships")] <- "AR"

iiss$equipment_name[iiss$equipment_type ==  "logistics and support" &
                      (iiss$equipment_name == "salvage/rescue" |
                         iiss$equipment_name == "submarine rescue")] <- "ARS"

iiss$equipment_name[iiss$equipment_type == "logistics and support" &
                      iiss$equipment_name == "submarine tenders"] <- "AS"

iiss$equipment_name[iiss$equipment_type == "Firefish III" &
                      iiss$equipment_name == "cargo"] <- "FAC"

iiss$equipment_name[iiss$equipment_type == "logistics and support" &
                      (iiss$equipment_name == "barrack ships" |
                         iiss$equipment_name == "fleet support ships")] <- "SPT"

# Equipment_subtype
iiss$equipment_name[iiss$equipment_type == "logistics and support" &
                 iiss$equipment_subtype == "submarines"] <- "AS"

# Equipment_type

```

#### Equipment_subtype
Fix incorrect columns that should have equipment_subtype = TBD
```{r}
# Unit_name

# Equipment_subname

# Equipment_name

# Equipment_subtype
iiss$equipment_subtype[iiss$equipment_subtype == "submarines"] <- NA

# Equipment_type

```

#### Equipment_type
Fix incorrect unit_name that should have equipment_type = equipment_type
```{r}
# Convert to floating dock
iiss$unit_name[iiss$equipment_type == "logistics and support" &
                 iiss$equipment_name == "naval ship asset"] <- "floating dock"

# Convert to coastal tug
iiss$unit_name[iiss$equipment_type == "logistics and support" &
                 iiss$equipment_subtype == "coastal tug"] <- "coastal tug"

# Convert to ocean tug
iiss$unit_name[iiss$equipment_type == "logistics and support" &
                 iiss$equipment_subtype == "ocean tug"] <- "ocean tug"

# Convert to repair 
iiss$unit_name[iiss$equipment_type == "logistics and support" &
                 iiss$equipment_subtype == "repair"] <- "repair"
iiss$equipment_type[iiss$equipment_type == "miscellaneous" &
                 iiss$equipment_subname %in% c("forward repair",
                                               "forwardrepair")] <- "logistics and support"
```

Fix incorrect equipment_subname that should have equipment_type = equipment_type
```{r}
# Convert to NA
iiss$equipment_subname[iiss$equipment_type == "logistics and support" &
                         iiss$equipment_name == "AXS" &
                         iiss$equipment_subname == "AXS"] <- NA
iiss$equipment_subname[iiss$equipment_type == "logistics and support" &
                         iiss$equipment_name == "AXL" &
                         iiss$equipment_subname == "AXL"] <- NA
iiss$equipment_subname[iiss$equipment_type == "logistics and support" |
                         iiss$equipment_subname == "ARH"] <- NA
iiss$equipment_subname[iiss$equipment_type == "logistics and support" &
                      iiss$equipment_name == "ARL" &
                        iiss$equipment_subname == "ARL"] <- NA
iiss$equipment_subname[iiss$equipment_type == "logistics and support" &
                      iiss$equipment_name == "AK" &
                      (iiss$equipment_subname == "T-AK(breakbulk)" |
                         iiss$equipment_subname == "T-AK(heavylift)")] <- NA
```

Fix incorrect equipment_name that should have equipment_type = equipment_type
```{r}
# Convert to naval ship asset
iiss$equipment_name[iiss$equipment_type == "naval ship asset"] <- "naval ship asset"

# Convert to AOT
iiss$equipment_name[iiss$equipment_type == "logistics and support" & 
                      iiss$equipment_subtype == "AOT"] <- "AOT"

# Convert to AGOR
iiss$equipment_name[iiss$equipment_type == "logistics and support" &
                      iiss$equipment_name == "Research Craft"] <- "AGOR"

# Convert to AKR
iiss$equipment_name[iiss$equipment_type == "logistics and support" &
                      iiss$equipment_name == "ALR"] <- "AKR"
iiss$equipment_name[iiss$equipment_type == "logistics and support" &
                 iiss$equipment_name == "military sealift"] <- "AKR"

# Convert to AXS
iiss$equipment_name[iiss$equipment_type == "logistics and support" &
                      iiss$equipment_name == "AX" &
                      iiss$equipment_subname == "AXS"] <- "AXS"

# Convert to AXL
iiss$equipment_name[iiss$equipment_type == "logistics and support" &
                      iiss$equipment_name == "AX" &
                      iiss$equipment_subname == "AXL"] <- "AXL"

# Convert to ARH
iiss$equipment_name[iiss$equipment_type == "logistics and support" &
                      iiss$equipment_name == "AAM"] <- "ARH"

# Convert to ARL
iiss$equipment_name[iiss$equipment_type == "logistics and support" &
                      iiss$equipment_name == "RECCE"] <- "ARL"

# Convert to TKR 
iiss$equipment_name[iiss$equipment_type == "logistics and support" &
                      (iiss$equipment_name == "TANKER LIGHT" |
                         iiss$equipment_name == "tkr")] <- "TKR"
iiss$equipment_name[iiss$equipment_type == "logistics and support" &
                      (iiss$equipment_name == "Water Tender" |
                         iiss$equipment_name == "water tkr")] <- "TKR"

# Convert to TPT
iiss$equipment_name[iiss$equipment_type == "logistics and support" &
                      (iiss$equipment_name == "tpt" |
                         iiss$equipment_name == "Tpt")] <- "TPT"

# Convert to TRG
iiss$equipment_name[iiss$equipment_type == "logistics and support" &
                      (iiss$equipment_name == "TRG (sail)" |
                         iiss$equipment_name == "TRG 2 (sail)" |
                         iiss$equipment_name == "sail trg")] <- "TRG"
iiss$equipment_name[iiss$equipment_type == "logistics and support" &
                      iiss$equipment_name == "trg"] <- "TRG"

# Convert to T-AK
iiss$equipment_name[iiss$equipment_type == "logistics and support" &
                      iiss$equipment_name == "AK" &
                      (iiss$equipment_subname == "T-AK(breakbulk)" |
                         iiss$equipment_subname == "T-AK(heavylift)")] <- "T-AK"
iiss$equipment_name[iiss$equipment_name == "T-AKRH"] <- "T-AKR"
iiss$equipment_name[iiss$equipment_name == "AkR"] <- "AKR"

# Convert to AX/TRG
iiss$equipment_name[iiss$equipment_type == "logistics and support" &
                      iiss$equipment_name == "AX (trg)"] <- "AX/TRG"

# Convert to AXS/TRG
iiss$equipment_name[iiss$equipment_type == "logistics and support" &
                      iiss$equipment_name == "TRG AXS"] <- "AXS/TRG"

# Convert to YDT
iiss$equipment_name[iiss$equipment_type == "logistics and support" &
                      iiss$equipment_name == "diving tender"] <- "YDT"

# Convert to SPT/YDT
iiss$equipment_name[iiss$equipment_type == "logistics and support" &
                      (iiss$equipment_name == "Diving tender/spt" |
                         iiss$equipment_name == "YDT/spt")] <- "SPT/YDT"

# Convert to SPT
iiss$equipment_name[iiss$equipment_type == "logistics and support" &
                      iiss$equipment_name == "spt"] <- "SPT"
iiss$equipment_name[iiss$equipment_type == "logistics and support" &
                      iiss$equipment_name == "diving spt"] <- "SPT"

# Convert to SPT/TKR
iiss$equipment_name[iiss$equipment_type == "logistics and support" &
                      iiss$equipment_name == "spt tkr"] <- "SPT/TKR"

# Convert to CMD/SPT
iiss$equipment_name[iiss$equipment_type == "logistics and support" &
                      iiss$equipment_name == "spt/cmd"] <- "CMD/SPT"

# Convert to RY
iiss$equipment_name[iiss$equipment_type == "logistics and support" &
                      iiss$equipment_name == "RY Royal Yacht"] <- "RY"

# Convert to AE/AMMO
iiss$equipment_name[iiss$equipment_type == "logistics and support" &
                      iiss$equipment_name == "AE (AMMO)"] <- "AE/AMMO"

# Convert to AGI/INT
iiss$equipment_name[iiss$equipment_type == "logistics and support" &
                      iiss$equipment_name == "AGI (INT)"] <- "AGI/INT"

# Convert to AGHS/SVY
iiss$equipment_name[iiss$equipment_type == "logistics and support" &
                      iiss$equipment_name == "AGHS (SVY)"] <- "AGHS/SVY"

# Convert to AH/MED
iiss$equipment_name[iiss$equipment_type == "logistics and support" &
                      iiss$equipment_name == "AH (MED)"] <- "AH/MED"

# Convert to T-AOE/RAS
iiss$equipment_name[iiss$equipment_type == "logistics and support" &
                      iiss$equipment_name == "T-AOE (RAS)"] <- "T-AOE/RAS"

# Convert to TPT/TRG
iiss$equipment_name[iiss$equipment_type == "logistics and support" &
                      iiss$equipment_name == "tpt/trg"] <- "TPT/TRG"

# Convert to LCU
iiss$equipment_name[iiss$equipment_type == "logistics and support" &
                      iiss$equipment_name == "Craft" &
                      iiss$unit_name == "LCU"] <- "LCU"

# Convert to tug
iiss$equipment_name[iiss$equipment_type == "logistics and support" &
                      (iiss$equipment_name == "ocean tug" |
                         iiss$equipment_name == "ocean tugs")] <- "tug"

# Convert to trial 
iiss$equipment_name[iiss$equipment_type == "logistics and support" &
                      (iiss$equipment_name == "Trial" |
                         iiss$equipment_name == "Trial Ship")] <- "trial"
iiss$equipment_name[iiss$equipment_type == "logistics and support" &
                      iiss$equipment_name == "TRIAL"] <- "trial"

# Convert to AOT
iiss$equipment_name[iiss$equipment_type == "logistics and support" &
                      iiss$equipment_subtype == "coastal"] <- "AOT"

# Convert to NA
iiss$equipment_name[iiss$equipment_type == "logistics and support" &
                      iiss$equipment_name == "Craft"] <- NA
```

Fix incorrect equipment_subtype that should have equipment_type = equipment_type
```{r}
# Convert to NA
iiss$equipment_subtype[iiss$equipment_type == "logistics and support" &
                       iiss$equipment_subtype == "CRAFT"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "logistics and support" &
                         (iiss$equipment_subtype == "TRG" |
                            iiss$equipment_subtype == "surv" |
                            iiss$equipment_subtype == "support")] <- NA
iiss$equipment_subtype[iiss$equipment_type == "logistics and support" &
                         iiss$equipment_subtype == "landing craft"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "logistics and support" &
                      iiss$equipment_subtype == "coastal" &
                      iiss$equipment_name == "AOT"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "logistics and support" &
                 iiss$equipment_subtype == "coastal tug"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "logistics and support" &
                         iiss$equipment_subtype == "ocean tug"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "logistics and support" &
                         iiss$equipment_subtype == "repair"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "logistics and support" & 
                         iiss$equipment_subtype == "AOT" & 
                         iiss$equipment_subtype == "AOT"] <- NA

iiss$equipment_type[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_subtype == "icebreakers"] <- "logistics and support"
iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_subtype == "icebreakers"] <- "AGB"
iiss$equipment_subtype[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_subtype == "icebreakers"] <- NA
```

Fix incorrect equipment_type that should have equipment_type = equipment_type
```{r}
# Naval ship asset
iiss$equipment_type[iiss$equipment_type == "naval ship asset" &
                      iiss$equipment_name == "naval ship asset"] <- "logistics and support"

# Support and miscellaneous
iiss$equipment_type[iiss$equipment_type == "Support and Miscellaneous"] <- "logistics and support"

# Intelligence vessels
iiss$equipment_type[iiss$equipment_type == "intelligence vessels"] <- "logistics and support"

# Marine
iiss$equipment_type[iiss$equipment_type == "marine"] <- "logistics and support"

# Air defence
iiss$equipment_type[iiss$equipment_type == "air defence" &
                      iiss$equipment_name == "ATF"] <- "logistics and support"

# RMAs
iiss$equipment_type[iiss$equipment_type == "rmas"] <- "logistics and support"

# minor surface combatants
iiss$equipment_type[iiss$equipment_type == "minor surface combatants" &
                      iiss$equipment_name == "AO"] <- "logistics and support"

iiss$equipment_type[iiss$equipment_type == "minor surface combatants" &
                      iiss$equipment_name == "SPT"] <- "logistics and support"

iiss$equipment_type[iiss$equipment_type == "minor surface combatants" &
                      iiss$equipment_name == "TRG"] <- "logistics and support"

iiss$equipment_type[iiss$equipment_type == "minor surface combatants" &
                      iiss$equipment_name == "VIP"] <- "logistics and support"

# misc
iiss$equipment_type[iiss$equipment_type == "miscellaneous" &
                      iiss$unit_name == "BH-7"] <- "logistics and support"

iiss$equipment_type[iiss$equipment_type == "miscellaneous" &
                      iiss$unit_name == "Deep Diving"] <- "logistics and support"

iiss$equipment_type[iiss$equipment_type == "miscellaneous" &
                      iiss$unit_name == "Depot"] <- "logistics and support"

iiss$equipment_type[iiss$equipment_type == "miscellaneous" &
                      iiss$unit_name == "Mooring and Salvage Vessel"] <- "logistics and support"

iiss$equipment_type[iiss$equipment_type == "miscellaneous" &
                      iiss$unit_name == "Royal Yacht"] <- "logistics and support"

iiss$equipment_type[iiss$equipment_type == "miscellaneous" &
                      iiss$unit_name == "Seabed Ops Vessel"] <- "logistics and support"

iiss$equipment_type[iiss$equipment_type == "miscellaneous" &
                      iiss$unit_name == "Sub Tender"] <- "logistics and support"

iiss$equipment_type[iiss$equipment_type == "miscellaneous" &
                      iiss$unit_name == "Survey Vessel"] <- "logistics and support"

# NA
iiss$equipment_type[is.na(iiss$equipment_type) &
                      (iiss$equipment_name == "AG" |
                       iiss$equipment_name == "YDT" |
                         iiss$equipment_name == "YFRT" |
                         iiss$equipment_name == "YTM")] <- "logistics and support"

iiss$equipment_subtype[iiss$equipment_type == "logistics and support"] <- NA

# Patrol and coastal combatants
iiss$equipment_type[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_name %in% c("AB",
                                                 "ACV",
                                                 "ACV/VCAC",
                                            "AEF",
                                            "AIR SPT",
                                            "AG",
                                            "AGHS",
                                            "AK",
                                            "AOT",
                                            "AVT",
                                            "AR",
                                            "COMD",
                                            "fleet replenishing ships",
                                            "repair",
                                            "SAR",
                                            "Survey",
                                            "tankers",
                                            "trials/research",
                                            "WTGB",
                                            "YDT",
                                            "YP",
                                            "YTB")] <- "logistics and support"
```

## Mine warfare

### Typos
Here we fix typos, which include spelling errors, capitalization errors, and any other formatting errors that affect merging or equipment similarity

#### Unit_name typos
```{r}

```

#### Equipment_subname typos
```{r}

```

#### Equipment_name typos
```{r}
iiss$equipment_name[iiss$equipment_name == "MCH"] <- "MHC"
```

#### Equipment_subtype typos
```{r}
iiss$equipment_subtype[iiss$equipment_type == "mine countermeasures" & 
                         iiss$equipment_subtype == "aircraft carriers"] <- NA
iiss$equipment_subtype[iiss$equipment_subtype == "minelayers"] <- "mine layers"

iiss$equipment_subtype[iiss$equipment_subtype == "MCM"] <- "mine countermeasures"
iiss$equipment_subtype[iiss$equipment_subtype == "ocean minesweepers"] <- "minesweepers"

iiss$equipment_subtype[iiss$equipment_subtype == "minhunter"] <- "minehunters"
iiss$equipment_subtype[iiss$equipment_subtype == "minsweepers"] <- "minesweepers"
```

#### Equipment_type typos
```{r}
iiss$equipment_type[iiss$equipment_type == "mine countermeasure"] <- "mine warfare"
iiss$equipment_type[iiss$equipment_type == "mine countermeasures"] <- "mine warfare"
iiss$equipment_type[iiss$equipment_type == "mine warefare"] <- "mine warfare"
iiss$equipment_type[iiss$equipment_type == "minehunters, coastal"] <- "mine warfare"
iiss$equipment_type[iiss$equipment_type == "rivercraft"] <- "mine warfare"
iiss$equipment_type[iiss$equipment_type == "minesweeper"] <- "mine warfare"
iiss$equipment_type[iiss$equipment_type == "minesweepers"] <- "mine warfare"
```

### Coding changes

#### Unit_name
Fix incorrect columns based on unit_name value
```{r}
# Unit_name

# Equipment_subname

# Equipment_name
iiss$equipment_name[iiss$unit_name == "Ham"] <- "MSI"

# Equipment_subtype

# Equipment_type
iiss$equipment_type[iiss$unit_name == "Ham"] <- "mine warfare"
```

#### Equipment_subname
Fix incorrect columns that should have equipment_subname = TBD
```{r}
# Unit_name

# Equipment_subname

# Equipment_name

# Equipment_subtype

# Equipment_type

```

  REPEAT FOR EACH EQUIPMENT_SUBNAME AS NEEDED

#### Equipment_name
Fix incorrect columns that should have equipment_name = TBD
```{r}
# Unit_name

# Equipment_subname

# Equipment_name
iiss$equipment_type[iiss$equipment_type == "mine warfare" &
                      iiss$equipment_name == "MINE"] <- "mine warfare"

iiss$equipment_name[iiss$equipment_type == "mine warfare" &
                      iiss$equipment_name == "coastal"] <- "MCC"
iiss$equipment_name[iiss$equipment_type == "mine warfare" &
                      iiss$equipment_name == "SPT"] <- "MCD"
iiss$equipment_name[iiss$equipment_type == "mine warfare" &
                      iiss$equipment_name == "inshore"] <- "MCI"
iiss$equipment_name[iiss$equipment_type == "mine warfare" &
                      iiss$equipment_name == "hovercraft"] <- "MCM"
iiss$equipment_name[iiss$equipment_type == "mine warfare" &
                      iiss$equipment_name == "MSB"] <- "MCM"
iiss$equipment_type[iiss$equipment_name == "MCMV"] <- "mine warfare"
iiss$equipment_name[iiss$equipment_type == "mine warfare" &
                      iiss$equipment_name == "dual-rule"] <- "MCM/ML"
iiss$equipment_name[iiss$equipment_type == "mine warfare" &
                      iiss$equipment_name == "LCC"] <- "MCMCS"
iiss$equipment_name[iiss$equipment_type == "mine warfare" &
                      iiss$equipment_name == "SAM"] <- "MCO"
iiss$equipment_name[iiss$equipment_type == "mine warfare" &
                      iiss$equipment_name == "PCC"] <- "MSC"
iiss$equipment_name[iiss$equipment_type == "mine warfare" &
                      iiss$equipment_name == "PCO"] <- "MSI"
iiss$equipment_name[iiss$equipment_type == "mine warfare" &
                      iiss$equipment_name == "PBR"] <- "MSI"
iiss$equipment_name[iiss$equipment_type == "mine warfare" &
                      iiss$equipment_name == "ocean"] <- "MSO"

iiss$equipment_name[iiss$equipment_type == "mine warfare" &
                      iiss$equipment_name == "LST"] <- "ML"
iiss$equipment_name[iiss$equipment_type == "MINE" &
                      iiss$equipment_name == "LST"] <- "ML"

iiss$equipment_name[iiss$equipment_type == "mine warfare" &
                 iiss$equipment_name == "SP"] <- "MCM/SPT"


# Equipment_subtype
iiss$equipment_subtype[iiss$equipment_name == "FSU"] <- "mine countermeasures"

# Equipment_type
iiss$equipment_type[iiss$equipment_name == "FSU"] <- "mine warfare"

iiss$equipment_type[iiss$equipment_type == "minor surface combatants" &
                      iiss$equipment_name == "MCO"] <- "mine warfare"
iiss$equipment_subtype[iiss$equipment_type == "minor surface combatants" &
                      iiss$equipment_name == "MCO"] <- "mine countermeasures"

iiss$equipment_type[iiss$equipment_type == "minor surface combatants" &
                      iiss$equipment_name == "dual-role"] <- "mine warfare"

iiss$equipment_type[iiss$equipment_type == "minor surface combatants" &
                      iiss$equipment_name == "MHC"] <- "mine warfare"
iiss$equipment_subtype[iiss$equipment_type == "minor surface combatants" &
                      iiss$equipment_name == "MHC"] <- "mine countermeasures"

iiss$equipment_type[iiss$equipment_type == "minor surface combatants" &
                      iiss$equipment_name == "MSC"] <- "mine warfare"
iiss$equipment_subtype[iiss$equipment_type == "minor surface combatants" &
                      iiss$equipment_name == "MSC"] <- "mine countermeasures"

iiss$equipment_type[iiss$equipment_type == "minor surface combatants" &
                      iiss$equipment_name == "MSO"] <- "mine warfare"
iiss$equipment_subtype[iiss$equipment_type == "minor surface combatants" &
                      iiss$equipment_name == "MSO"] <- "mine countermeasures"

iiss$equipment_type[iiss$equipment_type == "minor surface combatants" &
                      iiss$equipment_name == "SP"] <- "mine warfare"
```

  REPEAT FOR EACH EQUIPMENT_NAME AS NEEDED
  
#### Equipment_subtype
Fix incorrect columns that should have equipment_subtype = TBD
```{r}
# Unit_name

# Equipment_subname

# Equipment_name

# Equipment_subtype
iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$unit_name == "minesweepers"] <- "MS"
iiss$equipment_type[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$unit_name == "minesweepers"] <- "mine warfare"

iiss$equipment_type[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_name == "MCMV"] <- "mine warfare"

iiss$equipment_subtype[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_name == "MBG"] <- NA

iiss$equipment_type[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_subtype == "mine countermeasures"] <- "mine warfare"

iiss$equipment_name[iiss$equipment_type == "mine warfare" &
                      iiss$equipment_name == "PC"] <- NA

# Equipment_type

```

  REPEAT FOR EACH EQUIPMENT_SUBTYPE AS NEEDED

#### Equipment_type

Fix incorrect unit_name that should have equipment_type = equipment_type
```{r}
iiss$equipment_type[iiss$unit_name == "cable mine"] <- "mine warfare"
iiss$equipment_name[iiss$unit_name == "cable mine"] <- "ML"
```

Fix incorrect equipment_subname that should have equipment_type = equipment_type
```{r}
# Convert to NA
iiss$equipment_subname[iiss$equipment_type == "mine warfare" &
                      iiss$equipment_name == "SPT" &
                      iiss$equipment_subname == "T"] <- NA

iiss$equipment_subname[iiss$equipment_type == "mine warfare"] <- NA
```

Fix incorrect equipment_name that should have equipment_type = equipment_type
```{r}
# Convert to MSO
iiss$equipment_name[iiss$equipment_type == "mine warfare" &
                      iiss$equipment_subtype == "mine countermeasures" &
                      iiss$equipment_name == "FSU"] <- "MSO"

# Convert to MCM
iiss$equipment_name[iiss$equipment_type == "MCM"] <- "MCM"

# Convert to MCMV
iiss$equipment_name[iiss$equipment_type == "mine warfare" &
                      iiss$equipment_subtype == "MCMV"] <- "MCMV"

# Convert to MLI
iiss$equipment_name[iiss$equipment_type == "mine warfare" &
                      (iiss$equipment_name == "ML(1)" |
                         iiss$equipment_name == "ML(I)")] <- "MLI"

# Convert to MCM/SPT
iiss$equipment_name[iiss$equipment_type == "mine warfare" &
                      iiss$equipment_name == "MCM SPT"] <- "MCM/SPT"

# Convert to SPT
iiss$equipment_name[iiss$equipment_type == "mine warfare" &
                      iiss$equipment_name == "SP" &
                      iiss$equipment_subname == "T"] <- "SPT"
```

Fix incorrect equipment_subtype that should have equipment_type = equipment_type
```{r}
# Convert to mine countermeasures
iiss$equipment_subtype[iiss$equipment_type == "mine warfare" &
                      (iiss$equipment_name == "MCM" |
                         iiss$equipment_name == "MSI")] <- "mine countermeasures"
iiss$equipment_subtype[iiss$equipment_type == "mine warfare" &
                         iiss$equipment_name == "MCO"] <- "mine countermeasures"
iiss$equipment_subtype[iiss$equipment_type == "mine warfare" &
                         iiss$equipment_name == "MCCS"] <- "mine countermeasures"
iiss$equipment_subtype[iiss$equipment_type == "principal surface combatants" &
                      iiss$equipment_subtype == "aircraft carriers" &
                      iiss$equipment_name == "MCO"] <- "mine countermeasures"
iiss$equipment_name[iiss$equipment_subtype == "aircraft carriers" &
                      iiss$equipment_name == "SAM"] <- "MCO"
# Convert to NA
iiss$equipment_subtype[iiss$equipment_type == "mine warfare" &
                         iiss$equipment_subtype == "MCMV" &
                         iiss$equipment_name == "MCMV"] <- NA
```

Fix incorrect equipment_type that should have equipment_type = equipment_type
```{r}
# Principal surface combatants
iiss$equipment_type[iiss$equipment_type == "principal surface combatants" &
                      iiss$equipment_subtype == "mine countermeasures"] <- "mine warfare"
iiss$equipment_type[iiss$equipment_type == "principal surface combatants" &
                      iiss$equipment_name %in% c("MCO",
                                                 "MSO")] <- "mine warfare"
iiss$equipment_type[iiss$equipment_type == "principal surface combatants" &
                      iiss$equipment_subtype == "mine countermeasures" & 
                      iiss$equipment_name == "MCO"] <- "mine warfare"


# Patrol and coastal combatants
iiss$equipment_type[iiss$equipment_type == "patrol and coastal combatants" &
                      (iiss$equipment_name == "MCM" |
                         iiss$equipment_name == "MSI")] <- "mine warfare"
iiss$equipment_type[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_subtype %in% c("mine countermeasures",
                                                    "minesweepers")] <- "mine warfare"

# Logistics and support
iiss$equipment_type[iiss$equipment_type == "logistics and support" &
                      (iiss$equipment_name == "MCM" |
                         iiss$equipment_name == "MCM/PF" |
                         iiss$equipment_name == "MCMV")] <- "mine warfare"

# MCM
iiss$equipment_type[iiss$equipment_type == "MCM" &
                      iiss$equipment_name == "MCM"] <- "mine warfare"

# Artillery
iiss$equipment_type[iiss$equipment_type == "artillery" &
                      iiss$equipment_subtype == "mine countermeasures"] <- "mine warfare"
iiss$equipment_type[iiss$equipment_type == "artillery" &
                         iiss$equipment_subtype == "mine layers"] <- "mine warfare"

# NA
iiss$equipment_type[is.na(iiss$equipment_type) &
                      (iiss$equipment_name == "MINE" |
                         iiss$unit_name == "Fushun MSI") |
                      iiss$unit_name == "Fushun MSI"] <- "mine warfare"
iiss$equipment_type[is.na(iiss$equipment_type) &
                      (iiss$unit_name == "cable mine")] <- "mine warfare"

```

## Patrol and coastal combatants

### Typos
Here we fix typos, which include spelling errors, capitalization errors, and any other formatting errors that affect merging or equipment similarity

#### Unit_name typos
```{r}
iiss$unit_name[iiss$unit_name == "Point (US)"] <- "Point"
iiss$unit_name[iiss$unit_name == "SS-N-2B Styx SSM"] <- "SS-N-2B Styx"
```

#### Equipment_subname typos
```{r}
iiss$equipment_subname[iiss$equipment_subname == "paraguay"] <- NA
```

#### Equipment_name typos
```{r}
iiss$equipment_name[iiss$equipment_name == "IUW"] <- "MIUW"

iiss$equipment_name[iiss$equipment_name == "Inshore" |
                      iiss$equipment_name == "INSHORE" |
                      iiss$equipment_name == "lake"] <- "inshore"

iiss$equipment_name[iiss$equipment_name == "FAC (G)"] <- "FAC(G)"
iiss$equipment_name[iiss$equipment_name == "FAC (M)"] <- "FAC(M)"
iiss$equipment_name[iiss$equipment_name == "FAC (T)"] <- "FAC(T)"

iiss$equipment_name[iiss$equipment_name == "GENERAL PURPOSE"] <- "GP"

inactive_fleet <- iiss$unit_name[iiss$subservice == "inactive fleet"]
unique(inactive_fleet)
iiss$equipment_name[iiss$unit_name == "CV"] <- "CV"
iiss$equipment_name[iiss$unit_name == "BB"] <- "BB"
iiss$equipment_name[iiss$unit_name == "CG"] <- "CG"
iiss$equipment_name[iiss$unit_name == "DD"] <- "DD"
iiss$equipment_name[iiss$unit_name == "DDG"] <- "DDG"
iiss$equipment_name[iiss$unit_name == "LKA"] <- "LKA"
iiss$equipment_name[iiss$unit_name == "LCT"] <- "LCT"
iiss$equipment_name[iiss$unit_name == "AG"] <- "AG"
iiss$equipment_name[iiss$unit_name == "AO"] <- "AO"
iiss$unit_name[iiss$unit_name == "CV" |
                 iiss$unit_name == "BB" |
                 iiss$unit_name == "CG" |
                 iiss$unit_name == "DD" |
                 iiss$unit_name == "DDG" |
                 iiss$unit_name == "LKA" |
                 iiss$unit_name == "LCT" |
                 iiss$unit_name == "AG" |
                 iiss$unit_name == "AO"] <- NA

iiss$equipment_name[iiss$equipment_name == "Patrol Boats"] <- "PB"
iiss$equipment_name[iiss$equipment_name == "patrol coastal"] <- "PBC"
iiss$equipment_name[iiss$equipment_name == "patrol craft"] <- "PC"
iiss$equipment_name[iiss$equipment_name == "PATROL CRAFT"] <- "PC"
iiss$equipment_name[iiss$equipment_name == "Riverine"] <- "PBR"

iiss$equipment_name[iiss$equipment_name == "Spt" |
                      iiss$equipment_name == "SUPPORT AND MISCELLANEOUS"] <- "SPT"

iiss$equipment_name[iiss$unit_count == "Oliver Hazard Perry"] <- "FFH"

iiss$equipment_name[iiss$equipment_name == "TOPPEDO"] <- "torpedo"
```

#### Equipment_subtype typos
```{r}
iiss$equipment_subtype[iiss$equipment_subtype == "boats/craft"] <- "MISC"

iiss$equipment_subtype[iiss$equipment_subtype == "patrol coastal"] <- "inshore"
iiss$equipment_subtype[iiss$equipment_subtype == "patrol, coastal/inshore"] <- "inshore"
iiss$equipment_subtype[iiss$equipment_subtype == "patrol craft coastal"] <- "inshore"
iiss$equipment_subtype[iiss$equipment_subtype == "coastal patrol craft"] <- "inshore"
iiss$equipment_subtype[iiss$equipment_subtype == "patrol craft, coastal"] <- "inshore"
iiss$equipment_subtype[iiss$equipment_subtype == "patrol craft inshore"] <- "inshore"
iiss$equipment_subtype[iiss$equipment_subtype == "patrol inshore"] <- "inshore"
iiss$equipment_subtype[iiss$equipment_subtype == "patrol, inshore"] <- "inshore"
iiss$equipment_subtype[iiss$equipment_subtype == "patrol craft, inshore"] <- "inshore"
iiss$equipment_subtype[iiss$equipment_subtype == "coastal/inshore"] <- "inshore"

iiss$equipment_subtype[iiss$equipment_subtype == "patrol craft offshore"] <- "offshore"
iiss$equipment_subtype[iiss$equipment_subtype == "patrol craft, offshore"] <- "offshore"
iiss$equipment_subtype[iiss$equipment_subtype == "patrol offshore"] <- "offshore"

iiss$equipment_subtype[iiss$equipment_subtype == "patrol craft riverine"] <- "riverine"
iiss$equipment_subtype[iiss$equipment_subtype == "rover patrol"] <- "riverine"
iiss$equipment_subtype[iiss$equipment_subtype == "river"] <- "riverine"

iiss$equipment_subtype[iiss$equipment_subtype == "MISSILE CRAFT"] <- "missile craft"

iiss$equipment_subtype[iiss$equipment_subtype == "large patrol craft"] <- "patrol craft"
iiss$equipment_subtype[iiss$equipment_subtype == "small patrol craft"] <- "patrol craft"

iiss$equipment_subtype[iiss$equipment_subtype == "SPT vessels"] <- "support"
iiss$equipment_subtype[iiss$equipment_subtype == "support craft"] <- "support"

iiss$equipment_subtype[iiss$equipment_subtype == "inshore undersea warfare"] <- NA
iiss$equipment_subtype[iiss$equipment_subtype == "maintenance and logistic"] <- NA
iiss$equipment_subtype[iiss$equipment_subtype == "offshore"] <- NA
iiss$equipment_subtype[iiss$equipment_subtype == "sea-based"] <- NA
iiss$equipment_subtype[iiss$equipment_subtype == "static"] <- NA
iiss$equipment_subtype[iiss$equipment_subtype == "special purpose"] <- NA
```

#### Equipment_type typos
```{r}
iiss$equipment_type[iiss$equipment_type == "assault boats"] <- "patrol and coastal combatants"
iiss$equipment_type[iiss$equipment_type == "assault craft"] <- "patrol and coastal combatants"
iiss$equipment_type[iiss$equipment_type == "coastal"] <- "patrol and coastal combatants"
iiss$equipment_type[iiss$equipment_type == "coastal and patrol combatants"] <- "patrol and coastal combatants"
iiss$equipment_type[iiss$equipment_type == "craft"] <- "patrol and coastal combatants"
iiss$equipment_type[iiss$equipment_type == "fasta attack craft (gun)"] <- "patrol and coastal combatants"
iiss$equipment_type[iiss$equipment_type == "landing vessel"] <- "patrol and coastal combatants"
iiss$equipment_type[iiss$equipment_type == "merchant fleet"] <- "patrol and coastal combatants"
iiss$equipment_type[iiss$equipment_type == "navy"] <- "patrol and coastal combatants"
iiss$equipment_type[iiss$equipment_type == "patrol and coastal"] <- "patrol and coastal combatants"
iiss$equipment_type[iiss$equipment_type == "patrol and coastal combatancts" |
                      iiss$equipment_type == "patrol and costal combatants" |
                      iiss$equipment_type == "postal and costal combatants" |
                      iiss$equipment_type == "patrol and coatal combatants"] <- "patrol and coastal combatants"
iiss$equipment_type[iiss$equipment_type == "patrol and coastal combatant"] <- "patrol and coastal combatants"
iiss$equipment_type[iiss$equipment_type == "patrol boat"] <- "patrol and coastal combatants"
iiss$equipment_type[iiss$equipment_type == "patrol boats"] <- "patrol and coastal combatants"
iiss$equipment_type[iiss$equipment_type == "patrol craft" |
                      iiss$equipment_type == "Patrol Craft"] <- "patrol and coastal combatants"
iiss$equipment_type[iiss$equipment_type == "patrol vessel"] <- "patrol and coastal combatants"
iiss$equipment_type[iiss$equipment_type == "river patrol craft"] <- "patrol and coastal combatants"
iiss$equipment_type[iiss$equipment_type == "rivers ships"] <- "patrol and coastal combatants"
```

### Coding changes

#### Unit_name
Fix incorrect columns based on unit_name value
```{r}
# Unit_name
iiss$unit_name[iiss$unit_name == "APC"] <- "VAB"

# Equipment_subname
iiss$equipment_subname[iiss$unit_name == "Betelgeuse"] <- NA

# Equipment_name
iiss$equipment_name[iiss$unit_name == "Rihtniemi" |
                      iiss$unit_name == "Ruissalo"] <- "PB"

iiss$equipment_name[iiss$equipment_type == "mine warfare" &
                      (iiss$unit_name == "Suv SO-1" |
                      iiss$unit_name == "US PGM-59/71")] <- "PC"
iiss$equipment_type[iiss$equipment_type == "mine warfare" &
                      (iiss$unit_name == "Suv SO-1" |
                      iiss$unit_name == "US PGM-59/71")] <- "patrol and coastal combatants"

iiss$equipment_name[iiss$unit_name == "Betelgeuse"] <- "PCC"

# Equipment_subtype
iiss$equipment_subtype[iiss$unit_name == "Rihtniemi"] <- "PB"

iiss$equipment_subtype[iiss$unit_name == "Ruissalo"] <- "missile craft"

# Equipment_type
iiss$equipment_type[iiss$unit_name == "Gemini"] <- "patrol and coastal combatants"
iiss$equipment_type[iiss$unit_name == "Rihtniemi"] <- "patrol and coastal combatants"
iiss$equipment_type[iiss$unit_name == "Ruissalo"] <- "patrol and coastal combatants"

```

#### Equipment_subname
Fix incorrect columns that should have equipment_subname = TBD
```{r}
# Unit_name
iiss$equipment_name[iiss$unit_name == "gunboats)" |
                      iiss$unit_name == "patrol gunboat" |
                      iiss$unit_name == "river gunboats" |
                      iiss$unit_name == "riverine gunboat" |
                      iiss$unit_name == "small gunboat"] <- "PG"
iiss$equipment_name[iiss$unit_name == "motor gunboats"] <- "MGB"
iiss$equipment_name[iiss$unit_name == "patrol craft"] <- "PC"


# Equipment_subname
iiss$equipment_name[iiss$equipment_subname == "(buoytenders)"] <- "ABU"
iiss$equipment_name[iiss$equipment_subname == "MissileCraft"] <- "PFG"

# Equipment_name

# Equipment_subtype
iiss$equipment_subname[iiss$equipment_type == "amphibious" &
                         iiss$equipment_subname == "TPT"] <- NA

# Equipment_type

```

#### Equipment_name
Fix incorrect columns that should have equipment_name = TBD
```{r}
# Unit_name
iiss$equipment_name[iiss$equipment_name == "VAB"] <- "APC"

iiss$equipment_subtype[iiss$equipment_type == "principal surface combatants" &
                      iiss$equipment_name == "FAC"] <- NA
iiss$equipment_type[iiss$equipment_type == "principal surface combatants" &
                      iiss$equipment_name == "FAC"] <- "patrol and coastal combatants"
iiss$equipment_type[iiss$equipment_type == "principal surface combatants" &
                      iiss$equipment_name == "FPBG"] <- "patrol and coastal combatants"

iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$unit_name == "ex-MSC"] <- "PBC"

iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      (iiss$unit_name == "Al Bachir" |
                         iiss$unit_name == "Ch Yulin" |
                         iiss$unit_name == "Inshore")] <- "PCI"

iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_name == "ASUW" &
                      iiss$unit_name == "Lurssen 38-m"] <- "FAC"
iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_name == "ASUW" &
                      iiss$unit_name == "Lurssen 45-m"] <- "FAC(G)"
iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_name == "ASUW" &
                      iiss$unit_name == "Lurssen type 62-001 (62-m)"] <- "FAC(G)"
iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_name == "ASUW" &
                      iiss$unit_name == "TNC-45 FAC(M)"] <- "FAC(M)"

iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_name == "FRG" &
                      iiss$unit_name == "Beruang (Lurssen TNC-45)"] <- "FPB"

iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_name == "FSU/PFI"] <- "PFI"

iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_name == "PI"] <- "PCI"

iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_name == "TC"] <- "PCT"

# Equipment_subname
iiss$equipment_name[iiss$equipment_subname == "PCI"] <- "PCI"

# Equipment_name
iiss$equipment_name[iiss$equipment_name == "icebreakers"] <- "AGB"

iiss$equipment_name[iiss$equipment_name == "IUW"] <- "MIUW"

iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_name == "large" &
                      iiss$unit_name == "patrol craft"] <- "PC"

iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$unit_name == "CH patrol craft"] <- "PC"

iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_name == "coastal" &
                      iiss$unit_name == "patrol boats"] <- "PBC"

iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_name == "TT"] <- "PCT"

iiss$equipment_type[iiss$equipment_type == "amphibious" &
                      iiss$equipment_subtype == "LCT" &
                      (iiss$equipment_name == "MGB" |
                         iiss$equipment_name == "MTB")] <- "patrol and coastal combatants"
iiss$equipment_subtype[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_subtype == "LCT" &
                      (iiss$equipment_name == "MGB" |
                         iiss$equipment_name == "MTB")] <- NA

iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_subname == "patrol craft" &
                      iiss$equipment_name == "inshore"] <- "PCI"

iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_name == "Missile Craft"] <- "PCM"

iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_name == "large" &
                      iiss$unit_name == "Poti"] <- "FAC(T)"

iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_name == "large" &
                      iiss$unit_name == "SO-1"] <- "FAC(P)"

iiss$equipment_name[iiss$equipment_name == "Cristophe (US Stotomoyo tug)"] <- "PCO"

iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$unit_subname == "PCI"] <- "PCI"
iiss$equipment_subname[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$unit_subname == "PCI"] <- NA

iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_name == "coastal"] <- "PBC"

iiss$equipment_type[iiss$equipment_type == "amphibious" &
                      iiss$equipment_name %in% c("LPC",
                                                 "PBG",
                                                 "PGH",
                                                 "VTB")] <- "patrol and coastal combatants"

iiss$equipment_type[iiss$equipment_type == "gps" &
                      iiss$equipment_name == "RECCE"] <- "patrol and coastal combatants"

iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_name %in% c("inshore",
                                                 "patrol inshore",
                                                 "patrol, coastal/inshore",
                                                 "patrol, inshore")] <- "PBI"

# Equipment_subtype
iiss$equipment_subtype[iiss$equipment_name == "PFC"] <- NA
iiss$equipment_subtype[iiss$equipment_name == "MIUW"] <- "inshore patrol"
iiss$equipment_subtype[iiss$equipment_name == "FS" |
                      iiss$equipment_name == "FSG"] <- "corvettes"
iiss$equipment_subtype[iiss$equipment_name == "PCI"] <- "inshore"

# Equipment_type
iiss$equipment_type[iiss$equipment_name == "PFC"] <- "patrol and coastal combatants"
iiss$equipment_type[iiss$equipment_name == "MIUW"] <- "patrol and coastal combatants"
iiss$equipment_type[iiss$equipment_name == "FS" |
                      iiss$equipment_name == "FSG"] <- "patrol and coastal combatants"
iiss$equipment_type[iiss$equipment_name == "PCI"] <- "patrol and coastal combatants"

iiss$equipment_subname[iiss$equipment_type == "patrol and coastal combatants" &
                         iiss$equipment_subname %in% c("(USadmirable)",
                                                       "(USAdmirable)",
                                                       "ALmiranteDidiezBurgos(ex-USBalsam)",
                                                       "armoured",
                                                       "Armoured",
                                                       "ASW",
                                                       "Cambiaso(USCahoes)",
                                                       "coastguard",
                                                       "corvettes",
                                                       "ex-US",
                                                       "FAC",
                                                       "Irigoyen",
                                                       "LSM",
                                                       "MissileCraft",
                                                       "MOD",
                                                       "patrolboats",
                                                       "patrolcraft",
                                                       "PCI",
                                                       "river",
                                                       "riverine",
                                                       "riverpatrolcraft",
                                                       "ShortSkyvan",
                                                       "swiftships",
                                                       "inshore")] <- NA

iiss$equipment_subname[iiss$equipment_type == "patrol and coastal combatants" &
                         iiss$equipment_subname %in% c("(buoytenders)",
                                                       "buoytenders")] <- "buoy tenders"

```

#### Equipment_subtype
Fix incorrect columns that should have equipment_subtype = TBD
```{r}
# Unit_name

# Equipment_subname
iiss$equipment_subtype[iiss$equipment_subtype == "176mm gun"] <- "patrol craft"
iiss$equipment_subtype[iiss$equipment_subtype == "coastguard" |
                         iiss$equipment_subtype == "FAC(G)" |
                         iiss$equipment_subtype == "FAC(gun)" |
                         iiss$equipment_subtype == "FAC(M)" |
                         iiss$equipment_subtype == "FAC(T)"] <- NA

iiss$equipment_name[iiss$unit_name == "gun/radar picket"] <- "radar pickets"
iiss$equipment_type[iiss$equipment_name == "radar pickets"] <- "patrol and coastal combatants"

iiss$equipment_name[iiss$equipment_subtype == "radar pickets"] <- "radar pickets"
iiss$equipment_subtype[iiss$equipment_subtype == "radar pickets"] <- NA

# Equipment_name

# Equipment_subtype
iiss$equipment_subtype[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_subtype == "landing craft"] <- NA

# Equipment_type
iiss$equipment_type[iiss$equipment_subtype %in% c("corvettes",
                                                  "submarine chaser")] <- "patrol and coastal combatants"

iiss$equipment_subtype[iiss$equipment_subtype == "river patrol"] <- "riverine"
iiss$equipment_subtype[iiss$equipment_subtype %in% c("corvettes",
                                                     "corvette")] <- "missile craft"

iiss$equipment_name[iiss$equipment_subtype %in% c("MISC",
                                                     "misc boats/craft")] <- "MISC"
iiss$equipment_subtype[iiss$equipment_subtype %in% c("MISC",
                                                     "misc boats/craft")] <- NA

iiss$equipment_subtype[iiss$equipment_subtype %in% c("coastal escort",
                                                     "corvettes",
                                                     "fast gunboats",
                                                     "ice patrol",
                                                     "large",
                                                     "mine countermeasures",
                                                     "monitor",
                                                     "small",
                                                     "patrol boats",
                                                     "patrol craft, large",
                                                     "patrol vessel",
                                                     "small",
                                                     "submarine chaser",
                                                     "submarine chasers",
                                                     "support")] <- NA

```

#### Equipment_type

Fix incorrect unit_name that should have equipment_type = equipment_type
```{r}

```

Fix incorrect equipment_subname that should have equipment_type = equipment_type
```{r}
# Convert to NA 
iiss$equipment_subname[iiss$equipment_type == "patrol and coastal combatants" &
                         iiss$equipment_subname == "IR/SARH"] <- NA
iiss$equipment_subname[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_name == "PCI" &
                      iiss$equipment_subname == "Koper" &
                      iiss$unit_name == "PCI"] <- NA
iiss$equipment_subname[iiss$equipment_type == "patrol and coastal combatants" &
                         iiss$equipment_subname == "1.0"] <- NA
iiss$equipment_subname[iiss$equipment_type == "patrol and coastal combatants" &
                         iiss$equipment_name == "PCI" &
                      iiss$equipment_subname == "PCI"] <- NA
iiss$equipment_subname[iiss$equipment_type == "patrol and coastal combatants" &
                        iiss$equipment_subtype == "MISC" &
                        iiss$equipment_subname == "miscboats/craft"] <- NA
iiss$equipment_subname[iiss$equipment_type == "patrol and coastal combatants" &
                         iiss$equipment_subtype == "riverine" &
                         iiss$equipment_subname == "river"] <- NA
iiss$equipment_subname[iiss$equipment_type == "patrol and coastal combatants" &
                         (iiss$equipment_subname == "27mm" |
                            iiss$equipment_subname == "32mm" |
                            iiss$equipment_subname == "6.0" |
                            iiss$equipment_subname == "76mm")] <- NA
iiss$equipment_subname[iiss$equipment_type == "patrol and coastal combatants" & 
                         iiss$equipment_subname == "RL"] <- NA
iiss$equipment_subname[iiss$equipment_type == "patrol and coastal combatants" & 
                         iiss$equipment_subtype == "corvettes" & 
                         iiss$equipment_subname == "corvettes"] <- NA
```

Fix incorrect equipment_name that should have equipment_type = equipment_type
```{r}
# Convert to PCR
iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_subtype == "PCR"] <- "PCR"
iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                         iiss$equipment_subtype == "riverine" &
                         iiss$equipment_name == "Riverine"] <- "PCR"
iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      is.na(iiss$equipment_name) &
                      iiss$unit_name %in% c("PCR", "Piyavka", "Vosh", "Yaz")] <- "PCR"
iiss$equipment_name[iiss$equipment_name == "RIVER PATROL CRAFT"|
                      iiss$equipment_name == "riverine"] <- "PCR"
iiss$equipment_subtype[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_name == "PCR"] <- NA

# Convert to PBR
iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_subtype == "PBR"] <- "PBR"
iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      is.na(iiss$equipment_name) &
                      iiss$unit_name %in% c("Shmel", "US PBR")] <- "PBR"

# Convert to PCI
iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_name == "BASE" &
                      iiss$equipment_subname == "Koper" &
                      iiss$unit_name == "PCI"] <- "PCI"
iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      (iiss$equipment_name == "PC1<" |
                         iiss$equipment_name == "PCI<")] <- "PCI"
iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_subname == "PCI"] <- "PCI"
iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_name == "PCI-10"] <- "PCI"
iiss$equipment_subtype[iiss$equipment_type == "patrol and coastal combatants" &
                         iiss$equipment_subtype == "inshore" &
                         iiss$equipment_name == "Inshore"] <- "PCI"
iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_name == "pci"] <- "PCI"
iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                         iiss$equipment_subtype == "inshore" &
                         iiss$equipment_name == "Inshore"] <- "PCI"
iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                         iiss$equipment_subtype == "inshore" &
                         iiss$equipment_name == "coastal"] <- "PCI"
iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      is.na(iiss$equipment_name) &
                      iiss$unit_name %in% c("ex-Sw Coast Guard PCI", "PCI<", "Sw Coast Guard PCI<", 
                                            "Independence/Sovereignty", "Kandor II", "Kano", "Kondor",
                                            "ex-GDR Kondor-I", "P1903", "SO-1", "Sov-SO1", "Svetlyak", 
                                            "T-43", "Yunnan", "Zhuk")] <- "PCI"
iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_subname == "PCI"] <- "PCI"

# Convert to PCF/PCI
iiss$equipment_name[iiss$equipment_name == "PCF and PCI"] <- "PCF/PCI"

# Convert to PBF
iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      is.na(iiss$equipment_name) &
                      iiss$unit_name %in% c("Sov Bogomol", "Stenka")] <- "PBF"

# Convert to PFI
iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      is.na(iiss$equipment_name) &
                      iiss$unit_name %in% c("Osa", "Osa-I", "Osa/Komar", "Dvora", 
                                            "ex-Sov Turya", "Sov Turya", "Tuima (Sov Osa-II)")] <- "PFI"
iiss$equipment_name[is.na(iiss$equipment_type) &
                      iiss$equipment_name == "other" &
                      iiss$unit_name %in% c("Dvora")] <- "PFI"

# Convert to PCO
iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_name == "pco"] <- "PCO"
iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_name == "PHSC"] <- "PCO"
iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                         is.na(iiss$equipment_name) &
                         iiss$unit_name %in% c("Krivak-III", "Kronshtadt", "T-58")] <- "PCO"

# Convert to PCC 
iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_name == "pCC"] <- "PCC"
iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_name == "PCD"] <- "PCC"
iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      is.na(iiss$equipment_name) &
                      iiss$unit_name %in% c("Turk")] <- "PCC"

# Convert to PCH
iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      is.na(iiss$equipment_name) &
                      iiss$unit_name %in% c("PCH")] <- "PCH"

# Convert to PCM
iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      is.na(iiss$equipment_name) &
                      iiss$unit_name %in% c("Pauk")] <- "PCM"

# Convert to PFM
iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_subtype == "missile craft" &
                         iiss$equipment_name == "SSM" & 
                      iiss$unit_name != "MM-38 Exocet"] <- "PFM"
iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_name == "PRC"] <- "PFM"

# Convert to PHT
iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      is.na(iiss$equipment_name) &
                      iiss$unit_name %in% c("Mukha", "Muravey")] <- "PHT"

# Convert to PB
iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_name == "OB"] <- "PB"
iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                         is.na(iiss$equipment_name) &
                         iiss$unit_name %in% c("Cabo Blanco (US Swift 65)", "CG27", "CG29", "Nisr", "Patra", "Shanghai II", "Swiftships",
                                               "Vosper 75")] <- "PB"

# Convert to MTB
iiss$equipment_name[iiss$equipment_type == "torpedo boat"] <- "MTB"

# Convert to FS
iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      is.na(iiss$equipment_name) &
                      iiss$unit_name %in% c("Grisha-II", "Grisha-III")] <- "FS"

# Convert to NA
iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      (iiss$equipment_subtype == "corvettes" |
                         iiss$equipment_name == "Corvettes")] <- NA

iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                         iiss$equipment_subtype == "inshore" &
                         (iiss$equipment_name == "patrol inshore" |
                            iiss$equipment_name == "patrol, coastal/inshore" |
                            iiss$equipment_name == "patrol, inshore")] <- NA
iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_subtype == "ice patrol" &
                         iiss$equipment_name == "ICE PATROL"] <- NA
iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_subtype == "missile craft" &
                      iiss$equipment_name == "missile craft"] <- NA
iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_subtype == "offshore" &
                      iiss$equipment_name == "patrol coastal"] <- NA
iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                         iiss$equipment_subtype == "MISC" &
                         (iiss$equipment_name == "MISC Boats/craft" |
                            iiss$equipment_name == "MISC BOATS/CRAFTS" |
                            iiss$equipment_name == "Misc Boats/Craft"|
                            iiss$equipment_name == "boats/craft" |
                            iiss$equipment_name == "misc boats/craft" |
                            iiss$equipment_name == "MISC")] <- NA
iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_subtype == "torpedo craft" &
                      iiss$equipment_name == "torpedo craft"] <- NA
iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                         iiss$equipment_subtype == "torpedo craft" &
                         iiss$equipment_name == "TOPPEDO"] <- NA
iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_subtype == "MISC" &
                         iiss$equipment_name == "marine"] <- NA
iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_name == "PCI" &
                      iiss$equipment_subname == "PCI"] <- NA
```

Fix incorrect equipment_subtype that should have equipment_type = equipment_type
```{r}
# Convert to misc boats/craft
iiss$equipment_subtype[iiss$equipment_type == "patrol and coastal combatants" &
                         (iiss$equipment_name == "MISC Boats/craft" |
                            iiss$equipment_name == "MISC BOATS/CRAFTS" |
                            iiss$equipment_name == "Misc Boats/Craft"|
                            iiss$equipment_name == "boats/craft" |
                            iiss$equipment_name == "misc boats/craft")] <- NA
iiss$equipment_subtype[iiss$equipment_type == "patrol and coastal combatants" &
                        iiss$equipment_subname == "misc boats/craft"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "patrol and coastal combatants" &
                         iiss$equipment_name == "marine"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "patrol and coastal combatants" &
                      is.na(iiss$equipment_name) &
                      iiss$unit_name %in% c("armed boats", "aux", "boat", "boats", "coverted civilian craft", "converted fishing boat",
                                            "coverted fishing boats", "fishing craft", "chartered", "hovercraft", "less than 100 tones",
                                            "other", "patrol craft", "ramped lighters", "tugs", "Tjeld", "Victoria")] <- NA
iiss$equipment_subtype[is.na(iiss$equipment_type) &
                         is.na(iiss$equipment_name) &
                         iiss$unit_name %in% c("hovercraft")] <- NA

iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                         (iiss$equipment_name == "MISC Boats/craft" |
                            iiss$equipment_name == "MISC BOATS/CRAFTS" |
                            iiss$equipment_name == "MISC BOATS/CRAFT" |
                            iiss$equipment_name == "Misc Boats/Craft"|
                            iiss$equipment_name == "boats/craft" |
                            iiss$equipment_name == "misc boats/craft")] <- "MISC"
iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                         iiss$equipment_name == "marine"] <- "MISC"
iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      is.na(iiss$equipment_name) &
                      iiss$unit_name %in% c("armed boats", "aux", "boat", "boats", "coverted civilian craft", "converted fishing boat",
                                            "coverted fishing boats", "fishing craft", "chartered", "hovercraft", "less than 100 tones",
                                            "other", "patrol craft", "ramped lighters", "tugs", "Tjeld", "Victoria")] <- "MISC"
iiss$equipment_subtype[is.na(iiss$equipment_type) &
                         is.na(iiss$equipment_name) &
                         iiss$unit_name %in% c("hovercraft")] <- "MISC"

# Convert to NA 
iiss$equipment_subtype[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_subtype == "PCR" &
                      iiss$equipment_name == "PCR"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "patrol and coastal combatants" &
                         iiss$equipment_subtype == "PBR" &
                         iiss$equipment_name == "PBR"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "patrol and coastal combatants" &
                         iiss$equipment_subtype == "missiles" &
                         iiss$equipment_name == "PCC"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "patrol and coastal combatants" & 
                         iiss$equipment_subtype == "PB" & 
                         iiss$equipment_name == "PB"] <- NA

# Convert to corvettes
iiss$equipment_subtype[iiss$equipment_type == "patrol and coastal combatants" &
                         iiss$equipment_name == "Corvettes"] <- "missile craft"

# Convert to inshore
iiss$equipment_subtype[iiss$equipment_type == "patrol and coastal combatants" &
                         (iiss$equipment_name == "patrol inshore" |
                            iiss$equipment_name == "patrol, coastal/inshore" |
                            iiss$equipment_name == "patrol, inshore" |
                            iiss$equipment_subtype == "Patrol, Inshore" |
                            iiss$equipment_subtype == "inshore patrol") |
                            iiss$equipment_type == "patrol, inshore" |
                            iiss$equipment_type == "patrol craft, inshore"] <- "inshore"
iiss$equipment_subtype[iiss$equipment_type == "patrol and coastal combatants" &
                         iiss$equipment_subtype == "patrol craft" &
                         iiss$equipment_name == "Inshore"] <- "inshore"
iiss$equipment_subtype[iiss$equipment_type == "patrol and coastal combatants" &
                         iiss$equipment_subtype == "PCI"] <- "inshore"
iiss$equipment_subtype[iiss$equipment_type == "patrol and coastal combatants" &
                         iiss$equipment_subtype == "patrol craft" &
                         iiss$equipment_name == "coastal"] <- "inshore"
iiss$equipment_subtype[iiss$equipment_type == "patrol and coastal combatants" &
                         iiss$equipment_name == "PCI"] <- "inshore"

# Convert to offshore
iiss$equipment_subtype[iiss$equipment_type == "patrol and coastal combatants" &
                         (iiss$equipment_name == "patrol coastal" |
                            iiss$equipment_subtype == "coastal patrol")] <- "offshore"

# Convert to ice patrol
iiss$equipment_subtype[iiss$equipment_type == "patrol and coastal combatants" &
                         iiss$equipment_name == "ICE PATROL"] <- NA

# Convert to missile craft
iiss$equipment_subtype[iiss$equipment_type == "patrol and coastal combatants" &
                         iiss$equipment_name == "missile craft"] <- "missile craft"
iiss$equipment_subtype[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_subtype == "Missile Craft"] <- "missile craft"
iiss$equipment_subtype[iiss$equipment_type == "patrol and coastal combatants" &
                         iiss$equipment_name == "SSM" & 
                         iiss$unit_name != "MM-38 Exocet"] <- "missile craft"
iiss$equipment_subtype[iiss$equipment_type == "patrol and coastal combatants" &
                      is.na(iiss$equipment_name) &
                      iiss$unit_name %in% c("HWT", "Kralj", "Storion")] <- "missile craft"

# Convert to torpedo craft
iiss$equipment_subtype[iiss$equipment_type == "patrol and coastal combatants" &
                         iiss$equipment_name == "torpedo craft"] <- "torpedo craft"
iiss$equipment_subtype[iiss$equipment_type == "patrol and coastal combatants" &
                         iiss$equipment_subtype == "Torpedo craft"] <- "torpedo craft"
iiss$equipment_subtype[iiss$equipment_type == "patrol and coastal combatants" &
                         (iiss$equipment_name == "TOPPEDO" |
                            iiss$equipment_subtype == "Torpedo Craft")] <- "torpedo craft"

# Convert to patrol craft
iiss$equipment_subtype[iiss$equipment_type == "patrol and coastal combatants" &
                         (iiss$equipment_subtype == "coastal defence" |
                            iiss$equipment_subtype == "Patrol craft")] <- "patrol craft"
iiss$equipment_subtype[iiss$equipment_type == "patrol and coastal combatants" & 
                         iiss$equipment_subtype == "patrol escorts"] <- "patrol craft"

# Convert to riverine
iiss$equipment_subtype[iiss$equipment_type == "patrol and coastal combatants" &
                         iiss$equipment_subname == "river"] <- "riverine"
iiss$equipment_subtype[iiss$equipment_type == "patrol and coastal combatants" &
                         iiss$equipment_subtype == "patrol craft" &
                         iiss$equipment_name == "Riverine"] <- "riverine"
iiss$equipment_subtype[iiss$equipment_type == "patrol and coastal combatants" &
                         iiss$equipment_name == "PBR"] <- "riverine"

# Convert to coastal
iiss$equipment_subtype[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_name == "PCC"] <- "coastal"
```

Fix incorrect equipment_type that should have equipment_type = equipment_type
```{r}
# MGB and MTB
iiss$equipment_type[iiss$equipment_name == "MGB"] <- "patrol and coastal combatants"
iiss$equipment_subtype[iiss$equipment_name == "MGB"] <- NA
iiss$equipment_type[iiss$equipment_type == "torpedo boat"] <- "patrol and coastal combatants"

# Assorted
iiss$equipment_type[iiss$equipment_type == "patrol, inshore"] <- "patrol and coastal combatants"

iiss$equipment_type[iiss$equipment_type == "patrol craft, inshore"] <- "patrol and coastal combatants"

iiss$equipment_type[iiss$equipment_type == "river and lake flotillas"] <- "patrol and coastal combatants"

# surface-to-surface missile launchers
iiss$equipment_type[iiss$equipment_type == "surface-to-surface missile launchers" &
                      iiss$equipment_name == "PCC"] <- "patrol and coastal combatants"

# NA
iiss$equipment_type[is.na(iiss$equipment_type) &
                         is.na(iiss$equipment_name) &
                         iiss$unit_name %in% c("hovercraft")] <- "patrol and coastal combatants"
iiss$equipment_type[is.na(iiss$equipment_type) &
                      (iiss$equipment_name == "AVN" |
                      iiss$equipment_name == "PC" |
                      iiss$equipment_name == "PCC" |
                      iiss$equipment_name == "PCI" |
                      iiss$equipment_name == "PCH" |
                      iiss$equipment_name == "PCO" |
                      iiss$equipment_name == "PCI-10" |
                        iiss$equipment_name == "TOPPEDO" |
                        iiss$equipment_name == "marine")] <- "patrol and coastal combatants"
iiss$equipment_type[is.na(iiss$equipment_type) &
                      (iiss$unit_name == "CG27" |
                         iiss$unit_name == "CG29" |
                         iiss$unit_name == "converted fishing boat" |
                         iiss$unit_name == "fishing craft" |
                         iiss$unit_name == "P1903" |
                         iiss$unit_name == "Patra" |
                         iiss$unit_name == "patrol craft" |
                         iiss$unit_name == "PCH" |
                         iiss$unit_name == "PCI<" |
                         iiss$unit_name == "Tjeld" |
                         iiss$unit_name == "Vosper 75" |
                         iiss$unit_name == "Dvora" |
                         iiss$unit_name == "Shimrit (US Flagstaff 2)")] <- "patrol and coastal combatants"

iiss$equipment_type[iiss$equipment_type == "patrol/ riverine"] <- "patrol and coastal combatants"

# MISC 
iiss$equipment_type[iiss$equipment_type == "MISC" |
                      iiss$equipment_type == "patrol vessels"] <- "patrol and coastal combatants"

# minor surface combatants
iiss$equipment_type[iiss$equipment_type == "minor surface combatants" &
                      iiss$equipment_name == "PCO"] <- "patrol and coastal combatants"

# principal surface combatants
iiss$equipment_type[iiss$equipment_type == "principal surface combatants" &
                      iiss$equipment_subtype == "missile craft"] <- "patrol and coastal combatants"
iiss$equipment_type[iiss$equipment_type == "principal surface combatants" &
                      iiss$equipment_subtype == "corvettes"] <- "patrol and coastal combatants"
iiss$equipment_type[iiss$equipment_type == "principal surface combatants" &
                      (iiss$equipment_name == "FAC" |
                         iiss$equipment_name == "FAC(G)" |
                         iiss$equipment_name == "FAC(M)")] <- "patrol and coastal combatants"

iiss$equipment_type[iiss$equipment_type == "principal surface combatants" &
                      iiss$equipment_name == "PCC"] <- "patrol and coastal combatants"
iiss$equipment_type[iiss$equipment_type == "principal surface combatants" &
                      iiss$equipment_name == "PBR"] <- "patrol and coastal combatants"
iiss$equipment_type[iiss$equipment_type == "principal surface combatants" &
                      iiss$equipment_name == "PCI"] <- "patrol and coastal combatants"
iiss$equipment_type[iiss$equipment_type == "principal surface combatants" &
                      iiss$equipment_name == "PCC"] <- "patrol and coastal combatants"
iiss$equipment_type[iiss$equipment_type == "principal surface combatants" &
                         iiss$equipment_subtype == "corvettes"] <- "patrol and coastal combatants"
iiss$equipment_type[iiss$equipment_type == "principal surface combatants" &
                         iiss$equipment_name == "PSO"] <- "patrol and coastal combatants"
iiss$equipment_type[iiss$equipment_type == "principal surface combatants" &
                         iiss$equipment_name == "PC"] <- "patrol and coastal combatants"
iiss$equipment_type[iiss$equipment_type == "artillery" &
                         iiss$equipment_name == "PC"] <- "patrol and coastal combatants"

# Amphibious
iiss$equipment_type[iiss$equipment_type == "amphibious" &
                      (iiss$equipment_name == "PCR" |
                         iiss$equipment_name == "PCC")] <- "patrol and coastal combatants"

iiss$equipment_type[iiss$equipment_type == "amphibious" &
                      (iiss$equipment_name == "TPT" |
                         iiss$equipment_name == "LCM/LCU") &
                      iiss$equipment_subname == "Tankers"] <- "patrol and coastal combatants"

iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants" &
                      (iiss$equipment_name == "TPT" |
                         iiss$equipment_name == "LCM/LCU") &
                      iiss$equipment_subname == "Tankers"] <- "TKR"

iiss$equipment_subname[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_name == "TKR" &
                      iiss$equipment_subname == "Tankers"] <- NA

# Air defence 
iiss$equipment_type[iiss$equipment_type == "air defence" &
                      iiss$equipment_subtype == "coastal defence" &
                      iiss$equipment_subname == "PCI"] <- "patrol and coastal combatants"
iiss$equipment_type[iiss$equipment_type == "air defence" &
                      iiss$equipment_name == "PCO"] <- "patrol and coastal combatants"
iiss$equipment_type[iiss$equipment_type == "air defence" &
                      iiss$equipment_subname == "PCI"] <- "patrol and coastal combatants"

# Aircraft
iiss$equipment_type[iiss$equipment_type == "aircraft" &
                      (iiss$equipment_name == "FAC" |
                         iiss$equipment_name == "FAC(T)")] <- "patrol and coastal combatants"

# craft
iiss$equipment_type[iiss$subservice == "coast guard" &
                      iiss$equipment_type == "craft"] <- "patrol and coastal combatants"

iiss$equipment_type[iiss$equipment_type == "coast guard"] <- "patrol and coastal combatants"

iiss$equipment_type[iiss$equipment_type == "fast attack craft"] <- "patrol and coastal combatants"
iiss$equipment_type[iiss$equipment_type == "fast attack craft (torpedo)"] <- "patrol and coastal combatants"
iiss$equipment_type[iiss$equipment_type == "fast attack craft (gun)"] <- "patrol and coastal combatants"

iiss$equipment_type[iiss$equipment_type == "hovercraft"] <- "patrol and coastal combatants"

# Helicopters
iiss$equipment_type[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "PCI"] <- "patrol and coastal combatants"
iiss$equipment_type[iiss$equipment_type == "helicopters" &
                      iiss$equipment_subname == "ASW"] <- "patrol and coastal combatants"

# Minor surface combatants
iiss$equipment_type[iiss$equipment_type == "Minor surface combatants" |
                      iiss$equipment_type == "minor surface combatants"] <- "patrol and coastal combatants"

# Gendarmerie royale
iiss$equipment_name[iiss$equipment_type == "gendarmerie royale" &
                      iiss$unit_name == "fast patrol boats"] <- "FAC"
iiss$equipment_type[iiss$equipment_type == "gendarmerie royale" &
                      iiss$unit_name == "fast patrol boats"] <- "patrol and coastal combatants"

# Mine warfare
iiss$equipment_name[iiss$equipment_type == "mine warfare" &
                      iiss$equipment_subtype == "FAC(G)"] <- "FAC(G)"
iiss$equipment_type[iiss$equipment_type == "mine warfare" &
                      iiss$equipment_subtype == "FAC(G)"] <- "patrol and coastal combatants"
iiss$equipment_type[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_type == "FAC(G)"] <- NA

iiss$equipment_name[iiss$equipment_type == "mine warfare" &
                      iiss$equipment_subtype == "FAC(gun)"] <- "FAC(gun)"
iiss$equipment_type[iiss$equipment_type == "mine warfare" &
                      iiss$equipment_subtype == "FAC(gun)"] <- "patrol and coastal combatants"
iiss$equipment_type[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_type == "FAC(gun)"] <- NA

iiss$equipment_name[iiss$equipment_type == "mine warfare" &
                      iiss$equipment_subtype == "FAC(M)"] <- "FAC(M)"
iiss$equipment_type[iiss$equipment_type == "mine warfare" &
                      iiss$equipment_subtype == "FAC(M)"] <- "patrol and coastal combatants"
iiss$equipment_type[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_type == "FAC(M)"] <- NA

iiss$equipment_name[iiss$equipment_type == "mine warfare" &
                      iiss$equipment_subtype == "FAC(T)"] <- "FAC(T)"
iiss$equipment_type[iiss$equipment_type == "mine warfare" &
                      iiss$equipment_subtype == "FAC(T)"] <- "patrol and coastal combatants"
iiss$equipment_type[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_type == "FAC(T)"] <- NA

iiss$equipment_subtype[iiss$equipment_type == "mine warfare" &
                      iiss$equipment_name == "PCR"] <- NA
iiss$equipment_type[iiss$equipment_type == "mine warfare" &
                      iiss$equipment_name == "PCR"] <- "patrol and coastal combatants"

iiss$equipment_name[iiss$equipment_type == "mine warfare" &
                      iiss$equipment_subtype == "MTB"] <- "MTB"
iiss$equipment_subtype[iiss$equipment_type == "mine warfare" &
                      iiss$equipment_subtype == "MTB"] <- NA
iiss$equipment_type[iiss$equipment_type == "mine warfare" &
                      iiss$equipment_name == "MTB"] <- "patrol and coastal combatants"

iiss$equipment_type[iiss$equipment_type == "mine warfare" &
                      iiss$equipment_name == "large"] <- "patrol and coastal combatants"

iiss$equipment_type[iiss$equipment_type == "mine warfare" &
                      iiss$equipment_name %in% c("MGM",
                                                 "PH")] <- "patrol and coastal combatants"

# Logistics
iiss$equipment_type[iiss$equipment_type == "logistics and support" &
                      (iiss$equipment_name == "FAC" |
                         iiss$equipment_name == "FAC(G)" |
                         iiss$equipment_name == "FAC(M)")] <- "patrol and coastal combatants"

iiss$equipment_type[iiss$equipment_type == "logistics and support" &
                      iiss$equipment_name %in% c("PC",
                                                 "PCO",
                                                 "PBC",
                                                 "SES PCI (trials)")] <- "patrol and coastal combatants"

# Maritime squadron
iiss$equipment_type[iiss$equipment_type == "maritime squadron"] <- "patrol and coastal combatants"

# Artillery 
iiss$equipment_type[iiss$equipment_type == "artillery" & 
                      iiss$equipment_name == "TOPPEDO"] <- "patrol and coastal combatants"
```

## Principal surface combatants

### Typos
Here we fix typos, which include spelling errors, capitalization errors, and any other formatting errors that affect merging or equipment similarity

#### Unit_name typos
```{r}

```

#### Equipment_subname typos
```{r}

```

#### Equipment_name typos
```{r}
iiss$equipment_name[iiss$equipment_name == "Frigate" |
                      iiss$equipment_name == "frigates"] <- "FF"
```

#### Equipment_subtype typos
```{r}
iiss$equipment_subtype[iiss$equipment_subtype == "corvette"] <- "corvettes"
iiss$equipment_subtype[iiss$equipment_subtype == "cruise"] <- "cruisers"
iiss$equipment_subtype[iiss$equipment_subtype == "destroyer"] <- "destroyers"
iiss$equipment_subtype[iiss$equipment_subtype == "frigate"] <- "frigates"
```

#### Equipment_type typos
```{r}
iiss$equipment_subtype[iiss$equipment_type == "frigate" &
                      iiss$equipment_subtype == "ASW"] <- "frigate"
iiss$equipment_subtype[iiss$equipment_type == "destroyer" &
                      iiss$equipment_subtype == "ASW"] <- "destroyer"

iiss$equipment_type[iiss$equipment_type == "carriers"] <- "principal surface combatants"
iiss$equipment_type[iiss$equipment_type == "command ships"] <- "principal surface combatants"
iiss$equipment_type[iiss$equipment_type == "cruiser"] <- "principal surface combatants"
iiss$equipment_type[iiss$equipment_type == "destroyer"] <- "principal surface combatants"
iiss$equipment_type[iiss$equipment_type == "destroyers"] <- "principal surface combatants"
iiss$equipment_type[iiss$equipment_type == "frigate"] <- "principal surface combatants"
iiss$equipment_type[iiss$equipment_type == "principal surface combantants"] <- "principal surface combatants"
iiss$equipment_type[iiss$equipment_type == "principle surface combatants"] <- "principal surface combatants"
iiss$equipment_type[iiss$equipment_type == "principal surface combantats"] <- "principal surface combatants"

iiss$equipment_type[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_name == "DD"] <- "principal surface combatants"

```

### Coding changes

#### Unit_name
Fix incorrect columns based on unit_name value
```{r}
# Unit_name
iiss$equipment_type[iiss$unit_name == "Avon"] <- "principal surface combatants"
iiss$equipment_name[iiss$unit_name == "Avon"] <- "FF"

# Equipment_subname

# Equipment_name

# Equipment_subtype

# Equipment_type

```

#### Equipment_subname
Fix incorrect columns that should have equipment_subname = TBD
```{r}
# Unit_name

# Equipment_subname
iiss$equipment_name[iiss$equipment_subname == "FF"] <- "FF"
iiss$equipment_type[iiss$equipment_subname == "FF"] <- "principal surface combatants"
iiss$equipment_subname[iiss$equipment_subname == "FF"] <- NA

# Equipment_name

# Equipment_subtype

# Equipment_type

```

#### Equipment_name
Fix incorrect columns that should have equipment_name = principal surface combatants
```{r}
# Unit_name
iiss$equipment_name[iiss$equipment_type == "ASW" &
                      (iiss$unit_name == "Alamgir" |
                         iiss$unit_name == "Alamgir (US Oliver Hazard Perry)" |
                         iiss$unit_name == "Babur")] <- "DD"

iiss$equipment_subtype[iiss$equipment_type == "DD" &
                      (iiss$unit_name == "Alamgir" |
                         iiss$unit_name == "Alamgir (US Oliver Hazard Perry)" |
                         iiss$unit_name == "Babur")] <- "destroyers"

iiss$equipment_subtype[iiss$unit_name == "Nigeria (Ex Neth)" &
                      (iiss$equipment_name == "ASW" |
                         iiss$equipment_name == "FFGHM")] <- "destroyers"

iiss$equipment_name[iiss$equipment_type == "principal surface combatants" &
                      iiss$equipment_name == "GW"] <- "DD"

# Equipment_subname
iiss$equipment_subname[iiss$equipment_name == "GDR"] <- NA

# Equipment_name
iiss$equipment_name[iiss$equipment_name == "GDR"] <- "PC"
iiss$equipment_name[iiss$equipment_type == "patrol and coastal combatants	" &
                      iiss$equipment_name == "TT"] <- "PCT"

iiss$equipment_type[iiss$equipment_type == "submarines" &
                       iiss$equipment_name == "DD"] <- "principal surface combatants"
iiss$equipment_subtype[iiss$equipment_type == "principal surface combatants" &
                       iiss$equipment_name == "DD"] <- "destroyers"

iiss$equipment_name[iiss$equipment_type == "principal surface combatants" &
                       iiss$equipment_subname == "SPT"] <- "DEG"

iiss$equipment_name[iiss$equipment_type == "principal surface combatants" &
                       iiss$unit_name == "F-30"] <- "FF"

iiss$equipment_name[iiss$equipment_type == "principal surface combatants" &
                       iiss$equipment_name == "TRG/SPT"] <- "TRG"

iiss$equipment_name[iiss$equipment_type == "principal surface combatants" &
                       iiss$equipment_name == "SP"] <- "SPT"
iiss$equipment_subname[iiss$equipment_type == "principal surface combatants" &
                       iiss$equipment_subname == "T"] <- NA

iiss$equipment_name[iiss$equipment_subtype == "frigates" &
                       iiss$equipment_name == "FRG"] <- "FF"

iiss$equipment_subname[iiss$equipment_type == "principal surface combatants" &
                         iiss$equipment_subtype == "aircraft carriers" &
                         iiss$equipment_name == "ASW"] <- "ASW"
iiss$equipment_name[iiss$equipment_type == "principal surface combatants" &
                         iiss$equipment_subtype == "aircraft carriers" &
                         iiss$equipment_name == "ASW"] <- "CV"

iiss$equipment_subname[iiss$equipment_type == "principal surface combatants" &
                         iiss$equipment_subtype == "frigates" &
                         iiss$equipment_name == "ASW"] <- "ASW"
iiss$equipment_name[iiss$equipment_type == "principal surface combatants" &
                         iiss$equipment_subtype == "frigates" &
                         iiss$equipment_name == "ASW"] <- "FF"

# Equipment_subtype
iiss$equipment_subtype[iiss$equipment_name == "FFH" |
                         iiss$equipment_name == "FFGHM"] <- "frigates"

# Equipment_type
iiss$equipment_type[iiss$unit_name == "destroyer escorts"] <- "principal surface combatants"
iiss$equipment_type[iiss$unit_name == "destroyer escorts (ex-US fast transports)."] <- "principal surface combatants"
iiss$equipment_type[iiss$unit_name == "destroyers/escorts"] <- "principal surface combatants"

```

#### Equipment_subtype
Fix incorrect columns that should have equipment_subtype = TBD
```{r}
# Unit_name
iiss$equipment_name[iiss$unit_name == "destroyer escorts"] <- "FFG"
iiss$equipment_name[iiss$unit_name == "destroyer escorts (ex-US fast transports)."] <- "FFG"
iiss$equipment_name[iiss$unit_name == "destroyers/escorts"] <- "FFG"

# Equipment_subname
iiss$equipment_name[iiss$equipment_subtype == "frigates" &
                      is.na(iiss$equipment_name)] <- "FFGHM"

iiss$equipment_subtype[iiss$equipment_subtype == "frigates" &
                      iiss$equipment_name == "FAC"] <- NA

iiss$equipment_subtype[iiss$unit_name == "Nigeria (Ex Neth)"] <- "frigates"
iiss$equipment_subtype[iiss$equipment_type == "principal surface combatants" &
                         iiss$unit_name == "PCG-1 with 2 x 4 RGM-84A"] <- "corvettes"

iiss$equipment_subtype[iiss$equipment_type == "principal surface combatants" &
                         iiss$equipment_name == "LCS"] <- "corvettes"

iiss$equipment_type[iiss$equipment_name == "FLG"] <- "principal surface combatants"
iiss$equipment_subtype[iiss$equipment_name == "FLG"] <- "frigates"

# Equipment_name

# Equipment_subtype
iiss$equipment_subtype[iiss$equipment_subtype == "additional awaiting refit"] <- "aircraft carriers"
iiss$equipment_subtype[iiss$equipment_subtype == "helicopter carriers"] <- "aircraft carriers"

# Equipment_type

```

#### Equipment_type

Fix incorrect unit_name that should have equipment_type = equipment_type
```{r}

```

Fix incorrect equipment_subname that should have equipment_type = equipment_type
```{r}
# Convert to cruisers
iiss$equipment_subname[iiss$equipment_type == "principal surface combatants" &
                         iiss$equipment_subname == "CRUISERS"] <- "cruisers"

# Convert to NA
iiss$equipment_subname[iiss$equipment_type == "principal surface combatants" &
                         (iiss$equipment_subname == "FF" |
                            iiss$equipment_subname == "FGA" |
                            iiss$equipment_subname == "trg")] <- NA
```

Fix incorrect equipment_name that should have equipment_type = equipment_type
```{r}
# Convert to DDG
iiss$equipment_name[iiss$equipment_type == "DDG"] <- "DDG"
iiss$equipment_subtype[iiss$equipment_name == "DDG"] <- "destroyers"
iiss$equipment_type[iiss$equipment_name == "DDG"] <- "principal surface combatants"

# Convert to FF
iiss$equipment_name[iiss$equipment_type == "principal surface combatants" &
                      is.na(iiss$equipment_name) &
                      iiss$unit_name %in% c("Petya III", "Uzhgorod (Petya II)")] <- "FF"

# Convert to FFHM
iiss$equipment_name[iiss$equipment_type == "principal surface combatants" &
                      is.na(iiss$equipment_name) &
                      iiss$unit_name %in% c("Hetman")] <- "FFHM"

# Convert to FS
iiss$equipment_name[iiss$equipment_type == "principal surface combatants" &
                      is.na(iiss$equipment_name) &
                      iiss$unit_name %in% c("Lutsk")] <- "FS"
```

Fix incorrect equipment_subtype that should have equipment_type = equipment_type
```{r}
# Convert to cruisers
iiss$equipment_subtype[iiss$equipment_type == "principal surface combatants" &
                         iiss$equipment_subtype == "CRUISERS"] <- "cruisers"

# Convert to corvettes
iiss$equipment_subtype[iiss$equipment_type == "principal surface combatants" &
                         is.na(iiss$equipment_name) &
                         iiss$unit_name %in% c("Lutka")] <- "corvettes"

# Convert to aircraft carriers
iiss$equipment_subtype[iiss$equipment_type == "principal surface combatants" &
                         iiss$equipment_subtype == "carriers"] <- "aircraft carriers"

# Convert to battleships
iiss$equipment_subtype[iiss$equipment_type == "principal surface combatants" &
                      iiss$equipment_subtype == "battleship"] <- "battleships"

# Convert to frigates
iiss$equipment_subtype[iiss$equipment_type == "frigates" |
                         iiss$equipment_type == "Frigates"] <- "frigates"
iiss$equipment_subtype[iiss$equipment_type == "principal surface combatants" &
                      is.na(iiss$equipment_name) &
                      iiss$unit_name %in% c("Petya III", "Uzhgorod (Petya II)")] <- "frigates"
iiss$equipment_subtype[iiss$equipment_type == "principal surface combatants" &
                         is.na(iiss$equipment_name) &
                         iiss$unit_name %in% c("Hetman")] <- "frigates"
iiss$equipment_subtype[iiss$equipment_type == "principal surface combatants" &
                         iiss$equipment_name == "FFHM"] <- "frigates"
iiss$equipment_subtype[iiss$equipment_type == "patrol and coastal combatants" &
                         iiss$equipment_name == "FF"] <- "frigates"

# Convert to offshore
iiss$equipment_subtype[iiss$equipment_type == "principal surface combatants" &
                      iiss$equipment_name == "PSO"] <- "offshore"

```

Fix incorrect equipment_type that should have equipment_type = equipment_type
```{r}
# Patrol and coastal combatants
iiss$equipment_type[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_name == "FSG" &
                      iiss$equipment_subname == "FF"] <- "principal surface combatants"
iiss$equipment_type[iiss$equipment_type == "patrol and coastal combatants" &
                      (iiss$equipment_name == "destroyers" |
                         iiss$equipment_name == "frigates")] <- "principal surface combatants"
iiss$equipment_type[iiss$equipment_type == "patrol and coastal combatants" &
                      (iiss$equipment_subtype == "frigates" |
                         iiss$equipment_subtype == "destroyers")] <- "principal surface combatants"
iiss$equipment_type[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_name == "DE"] <- "principal surface combatants"

# DDG
iiss$equipment_type[iiss$equipment_type == "DDG"] <- "principal surface combatants"

# Frigates
iiss$equipment_type[(iiss$equipment_type == "frigates" |
                       iiss$equipment_type == "Frigates") &
                      iiss$equipment_subtype == "frigates"] <- "principal surface combatants"

iiss$equipment_name[iiss$equipment_type == "escorts"] <- "FFG"
iiss$equipment_type[iiss$equipment_type == "escorts"] <- "principal surface combatants"

# Cruisers
iiss$equipment_type[iiss$equipment_type == "cruisers"] <- "principal surface combatants"

# NA
iiss$equipment_type[is.na(iiss$equipment_type) &
                      (iiss$equipment_subtype == "command ships")] <- "principal surface combatants"

iiss$equipment_subname[iiss$equipment_type == "principal surface combatants" &
                         iiss$equipment_subname %in% c("(USGearing)",
                                                       "(USLawrence)",
                                                       "ex-US",
                                                       "fast",
                                                       "Lynx",
                                                       "patrol")] <- NA
```

## Radars

### Typos
Here we fix typos, which include spelling errors, capitalization errors, and any other formatting errors that affect merging or equipment similarity

#### Unit_name typos
```{r}
iiss$unit_name[iiss$equipment_type == "radars" &
                 iiss$unit_name %in% c("AN/TPQ-36 Firefinder",
                                       "AN/TPQ-36 Firefinder (arty, mor)",
                                       "AN/TPQ-36 Firefinder (arty)")] <- "AN/TPQ-36 Firefinder"

iiss$unit_name[iiss$equipment_type == "radars" &
                 iiss$unit_name %in% c("AN/TPQ-37 Firefinder",
                                       "AN/TPQ-37 Firefinder (arty, mor)",
                                       "AN/TPQ-37 Firefinder (arty)")] <- "AN/TPQ-37 Firefinder"

iiss$unit_name[iiss$equipment_type == "radars" &
                 iiss$unit_name %in% c("AN/TPQ-53 (arty)")] <- "AN/TPQ-53"

iiss$unit_name[iiss$equipment_type == "radars" &
                 iiss$unit_name %in% c("Ballistic Missile Early Warning System (BMEWS)",
                                       "Ballistic Missile Early Warning System BMEWS",
                                       "BMEWS")] <- "Ballistic Missile Early Warning System (BMEWS)"

iiss$unit_name[iiss$equipment_type == "radars" &
                 iiss$unit_name %in% c("Big Fred",
                                       "Big Fred ((SNAR-10) veh, arty)",
                                       "Big Fred ((SNAR-10) veh, arty)",
                                       "Big Fred ((SNAR-10))",
                                       "Big Fred((SNAR-10) veh, arty)")] <- "Big Fred"

iiss$unit_name[iiss$equipment_type == "radars" &
                 iiss$unit_name %in% c("Blindfire",
                                       "blindfire")] <- "Blindfire"

iiss$unit_name[iiss$equipment_type == "radars" &
                 iiss$unit_name %in% c("Cadin/Pine Tree Line",
                                       "CADIN/Pinetree Line")] <- "Cadin/Pine Tree Line"

iiss$unit_name[iiss$equipment_type == "radars" &
                 iiss$unit_name == "coastal radar"] <- "coastal"

iiss$unit_name[iiss$equipment_type == "radars" &
                 iiss$unit_name %in% c("Cybeline",
                                       "Cymberline")] <- "Cymbeline"

iiss$unit_name[iiss$equipment_type == "radars" &
                 iiss$unit_name %in% c("DEW",
                                       "Distant Early Warning (DEW) Line")] <- "Distant Early Warning (DEW) Line"

iiss$unit_name[iiss$equipment_type == "radars" &
                 iiss$unit_name %in% c("Fan Song",
                                       "Fan Song (SA-2)",
                                       "Fan Song A to E (SA-2)")] <- "Fan Song"

iiss$unit_name[iiss$equipment_type == "radars" &
                 iiss$unit_name %in% c("Helios 2a (Creil)",
                                       "Helios-2a (Creil)")] <- "Helios-2A (Creil)"

iiss$unit_name[iiss$equipment_type == "radars" &
                 iiss$unit_name %in% c("GS-13",
                                       "GS-13 (arty)",
                                       "GS-13 (veh)",
                                       "GS-13 Long Eye")] <- "GS-13 Long Eye"

iiss$unit_name[iiss$equipment_type == "radars" &
                 iiss$unit_name %in% c("L219/200 PARK-1 (arty)",
                                       "L219/200 Park-1 (arty)")] <- "L219/200 PARK-1"

iiss$unit_name[iiss$equipment_type == "radars" &
                 iiss$unit_name %in% c("Long Range",
                                       "long range",
                                       "Long Range (range 200mm)")] <- "long-range"

iiss$unit_name[iiss$equipment_type == "radars" &
                 iiss$unit_name %in% c("Long Track",
                                       "Long Track (SA-4, SA-6)")] <- "Long Track"

iiss$unit_name[iiss$equipment_type == "radars" &
                 iiss$unit_name %in% c("Long Trough",
                                       "Long Trough ((SNAR-1) arty",
                                       "Long Trough ((SNAR-1) arty)",
                                       "Long Trough (SNAR-1)",
                                       "Long Trough (SNAR-1) (arty)")] <- "Long Trough (SNAR-1)"

iiss$unit_name[iiss$equipment_type == "radars" &
                 iiss$unit_name %in% c("Land Roll",
                                       "Land Roll (SA-8)")] <- "Land Roll"

iiss$unit_name[iiss$equipment_type == "radars" &
                 iiss$unit_name %in% c("Low Blow",
                                       "Low Blow (SA-3)")] <- "Low Blow"

iiss$unit_name[iiss$equipment_type == "radars" &
                 iiss$unit_name %in% c("M-113 A1GE Green ARcher",
                                       "M-113 A1GE Green Archer",
                                       "M-113 AIGE Green Archer",
                                       "M113 A1GE Green Archer",
                                       "M113A1GE Green Archer")] <- "M113 Green Archer"

iiss$unit_name[iiss$equipment_type == "radars" &
                 iiss$unit_name %in% c("MAMBA",
                                       "Mamba",
                                       "MAMBA (Arthur)")] <- "MAMBA"

iiss$unit_name[iiss$equipment_type == "radars" &
                 iiss$unit_name %in% c("Naval Ocean Surveillance System",
                                       "Naval Ocean Survillance System")] <- "Naval Ocean Surveillance System"

iiss$unit_name[iiss$equipment_type == "radars" &
                 iiss$unit_name %in% c("NAVSTAR Blick IIR/IIRM")] <- "NAVSTAR Block IIR/IIRM"

iiss$unit_name[iiss$equipment_type == "radars" &
                 iiss$unit_name %in% c("NAVSTAR Block 11/IIA")] <- "NAVSTAR Block II/IIA"

iiss$unit_name[iiss$equipment_type == "radars" &
                 iiss$unit_name %in% c("NAVSTAR Block I/11/IIA")] <- "NAVSTAR Block I/II/IIA"

iiss$unit_name[iiss$equipment_type == "radars" &
                 iiss$unit_name %in% c("P-12 Spoon Rest",
                                       "P-12 Spoon Rest (SA-2)")] <- "P-12 Spoon Rest"

iiss$unit_name[iiss$equipment_type == "radars" &
                 iiss$unit_name %in% c("P-15 Flat Face (SA-3, SA-6)",
                                       "P-15 Flat Face (SA-3)")] <- "P-15 Flat Face"

iiss$unit_name[iiss$equipment_type == "radars" &
                 iiss$unit_name %in% c("P-50 Bar Lock",
                                       "P-50 Bar Lock (SA-5)")] <- "P-50 Bar Lock"

iiss$unit_name[iiss$equipment_type == "radars" &
                 iiss$unit_name %in% c("Pat Hand",
                                       "Pat Hand (SA-4)")] <- "Pat Hand"

iiss$unit_name[iiss$equipment_type == "radars" &
                 iiss$unit_name %in% c("Pine Tree Line",
                                       "Pinetree Line")] <- " "

iiss$unit_name[iiss$equipment_type == "radars" &
                 iiss$unit_name %in% c("Pork Trough",
                                       "Pork Trough ((SNAR-2/-6) arty)",
                                       "Pork Trough ((SNAR-2/-6) veh, arty)",
                                       "Pork Trough (SNAR-2/-6, veh, arty)",
                                       "Pork Trough((SNAR-2/-6) veh, arty)")] <- "Pork Trough"

iiss$unit_name[iiss$equipment_type == "radars" &
                 iiss$unit_name %in% c("RASIT",
                                       "RASIT (veh, arty)",
                                       "RASIT (veh,arty)",
                                       "RASIT-B/-E")] <- "RASIT"

iiss$unit_name[iiss$equipment_type == "radars" &
                 iiss$unit_name %in% c("receiving sites",
                                       "recieving sites",
                                       "strategic receiving sites")] <- "receiving sites"

iiss$unit_name[iiss$equipment_type == "radars" &
                 iiss$unit_name %in% c("short range",
                                       "Short Range",
                                       "Short Range (range 80 nm)")] <- "short-range"

iiss$unit_name[iiss$equipment_type == "radars" &
                 iiss$unit_name %in% c("Side Net",
                                       "Side Net (SA-2, SA-3, SA-5)")] <- "Side Net"

iiss$unit_name[iiss$equipment_type == "radars" &
                 iiss$unit_name %in% c("Small Fred/Small Yawn",
                                       "Small Fred/ Small Yawn",
                                       "Small Fred/Small Yawn (arty)",
                                       "Small Fred/ Small Yawn (veh, arty)",
                                       "small Fred/Small Yawn (veh, arty)",
                                       "Small Fred/Small Yawn (veh, arty)")] <- "Small Fred/Small Yawn"

iiss$unit_name[iiss$equipment_type == "radars" &
                 iiss$unit_name %in% c("Small Fred/Big Fred (veh, arty)	",
                                       "Small Fred/Big Fred (veh, arty)")] <- "Small Fred/Big Fred"

iiss$unit_name[iiss$equipment_type == "radars" &
                 iiss$unit_name %in% c("SNAR-10",
                                       "SNAR-10 Big Fred",
                                       "SNAR-10 Big Red")] <- "SNAR-10 Big Fred"

iiss$unit_name[iiss$equipment_type == "radars" &
                 iiss$unit_name %in% c("Squat Eye",
                                       "Squat Eye (SA-3)")] <- "Squat Eye"

iiss$unit_name[iiss$equipment_type == "radars" &
                 iiss$unit_name %in% c("Squint Eye",
                                       "Squint Eye (SA-3)")] <- "Squint Eye"

iiss$unit_name[iiss$equipment_type == "radars" &
                 iiss$unit_name %in% c("STENTOR",
                                       "Stentor")] <- "STENTOR"

iiss$unit_name[iiss$equipment_type == "radars" &
                 iiss$unit_name %in% c("Straight Flush",
                                       "Straight Flush (SA-6)")] <- "Straight Flush"

iiss$unit_name[iiss$equipment_type == "radars" &
                 iiss$unit_name %in% c("stragetic receiving sites")] <- "strategic receiving sites"

iiss$unit_name[iiss$equipment_type == "radars" &
                 iiss$unit_name %in% c("stragetic transmitting stations")] <- "strategic transmitting stations"

iiss$unit_name[iiss$equipment_type == "radars" &
                 iiss$unit_name %in% c("STRIDA",
                                       "STRIDA (control)")] <- "STRIDA"

iiss$unit_name[iiss$equipment_type == "radars" &
                 iiss$unit_name %in% c("Thin Skin",
                                       "Thin Skin  (SA-4, SA-6)")] <- "Thin Skin"

iiss$unit_name[iiss$equipment_type == "radars" &
                 iiss$unit_name %in% c("transmitting stations",
                                       "strategic transmitting stations")] <- "transmitting stations"

iiss$unit_name[iiss$equipment_type == "radars" &
                 iiss$unit_name == "unknown"] <- NA
```

#### Equipment_subname typos
```{r}
iiss$equipment_subname[iiss$equipment_subname == "RADAR"] <- "RADARS"
iiss$equipment_subname[iiss$equipment_subname == "Satellites"] <- "satellites"
iiss$equipment_subname[iiss$equipment_subname == "targetacquisitionandtrackingbyphased-array"] <- "target acquisition and tracking by phased-array"

iiss$equipment_subname[iiss$unit_name == "highaltitude"] <- "high altitude"
iiss$equipment_subname[iiss$equipment_subname == "highaltitude"] <- "high altitude"

iiss$equipment_subname[iiss$equipment_type == "radars" &
                 iiss$equipment_subname %in% c("landbasedsystems",
                                               "land",
                                               "land based systems",
                                               "land-basedsystems")] <- NA

iiss$equipment_subname[iiss$equipment_subname == "earlywarningbyphased-array"] <- "early warning by phased-array"

iiss$equipment_subname[iiss$equipment_type == "radars" &
                 iiss$equipment_subname == "targetacquisitionandtrackingbyphased-array"] <- "target acquisition and tracking by phased-array"

```

#### Equipment_name typos
```{r}
iiss$equipment_name[iiss$equipment_name == "ABM RADARS"] <- "ABM"

iiss$equipment_name[iiss$equipment_name == "airborne"] <- "AB"

iiss$equipment_name[iiss$equipment_type == "radars" &
                      iiss$equipment_name == "AD RADER"] <- "air defence"
iiss$equipment_name[iiss$equipment_type == "radars" &
                      iiss$equipment_name == "AD RADAR"] <- "air defence"

iiss$equipment_name[iiss$equipment_name == "COMMUNICATIONS" |
                      iiss$equipment_name == "communications"] <- "COMMS"

iiss$equipment_name[iiss$equipment_type == "radars" &
                 iiss$equipment_name %in% c("DEW",
                                       "Distant Early Warning (DEW) Line")] <- "Distant Early Warning (DEW) Line"

iiss$equipment_name[iiss$equipment_name == "ground radar"] <- "ground"

iiss$equipment_name[iiss$equipment_name %in% c("EARLY WARNING",
                                               "early warning")] <- "EW"

iiss$equipment_name[iiss$equipment_name == "Imagery"] <- "imagery"

iiss$equipment_name[iiss$equipment_name == "Infrared/TV"] <- "infrared/TV"

iiss$equipment_name[iiss$equipment_name == "North Warning System"] <- "north warning system"

iiss$equipment_name[iiss$equipment_name == "OBSERVATION"] <- "OBS"

iiss$equipment_name[iiss$equipment_name == "perimeter acquisition radar attack characterization system (PARCS)"] <- "PARCS"
iiss$equipment_name[iiss$equipment_name == "solid state phased array radar system (SSPARS)"] <- "SSPARS"

iiss$equipment_name[iiss$equipment_name == "RADAR"] <- NA

iiss$equipment_name[iiss$equipment_type == "radars" &
                      iiss$equipment_name == "SAM"] <- "SAM-associated short-range"

iiss$equipment_name[iiss$equipment_name == "Satellites"] <- "satellites"

iiss$equipment_name[iiss$equipment_name == "search, surveillance, target aquisition"] <- "search, surveillance, target acquisition"

iiss$equipment_name[iiss$equipment_name %in% c("SPACE",
                                               "space",
                                               "Space Based Systems",
                                               "space surveillance")] <- "space-based systems"

iiss$equipment_name[iiss$equipment_name %in% c("Land",
                                               "land",
                                               "LAND")] <- "land-based systems"

iiss$equipment_name[iiss$equipment_name == "stragetic"] <- "strategic"

iiss$equipment_name[iiss$equipment_name == "tactical"] <- "TAC"

```

#### Equipment_subtype typos
```{r}
iiss$equipment_subtype[iiss$equipment_subtype == "radar"] <- NA
iiss$equipment_subtype[iiss$equipment_subtype == "SERV" |
                         iiss$equipment_subtype == "SURV" |
                         iiss$equipment_subtype == "survey"] <- "surv"
iiss$equipment_subtype[iiss$equipment_subtype == "Surv"] <- "surv"
iiss$equipment_subtype[iiss$equipment_subtype == "surveillance"] <- "surv"
iiss$equipment_subtype[iiss$equipment_subtype == "surveillance and control"] <- "surv"
iiss$equipment_subtype[iiss$equipment_subtype == "sensors"] <- "space-based systems"
iiss$equipment_subtype[iiss$equipment_subtype == "SPACE BASED SYSTEMS"] <- "space-based systems"
iiss$equipment_subtype[iiss$equipment_subtype == "SYSTEMS"] <- NA
iiss$equipment_subtype[iiss$equipment_name == "aegis cruisers and destroyers"] <- "aegis cruisers and destroyers"

iiss$equipment_subtype[iiss$equipment_type == "radars" &
                         iiss$equipment_subtype %in% c("land based systems",
                                                       "land",
                                                       "LAND")] <- "land-based systems"
iiss$equipment_subtype[iiss$equipment_subtype == "space based systems"] <- "space-based systems"
```

#### Equipment_type typos
```{r}
iiss$equipment_type[iiss$equipment_type == "PODS"] <- "strategic missile defence"
iiss$equipment_type[iiss$equipment_type == "missile & strategic" |
                      iiss$equipment_type == "strategic defenses - missile defenses" |
                      iiss$equipment_type == "missile defence"] <- "strategic missile defence"
iiss$equipment_type[iiss$equipment_type == "ICBM/SLBM launch-detection capability"] <- "strategic missile defence"
iiss$equipment_type[iiss$equipment_type == "civil defence"] <- "strategic missile defence"
iiss$equipment_type[iiss$equipment_type == "strategic missile defence"] <- "radars"
iiss$equipment_type[iiss$equipment_type == "surveillance"] <- "radars"
iiss$equipment_type[iiss$equipment_type == "radar"] <- "radars"
```

### Coding changes

#### Unit_name
Fix incorrect columns based on unit_name value
```{r}
# Unit_name
iiss$equipment_type[iiss$unit_name == "STRIDA II"] <- "radars"
iiss$equipment_subtype[iiss$unit_name == "STRIDA II"] <- NA
iiss$equipment_name[iiss$unit_name == "STRIDA II"] <- "CONTROL"

iiss$unit_name[iiss$equipment_type == "air defence" &
                 iiss$equipment_name == "radar" &
                 iiss$unit_name == "sqns"] <- NA

# Equipment_subname
iiss$equipment_subname[iiss$unit_name == "RATRAS"] <- NA

# Equipment_name

# Equipment_subtype
iiss$equipment_subtype[iiss$unit_name == "Helios 2a (Creil)"] <- "space-based systems"

# Equipment_type
iiss$equipment_type[iiss$unit_name == "Helios 2a (Creil)" |
                      iiss$unit_name == "Helios"] <- "radars"	

```

#### Equipment_subname
Fix incorrect columns that should have equipment_subname = TBD
```{r}
# Unit_name

# Equipment_subname
iiss$equipment_subname[iiss$equipment_subname == "longrange"] <- "long-range"
iiss$equipment_subname[iiss$equipment_subname == "shortrange"] <- "short-range"

# Equipment_name
iiss$equipment_name[iiss$equipment_subname == "ground-based interceptors"] <- "ground-based interceptors"
iiss$equipment_name[iiss$equipment_subname == "Imagery 1" |
                      iiss$equipment_subname == "Imagery1"] <- "Imagery 1"
iiss$equipment_name[iiss$equipment_subname == "Satellites 2" |
                      iiss$equipment_subname == "Satellites2"] <- "Satellites 2"
iiss$equipment_name[iiss$equipment_subname == "stragetic"] <- "strategic"

# Equipment_subtype

# Equipment_type

```

#### Equipment_name
Fix incorrect columns that should have equipment_name = TBD
```{r}
# Unit_name
iiss$equipment_name[iiss$unit_name == "Distant Early Warning (DEW) Line"] <- "early warning"
iiss$equipment_subtype[iiss$unit_name == "Distant Early Warning (DEW) Line"] <- "space-based systems"

iiss$equipment_subname[iiss$unit_name == "long-range"] <- "long-range"
iiss$unit_name[iiss$unit_name == "long-range"] <- NA

iiss$equipment_subname[iiss$unit_name == "long-range early warning"] <- "long-range early warning"
iiss$unit_name[iiss$unit_name == "long-range early warning"] <- NA

iiss$equipment_subname[iiss$unit_name == "long-range phased-array system"] <- "long-range phased-array system"
iiss$unit_name[iiss$unit_name == "long-range phased-array system"] <- NA

iiss$unit_name[iiss$unit_name == "OTH-B"] <- NA

iiss$equipment_subtype[iiss$unit_name == "DSP"] <- "space-based systems"
iiss$equipment_name[iiss$unit_name == "DSP"] <- "early warning"
iiss$equipment_subname[iiss$unit_name == "DSP"] <- NA

iiss$equipment_subtype[iiss$unit_name == "Helios-2A (Creil)"] <- "space-based systems"
iiss$equipment_name[iiss$unit_name == "Helios-2A (Creil)"] <- "imagery"
iiss$equipment_subname[iiss$unit_name == "Helios-2A (Creil)"] <- NA

iiss$equipment_subtype[iiss$equipment_name == "space-based systems"] <- "space-based systems"
iiss$equipment_name[iiss$equipment_name == "space-based systems"] <- NA

iiss$equipment_name[iiss$unit_name == "TPS-43G"] <- "TPS-43G"
iiss$unit_name[iiss$equipment_name == "TPS-43G"] <- "Type-514"

iiss$equipment_name[iiss$unit_name == "Cadin/Pine Tree Line"] <- "early warning"
iiss$equipment_subname[iiss$unit_name == "Cadin/Pine Tree Line"] <- "long-range"

iiss$equipment_name[iiss$unit_name %in% c("Cat House",
                                          "Dog House")] <- "ABM"

iiss$equipment_name[iiss$unit_name == "AN/FPS-117"] <- "north warning system"

iiss$equipment_name[iiss$unit_name %in% c("Fan Song",
                                          "Low Blow",
                                          "Pork Trough",
                                          "Straight Flush",
                                          "Yo-Yo (SA-1)")] <- "fire control"

iiss$equipment_name[iiss$unit_name == "KH-11"] <- "ISR"

iiss$equipment_name[iiss$unit_name %in% c("AN/TPS-43",
                                          "Big Fred",
                                          "Goldhaube",
                                          "GS-13 Long Eye",
                                          "P-12 Spoon Rest",
                                          "Small Fred/Small Yawn",
                                          "Squint Eye",
                                          "Tall King")] <- "early warning"

iiss$equipment_name[iiss$unit_name %in% c("Long Track",
                                          "Long Trough (SNAR-1)",
                                          "P-15 Flat Face",
                                          "RATAC",
                                          "Squat Eye")] <- "search, surveillance, target acquisition"

iiss$equipment_name[iiss$unit_name %in% c("RASIT",
                                          "STENTOR")] <- "SURV"

# Equipment_subname
iiss$equipment_subname[iiss$equipment_name == "Imagery 1"] <- NA
iiss$equipment_subname[iiss$equipment_name == "Satellites 2"] <- NA

iiss$equipment_name[iiss$equipment_subname == "SURV"] <- "SURV"
iiss$equipment_subname[iiss$equipment_subname == "SURV"] <- NA

# Equipment_name
iiss$equipment_name[iiss$equipment_name == "RADER" |
                      iiss$equipment_name == "RADERS" ] <- "RADARS"

iiss$equipment_subname[iiss$equipment_type == "radars" &
                      iiss$equipment_name == "TOWED"] <- "TOWED"
iiss$equipment_name[iiss$equipment_type == "radars" &
                      iiss$equipment_name == "TOWED"] <- NA

iiss$equipment_subtype[iiss$equipment_name == "north warning system"] <- "space-based systems"

iiss$equipment_name[iiss$equipment_type == "radars" &
                      is.na(iiss$equipment_name) &
                      iiss$equipment_subname == "high altitude"] <- "high altitude"
iiss$equipment_subname[iiss$equipment_type == "radars" &
                      iiss$equipment_name == "high altitude" &
                      iiss$equipment_subname == "high altitude"] <- NA

iiss$equipment_name[iiss$equipment_type == "radars" &
                      is.na(iiss$equipment_name) &
                      iiss$equipment_subname == "intermediate-range"] <- "intermediate-range"
iiss$equipment_subname[iiss$equipment_type == "radars" &
                      iiss$equipment_name == "intermediate-range" &
                      iiss$equipment_subname == "intermediate-range"] <- NA

iiss$equipment_name[iiss$equipment_type == "radars" &
                      is.na(iiss$equipment_name) &
                      iiss$equipment_subname == "strategic"] <- "strategic"
iiss$equipment_subname[iiss$equipment_type == "radars" &
                      iiss$equipment_name == "strategic" &
                      iiss$equipment_subname == "strategic"] <- NA

iiss$equipment_name[iiss$equipment_type == "radars" &
                      is.na(iiss$equipment_name) &
                      iiss$equipment_subname == "tactical"] <- "TAC"
iiss$equipment_subname[iiss$equipment_type == "radars" &
                      iiss$equipment_name == "TAC" &
                      iiss$equipment_subname == "tactical"] <- NA

iiss$equipment_name[iiss$equipment_type == "radars" &
                      is.na(iiss$equipment_name) &
                      iiss$equipment_subname == "anti-ICBM"] <- "anti-ICBM"
iiss$equipment_subname[iiss$equipment_type == "radars" &
                      iiss$equipment_name == "anti-ICBM" &
                      iiss$equipment_subname == "anti-ICBM"] <- NA

iiss$equipment_name[iiss$equipment_type == "radars" &
                      is.na(iiss$equipment_name) &
                      iiss$equipment_subname == "anti-SLBM"] <- "anti-SLBM"
iiss$equipment_subname[iiss$equipment_type == "radars" &
                      iiss$equipment_name == "anti-SLBM" &
                      iiss$equipment_subname == "anti-SLBM"] <- NA

# Equipment_subtype
iiss$equipment_subtype[iiss$equipment_name == "SPACE BASED SYSTEMS" &
                       iiss$equipment_subname == "Imagery1"] <- "space-based systems"
iiss$equipment_subtype[iiss$equipment_name == "SPACE BASED SYSTEMS" &
                         iiss$equipment_subname == "Satellites2"] <- "space-based systems"
# Equipment_type

```

#### Equipment_subtype
Fix incorrect columns that should have equipment_subtype = TBD
```{r}
# Unit_name

# Equipment_subname
iiss$equipment_subtype[iiss$unit_name == "RASIT (veh,arty)"] <- "land-based systems"

# Equipment_name
iiss$equipment_name[iiss$equipment_subtype == "space-based systems" &
                         iiss$equipment_name == "SPACE BASED SYSTEMS" &
                         iiss$equipment_subname == "Imagery1"] <- "Imagery 1"
iiss$equipment_name[iiss$equipment_subtype == "space-based systems" &
                      iiss$equipment_name == "Imagery 1" &
                      iiss$equipment_subname == "Imagery 1"] <- NA
iiss$equipment_name[iiss$equipment_subtype == "space-based systems" &
                      iiss$equipment_name == "SPACE-BASED SYSTEMS" &
                      iiss$equipment_subname == "Satellites2"] <- "Satellites 2"
iiss$equipment_name[iiss$equipment_subtype == "space-based systems" &
                      iiss$equipment_name == "Satellites 2" &
                      iiss$equipment_subname == "Satellites2"] <- NA

iiss$equipment_subtype[iiss$equipment_name == "land-based systems"] <- "land-based systems"
iiss$equipment_name[iiss$equipment_name == "land-based systems"] <- NA

# Equipment_subtype

# Equipment_type

```

#### Equipment_type

Fix incorrect unit_name that should have equipment_type = equipment_type
```{r}
iiss$equipment_type[iiss$unit_name == "RASIT (veh,arty)"] <- "radars"

iiss$equipment_type[iiss$unit_name == "THAAD"] <- "radars"

iiss$equipment_type[iiss$unit_name == "Long Track"] <- NA

```

Fix incorrect equipment_subname that should have equipment_type = equipment_type
```{r}
# Convert to land
iiss$equipment_subtype[iiss$equipment_type == "radars" &
                         iiss$equipment_subtype == "land"] <- "land-based systems"
iiss$equipment_subtype[iiss$equipment_type == "radars" &
                         iiss$equipment_subtype == "LAND"] <- "land-based systems"
iiss$equipment_subtype[iiss$equipment_type == "radars" &
                         iiss$equipment_name == "land"] <- "land-based systems"
iiss$equipment_subtype[iiss$equipment_type == "radars" &
                         iiss$equipment_name == "ground based electro optical deep space surveillance system (GEODSS)"] <- "land-based systems"
iiss$equipment_subtype[iiss$equipment_type == "radars" &
                         iiss$unit_name == "TPQ-37 Firefinder"] <- "land-based systems"
iiss$equipment_subtype[iiss$equipment_type == "radars" &
                         iiss$unit_name == "AN-TPQ-36/-37"] <- "land-based systems"
iiss$equipment_subtype[iiss$equipment_type == "radars" &
                         iiss$equipment_name == "RECCE"] <- "land-based systems"
iiss$equipment_subtype[iiss$equipment_type == "radars" &
                         iiss$equipment_name == "SYSTEMS"] <- "land-based systems"
iiss$equipment_subtype[iiss$equipment_type == "radars" &
                         iiss$equipment_name == "AN/TPS-43"] <- "land-based systems"
iiss$equipment_subtype[iiss$equipment_type == "radars" &
                         iiss$equipment_name == "BPS-1000"] <- "land-based systems"
iiss$equipment_subtype[iiss$equipment_type == "radars" &
                         (iiss$unit_name == "FPS-117" |
                            iiss$unit_name == "Goldhaube" |
                            iiss$unit_name == "Land" |
                            iiss$unit_name == "LUR" |
                            iiss$unit_name == "MSTAR" |
                            iiss$unit_name == "NBR" |
                            iiss$unit_name == "PRV-11"|
                            iiss$unit_name == "PSZNR-5B"|
                            iiss$unit_name == "radar bde" |
                            iiss$unit_name == "S-600"|
                            iiss$unit_name == "SABER M60"|
                            iiss$unit_name == "sites"|
                            iiss$unit_name == "SNAR-10 Big Fred (SZNAR-10)"|
                            iiss$unit_name == "Tall King" |
                            iiss$unit_name == "TPQ-37 Firefinder")] <- "land-based systems"

# Convert to tactical
iiss$equipment_subname[iiss$equipment_type == "radars" &
                         iiss$equipment_subtype == "tac"] <- "tactical"
iiss$equipment_subname[iiss$equipment_type == "radars" &
                         iiss$equipment_subtype == "tactical"] <- "tactical"

# Convert to long range
iiss$equipment_subname[iiss$equipment_type == "radars" &
                         iiss$equipment_subtype == "long-range"] <- "long-range"

# Convert to space 
iiss$equipment_subname[iiss$equipment_type == "radars" &
                         iiss$equipment_name == "operational satellites"] <- "space"

# Convert to strategic
iiss$equipment_subname[iiss$equipment_type == "radars" &
                         iiss$equipment_subtype == "strategic"] <- "strategic"
iiss$equipment_subname[iiss$equipment_type == "radars" &
                         iiss$equipment_name == "strategic"] <- "strategic"
iiss$equipment_subname[iiss$equipment_type == "radars" &
                         iiss$equipment_subtype == "STRATEGIC"] <- "strategic"
iiss$equipment_subtype[iiss$equipment_type == "radars" & 
                         iiss$equipment_name == "strategic"] <- "land-based systems"

# Convert to NA
iiss$equipment_subname[iiss$equipment_type == "radars" &
                         iiss$equipment_subname == "35mm"] <- NA
iiss$equipment_subname[iiss$equipment_type == "radars" &
                      iiss$equipment_subtype == "space-based systems" &
                      iiss$equipment_name == "satellites" &
                      iiss$equipment_subname == "satellites"] <- NA
iiss$equipment_subname[iiss$equipment_type == "radars" &
                         iiss$equipment_subname == "RADARS"] <- NA
iiss$equipment_subname[iiss$equipment_type == "satellites" &
                      iiss$equipment_name == "imagery" &
                      iiss$equipment_subname == "Imagery"] <- NA
iiss$equipment_subname[iiss$equipment_type == "satellites" &
                         iiss$equipment_name == "infrared/TV" &
                         iiss$equipment_subname == "Infared/TV"] <- NA
```

Fix incorrect equipment_name that should have equipment_type = equipment_type
```{r}
# Convert to NA
iiss$equipment_subname[iiss$equipment_type == "radars" &
                      iiss$equipment_name == "strategic" &
                      iiss$equipment_subname == "strategic"] <- NA
iiss$equipment_name[iiss$equipment_type == "radars" &
                      iiss$equipment_name == "strategic"] <- NA
iiss$equipment_name[iiss$equipment_type == "radars" &
                      iiss$equipment_name == "AShM"] <- NA
iiss$equipment_name[iiss$equipment_type == "radars" &
                      iiss$equipment_name == "AD RADARS"] <- NA
iiss$equipment_name[iiss$equipment_type == "radars" &
                         iiss$equipment_subtype == "AD" &
                         iiss$equipment_name == "AD RADER"] <- NA
iiss$equipment_name[iiss$equipment_type == "radars" &
                      iiss$equipment_name == "RADARS"] <- NA
iiss$equipment_name[iiss$equipment_type == "radars" &
                      iiss$equipment_subtype == "surv" &
                         iiss$equipment_name == "SURV"] <- NA

# Convert to communications
iiss$equipment_name[iiss$equipment_type == "satellites" &
                      iiss$equipment_subtype == "COMMS"] <- "COMMS"

# Convert to satellites
iiss$equipment_name[iiss$equipment_type == "radars" &
                         iiss$equipment_subtype == "space-based systems" &
                         iiss$equipment_name == "Space Based Systems" &
                         iiss$equipment_subname == "satellites"] <- "satellites"
iiss$equipment_name[iiss$equipment_type == "radars" &
                      iiss$equipment_name == "Satellites 2"] <- "satellites"

# Convert to imagery
iiss$equipment_name[iiss$equipment_type == "radars" &
                      iiss$equipment_name == "Imagery 1"] <- "imagery"
iiss$equipment_name[iiss$equipment_type == "satellites" &
                      iiss$equipment_subname == "Imagery"] <- "imagery"
iiss$equipment_name[iiss$equipment_type == "satellites" &
                      (iiss$equipment_name == "Imagery" |
                         iiss$equipment_name == "IMAGERY" |
                         iiss$equipment_name == "Imagery 1")] <- "imagery"

# Convert to infrared/TV
iiss$equipment_name[(iiss$equipment_type == "satellites" | 
                       iiss$equipment_type == "radars") &
                      iiss$equipment_subname == "Infared/TV"] <- "infrared/TV"

# Convert to ABM
iiss$equipment_name[iiss$equipment_type == "radars" &
                      iiss$equipment_name == "ABM RADAR"] <- "ABM"
iiss$equipment_name[iiss$equipment_type == "radars" &
                      iiss$unit_name == "ABM"] <- "ABM"
iiss$equipment_name[iiss$equipment_type == "radars" &
                      iiss$equipment_subtype == "land-based systems" &
                      iiss$equipment_name == "ABM"] <- "ABM"

# Convert to SAM RADARS
iiss$equipment_name[iiss$equipment_type == "radars" &
                      iiss$equipment_name == "SAM"] <- "SAM RADARS"
iiss$equipment_name[iiss$equipment_type == "air defence" & 
                      iiss$equipment_name == "AD" & 
                      (iiss$unit_name == "radar" | iiss$unit_name == "Stril 60")] <- "SAM RADARS"

# Convert to OTH-B
iiss$equipment_name[iiss$equipment_type == "radars" &
                      iiss$unit_name == "OTH-B"] <- "OTH-B"

# Convert to ICBM/SLBM launch detection capability
iiss$equipment_name[iiss$equipment_type == "radars" &
                      iiss$equipment_subtype == "ICBM/SLBM launch-detection capability"] <- "ICBM/SLBM launch-detection capability"

# Convert to aegis cruisers and destroyers 
iiss$equipment_name[iiss$equipment_type == "radars" &
                      iiss$equipment_subtype == "aegis cruisers and destroyers"] <- "aegis cruisers and destroyers"

# Convert to ISR
iiss$equipment_name[iiss$equipment_type == "satellites" &
                      iiss$equipment_subtype == "ISR"] <- "ISR"

# Convert to early warning
iiss$equipment_name[iiss$equipment_type == "radars" &
                      is.na(iiss$equipment_subname) &
                         is.na(iiss$equipment_name)] <- "EW"
```

Fix incorrect equipment_subtype that should have equipment_type = equipment_type
```{r}
# Convert to AD
iiss$equipment_subtype[iiss$equipment_type == "radars" &
                       (iiss$equipment_subname == "land" |
                         iiss$equipment_subname == "strategic" |
                         iiss$equipment_subname == "tactical" |
                         iiss$equipment_subname == "long range")] <- "AD"
iiss$equipment_subtype[iiss$equipment_type == "radars" &
                         iiss$equipment_name == "AD RADARS"] <- "AD"
iiss$equipment_subtype[iiss$equipment_type == "radars" &
                      iiss$equipment_name == "AD RADER"] <- "AD"

# Convert to space based systems
iiss$equipment_subtype[iiss$equipment_type == "radars" &
                         iiss$equipment_name == "Space Based Systems" &
                         iiss$equipment_subname == "satellites"] <- "space-based systems"
iiss$equipment_subtype[iiss$equipment_type == "radars" &
                         (iiss$equipment_name == "space surveillance" |
                            iiss$equipment_name == "spacetrack system")] <- "space-based systems"
iiss$equipment_subtype[iiss$equipment_type == "radars" &
                         iiss$equipment_name == "SPACE"] <- "space-based systems"
iiss$equipment_subtype[iiss$equipment_type == "radars" &
                      iiss$equipment_subtype == "ICBM/SLBM launch-detection capability" &
                        iiss$equipment_name == "ICBM/SLBM launch-detection capability"] <- "space-based systems"
iiss$equipment_subtype[iiss$equipment_type == "radars" &
                         iiss$unit_name == "operational satellites"] <- "space-based systems"
iiss$unit_name[iiss$equipment_type == "radars" &
                         iiss$unit_name == "operational satellites"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "space based systems"] <- "space-based systems"
iiss$equipment_subtype[iiss$equipment_type == "radars" & 
                         iiss$equipment_name == "COMMS"] <- "space-based systems"
iiss$equipment_subtype[iiss$equipment_type == "radars" & 
                         iiss$equipment_name == "EW"] <- "space-based systems"
iiss$equipment_subtype[iiss$equipment_type == "radars" & 
                         (iiss$equipment_name == "ELINT" | 
                            iiss$equipment_name == "ELINT/SIGINT")] <- "space-based systems"
iiss$equipment_subtype[iiss$equipment_type == "radars" & 
                         iiss$equipment_name == "ISR"] <- "space-based systems"
iiss$equipment_subtype[iiss$equipment_type == "radars" & 
                         iiss$equipment_name == "meteorology/oceanography"] <- "space-based systems"
iiss$equipment_subtype[iiss$equipment_type == "radars" & 
                         iiss$equipment_name == "NAV SPASUR"] <- "space-based systems"
iiss$equipment_subtype[iiss$equipment_type == "radars" & 
                         iiss$equipment_name == "navigation/positioning/timing"] <- "space-based systems"
iiss$equipment_subtype[iiss$equipment_type == "radars" & 
                         iiss$equipment_name == "OTH-B"] <- "space-based systems"
iiss$equipment_subtype[iiss$equipment_type == "radars" & 
                         iiss$equipment_name == "meteorology/oceanography"] <- "space-based systems"


# Convert to land-based systems 
iiss$equipment_subtype[iiss$equipment_type == "radars" &
                         (iiss$equipment_subtype == "missiles" |
                            iiss$equipment_subtype == "surv")] <- "land-based systems"
iiss$equipment_subtype[iiss$equipment_type == "radars" &
                         iiss$equipment_subtype == "aegis cruisers and destroyers" &
                         iiss$equipment_name == "aegis cruisers and destroyers"] <- "land-based systems"
iiss$equipment_subtype[iiss$equipment_type == "radars" &
                         iiss$unit_name == "TPQ-37 Firefinder"] <- "land-based systems"
iiss$equipment_subtype[iiss$equipment_type == "radars" &
                         iiss$equipment_name == "RECCE"] <- "land-based systems"
iiss$equipment_subtype[iiss$equipment_type == "radars" &
                         iiss$unit_name == "BPS-1000"] <- "land-based systems"
iiss$equipment_subtype[iiss$equipment_type == "radars" &
                         iiss$equipment_subtype == "ground-based interceptors"] <- "land-based systems"
iiss$equipment_subtype[iiss$equipment_type == "radars" &
                         iiss$equipment_name == "SYSTEMS"] <- "land-based systems"
iiss$equipment_subtype[iiss$equipment_type == "radars" &
                         iiss$unit_name == "AN/TPS-43"] <- "land-based systems"
iiss$equipment_subtype[iiss$equipment_type == "radars" &
                         (iiss$unit_name == "FPS-117" |
                            iiss$unit_name == "Goldhaube" |
                            iiss$unit_name == "Land" |
                            iiss$unit_name == "LUR" |
                            iiss$unit_name == "MSTAR" |
                            iiss$unit_name == "NBR"|
                            iiss$unit_name == "PRV-11" |
                            iiss$unit_name == "PSZNR-5B" |
                            iiss$unit_name == "radar bde" |
                            iiss$unit_name == "S-600" |
                            iiss$unit_name == "SABER M60"|
                            iiss$unit_name == "sites"|
                            iiss$unit_name == "SNAR-10 Big Fred (SZNAR-10)"|
                            iiss$unit_name == "TPQ-37 Firefinder")] <- "land-based systems"
iiss$equipment_subtype[iiss$equipment_type == "radars" &
                         iiss$equipment_subtype == "AD"] <- "land-based systems"
iiss$equipment_subtype[iiss$equipment_type == "radars" &
                         iiss$equipment_name == "SURV"] <- "land-based systems"
iiss$equipment_subtype[iiss$equipment_type == "radars" &
                         iiss$equipment_name == "ground based electro optical deep space surveillance system (GEODSS)"] <- "land-based systems"
iiss$equipment_subtype[iiss$eqequipment_type == "radars" & 
                         iiss$equipment_name == "CONTROL"] <- "land-based systems"
iiss$equipment_subtype[iiss$equipment_type == "radars" & 
                         iiss$equipment_name == "detection and tracking radars"] <- "land-based systems"
iiss$equipment_subtype[iiss$equipment_type == "radars" & 
                         iiss$equipment_name == "PAVE PAWS"] <- "land-based systems"
iiss$equipment_subtype[iiss$equipment_type == "radars" & 
                         iiss$equipment_name == "PARCS"] <- "land-based systems"
iiss$equipment_subtype[iiss$equipment_type == "radars" & 
                         iiss$equipment_name == "SAM RADARS"] <- "land-based systems"
iiss$equipment_subtype[iiss$equipment_type == "radars" & 
                         iiss$equipment_name == "SSPARS"] <- "land-based systems"
iiss$equipment_subtype[iiss$equipment_type == "radars" & 
                         iiss$equipment_name == "strategic"] <- "land-based systems"
iiss$equipment_subtype[iiss$equipment_type == "air defence" & 
                      iiss$equipment_name == "SAM RADARS" & 
                      (iiss$unit_name == "radar" | iiss$unit_name == "Stril 60")] <- "land-based systems"

# Convert to other 
iiss$equipment_subtype[iiss$equipment_type == "radars" & 
                         iiss$equipment_name == "infrared/TV"] <- "other"

# Convert to NA
iiss$equipment_subtype[iiss$equipment_type == "radars" &
                         iiss$equipment_subtype == "tac" &
                         iiss$equipment_subname == "tactical"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "radars" &
                         iiss$equipment_subtype == "long-range" &
                         iiss$equipment_subname == "long range"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "radars" &
                         iiss$equipment_subtype == "strategic" &
                         iiss$equipment_subname == "strategic"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "radars" &
                         iiss$equipment_subtype == "LAND" &
                         iiss$equipment_subname == "land"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "radars" &
                         iiss$equipment_subtype == "STRATEGIC" &
                         iiss$equipment_subname == "strategic"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "radars" &
                         iiss$equipment_subtype == "tactical" &
                         iiss$equipment_subname == "tactical"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "satellites" &
                         iiss$equipment_subtype == "COMMS" &
                         iiss$equipment_name == "COMMS"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "satellites" &
                         iiss$equipment_subtype == "ISR" &
                         iiss$equipment_name == "ISR"] <- NA

```

Fix incorrect equipment_type that should have equipment_type = equipment_type
```{r}
# Aircraft
iiss$equipment_type[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "CONTROL"] <- "radars"
iiss$equipment_type[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "SPACE"] <- "radars"

# Air defence
iiss$equipment_type[iiss$equipment_type == "air defence" &
                      iiss$equipment_subtype == "surv"] <- "radars"
iiss$equipment_type[iiss$equipment_type == "air defence" &
                      (iiss$equipment_name == "CONTROL" |
                         iiss$equipment_name == "SYSTEMS" |
                         iiss$equipment_name == "RADARS")] <- "radars"
iiss$equipment_type[iiss$equipment_type == "air defence" &
                      iiss$equipment_subname == "RADARS"] <- "radars"
iiss$equipment_type[iiss$equipment_type == "air defence" &
                      iiss$equipment_subtype == "space-based systems"] <- "radars"
iiss$equipment_type[iiss$equipment_type == "air defence" &
                      iiss$equipment_name == "SURV"] <- "radars"
iiss$equipment_type[iiss$equipment_type == "air defence" &
                      iiss$equipment_name == "Satellites 2"] <- "radars"
iiss$equipment_type[iiss$equipment_type == "air defence" & 
                         iiss$equipment_subtype == "land based systems" & 
                      iiss$equipment_name == "SAM RADARS" & 
                      (iiss$unit_name == "radar" | iiss$unit_name == "Stril 60")] <- "radars"

# Defensive
iiss$equipment_type[iiss$equipment_type == "defensive"] <- "radars"

# People's regional force
iiss$subservice[iiss$equipment_type == "people's regional force"] <- "people's regional force"
iiss$equipment_type[iiss$equipment_type == "people's regional force"] <- "radars"

# Satellites
iiss$equipment_type[iiss$equipment_type == "satellites"] <- "radars"

# Air surveillance
iiss$equipment_type[iiss$equipment_type == "air surveillance systems"] <- "radars"

# Space based systems 
iiss$equipment_type[iiss$equipment_type == "space based systems" & 
                      iiss$equipment_subtype == "space-based systems"] <- "radars"

# NA
iiss$equipment_type[is.na(iiss$equipment_type) &
                      iiss$equipment_name == "SURV"] <- "radars"
iiss$equipment_type[is.na(iiss$equipment_type) &
                      iiss$equipment_name == "early warning"] <- "radars"
```

## Submarines

### Typos
Here we fix typos, which include spelling errors, capitalization errors, and any other formatting errors that affect merging or equipment similarity

#### Unit_name typos
```{r}

```

#### Equipment_subname typos
```{r}

```

#### Equipment_name typos
```{r}
iiss$equipment_name[iiss$equipment_type == "submarines" &
                      iiss$equipment_name == "SLBM"] <- "SSBN"
```

#### Equipment_subtype typos
```{r}
iiss$equipment_subtype[iiss$equipment_subtype == "cruise missile"] <- NA
iiss$equipment_subtype[iiss$equipment_subtype == "other"] <- NA
```

#### Equipment_type typos
```{r}
iiss$equipment_type[iiss$equipment_type == "submarine"] <- "submarines"
iiss$equipment_type[iiss$equipment_type == "submirines"] <- "submarines"
```

### Coding changes

#### Unit_name
Fix incorrect columns based on unit_name value
```{r}
# Unit_name

# Equipment_subname

# Equipment_name
iiss$equipment_type[iiss$equipment_name == "UUV"] <- "submarines"

# Equipment_subtype

# Equipment_type

```

#### Equipment_subname
Fix incorrect columns that should have equipment_subname = TBD
```{r}
# Unit_name

# Equipment_subname

# Equipment_name

# Equipment_subtype

# Equipment_type

```

  REPEAT FOR EACH EQUIPMENT_SUBNAME AS NEEDED

#### Equipment_name
Fix incorrect columns that should have equipment_name = TBD
```{r}
# Unit_name

# Equipment_subname

# Equipment_name
iiss$equipment_name[iiss$equipment_type == "principal surface combatants" &
                      iiss$equipment_subtype == "submarines" &
                      iiss$unit_name == "R-class"] <- "other"
iiss$equipment_type[iiss$equipment_type == "principal surface combatants" &
                      iiss$equipment_subtype == "submarines" &
                      iiss$unit_name == "R-class"] <- "submarines"
iiss$equipment_subtype[iiss$equipment_subtype == "submarines" &
                      iiss$unit_name == "R-class"] <- NA

iiss$equipment_name[iiss$equipment_type == "principal surface combatants" &
                      iiss$equipment_subtype == "submarines" &
                      iiss$unit_name == "W-class"] <- "SSK"
iiss$equipment_type[iiss$equipment_type == "principal surface combatants" &
                      iiss$equipment_subtype == "submarines" &
                      iiss$unit_name == "W-class"] <- "submarines"
iiss$equipment_subtype[iiss$equipment_subtype == "submarines" &
                      iiss$unit_name == "W-class"] <- NA

iiss$equipment_type[iiss$equipment_type == "principal surface combatants" &
                      iiss$equipment_name == "SS"] <- "submarines"

iiss$equipment_name[iiss$equipment_type == "submarines" &
                      (iiss$unit_name == "ex-SSBN" |
                         iiss$unit_name == "fleet submarines" |
                         iiss$unit_name == "Potvis" |
                         iiss$unit_name == "submarines" |
                         iiss$unit_name == "Type 1200" |
                         iiss$unit_name == "Type 209")] <- "SS"

iiss$equipment_name[iiss$equipment_type == "submarines" &
                      (iiss$unit_name == "coastal submarines" |
                         iiss$unit_name == "Toti")] <- "SSC"

iiss$equipment_name[iiss$equipment_type == "submarines" &
                      iiss$unit_name == "ex-US Balao"] <- "SSG"

iiss$equipment_name[iiss$equipment_type == "submarines" &
                      (iiss$unit_name == "Daphne" |
                         iiss$unit_name == "ex-US Guppy III" |
                         iiss$unit_name == "Goias/Bahi" |
                         iiss$unit_name == "Kasonis" |
                         iiss$unit_name == "Oberon" |
                         iiss$unit_name == "patrol submarines" |
                         iiss$unit_name == "Poseidon (Type-1200)" |
                         iiss$unit_name == "R-class" |
                         iiss$unit_name == "Sov Foxtrot" |
                         iiss$unit_name == "Sov Foxtrot (F-class)" |
                         iiss$unit_name == "Sov W-class" |
                         iiss$unit_name == "US Guppy II/III" |
                         iiss$unit_name == "US Guppy IIA/III" |
                         iiss$unit_name == "W-class" |
                         iiss$unit_name == "W class" |
                         iiss$unit_name == "Zwaardvis")] <- "SSK"

iiss$equipment_name[iiss$equipment_type == "submarines" &
                      iiss$unit_name == "Q-class"] <- "SSQ"

iiss$equipment_name[iiss$equipment_type == "submarines" &
                      iiss$unit_name == "SX-506 midget"] <- "SSW"

iiss$equipment_name[iiss$equipment_type == "submarines" &
                      iiss$equipment_name == "SBS"] <- "SSW"

iiss$equipment_name[iiss$equipment_type == "submarines" &
                      (iiss$unit_name == "Ming trg" |
                         iiss$unit_name == "Romeo Romei (US Tang)")] <- "TRG"

iiss$equipment_name[iiss$equipment_type == "submarines" &
                      iiss$equipment_name == "SST"] <- "TRG"

# Equipment_subtype
iiss$equipment_subtype[iiss$equipment_name == "SSK"] <- "tactical"

# Equipment_type
iiss$equipment_type[iiss$equipment_name == "SSK"] <- "submarines"
```

  REPEAT FOR EACH EQUIPMENT_NAME AS NEEDED
  
#### Equipment_subtype
Fix incorrect columns that should have equipment_subtype = TBD
```{r}
# Unit_name

# Equipment_subname

# Equipment_name

# Equipment_subtype

# Equipment_type

```

  REPEAT FOR EACH EQUIPMENT_SUBTYPE AS NEEDED

#### Equipment_type

Fix incorrect unit_name that should have equipment_type = equipment_type
```{r}

```

Fix incorrect equipment_subname that should have equipment_type = equipment_type
```{r}
# Convert to tactical
iiss$equipment_subname[iiss$equipment_type == "submarines" &
                         iiss$equipment_subtype == "tac"] <- "tactical"
iiss$equipment_subname[iiss$equipment_type == "submarines" &
                         iiss$equipment_subtype == "tactical"] <- "tactical"
iiss$equipment_subname[iiss$equipment_type == "submarines" &
                         iiss$equipment_subname == "tac"] <- "tactical"


# Convert to support
iiss$equipment_subname[iiss$equipment_type == "submarines" &
                         iiss$equipment_subtype == "support"] <- "support"

# Convert to strategic 
iiss$equipment_subname[iiss$equipment_type == "submarines" &
                         iiss$equipment_subtype == "strategic"] <- "strategic"

# Convert to NA 
iiss$equipment_subname[iiss$equipment_type == "submarines" &
                         (iiss$equipment_subname == "M45 SLBM" |
                            iiss$equipment_subname == "M51 SLBM")] <- NA
```

Fix incorrect equipment_name that should have equipment_type = equipment_type
```{r}
# Convert to SDV
iiss$equipment_name[iiss$equipment_type == "submarines" &
                      iiss$equipment_subtype == "SDV"] <- "SDV"

# Convert to SS
iiss$equipment_name[iiss$equipment_type == "submarines" &
                      iiss$equipment_name == "Other Roles"] <- "SS"

# Convert to SSK
iiss$equipment_name[iiss$equipment_type == "submarines" &
                      (iiss$unit_name == "Dolfijn" |
                         iiss$unit_name == "Whiskey" |
                         iiss$unit_name == "Zeeleeuw")] <- "SSK"

# Convert to SSC
iiss$equipment_name[iiss$equipment_type == "submarines" &
                      iiss$equipment_subtype == "coastal"] <- "SSC"
iiss$equipment_subtype[iiss$equipment_subtype == "coastal"] <- NA
```

Fix incorrect equipment_subtype that should have equipment_type = equipment_type
```{r}
# Convert to attack
iiss$equipment_subtype[iiss$equipment_type == "submarines" &
                      (iiss$unit_name == "Katsonis" |
                         iiss$unit_name == "Toti" |
                         iiss$unit_name == "W-class" |
                         iiss$unit_name == "Zwaardvis")] <- "attack"

# Convert to other
iiss$equipment_subtype[iiss$equipment_type == "submarines" &
                         iiss$unit_name == "R-class"] <- "other"
iiss$equipment_name[iiss$equipment_type == "submarines" &
                      is.na(iiss$equipment_subname) &
                      is.na(iiss$equipment_name)] <- "other"

# Convert to NA 
iiss$equipment_subtype[iiss$equipment_type == "submarines" &
                         iiss$equipment_subtype == "tac"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "submarines" &
                         iiss$equipment_subtype == "support"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "submarines" &
                         iiss$equipment_subtype == "strategic"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "submarines" &
                         iiss$equipment_subtype == "tactical" &
                         iiss$equipment_subname == "tactical"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "submarines" &
                         iiss$equipment_subtype == "SDV" &
                         iiss$equipment_name == "SDV"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "submarines" &
                         iiss$equipment_subtype == "submarines"] <- NA
```

Fix incorrect equipment_type that should have equipment_type = equipment_type
```{r}
# Logistics and support
iiss$equipment_type[iiss$equipment_type == "logistics and support" &
                         iiss$equipment_name %in% c("SSA",
                                                    "SSAN")] <- "submarines"

# Offensive
iiss$equipment_type[iiss$equipment_type == "offensive" &
                      (iiss$equipment_subtype == "submarines" |
                         iiss$equipment_name == "SSBN")] <- "submarines"
```

## Surface to surface missile launchers

### Typos
Here we fix typos, which include spelling errors, capitalization errors, and any other formatting errors that affect merging or equipment similarity

#### Unit_name typos
```{r}
iiss$unit_name[iiss$unit_name == "SA-3/SA-2"] <- "SA-2/-3"
iiss$unit_name[iiss$unit_name == "THADD"] <- "THAAD"
```

#### Equipment_subname typos
```{r}

```

#### Equipment_name typos
```{r}

```

#### Equipment_subtype typos
```{r}
# missiles
iiss$equipment_subtype[iiss$equipment_type == "surface-to-surface missile launchers" &
                           iiss$equipment_name == "AAM" |
                           (is.na(iiss$equipment_subname) |
                              iiss$equipment_subname == "Tactical - AAM" |
                              iiss$equipment_subname %in% c("IR", "OR") |
                              iiss$equipment_subname == "IIR" |
                              iiss$equipment_subname == "ARH" |
                              iiss$equipment_subname == "AAM" |
                              iiss$equipment_subname == "SARH"|
                              iiss$equipment_subname == "AShM") &
                           iiss$unit_name %like any% c("%Apside%", "%Roland%")] <- "missiles"
iiss$equipment_subtype[iiss$equipment_subtype == "MSL"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_subtype == "surface-to-surface missile launchers"] <- NA

iiss$equipment_subtype[iiss$equipment_subtype == "missiles"] <- NA

iiss$equipment_subtype[iiss$equipment_subtype == "coast"] <- "coastal"

#Exclude MOWAG Roland from the above code
iiss$equipment_subtype[iiss$unit_name == "MOWAG Roland"] <- NA
```

#### Equipment_type typos
```{r}
iiss$equipment_type[iiss$equipment_type == "missles"] <- "missiles"
iiss$equipment_type[iiss$equipment_type == "surface to surface missile launcher"] <- "surface-to-surface missile launchers"
iiss$equipment_type[iiss$equipment_type == "surface to surface missiles"] <- "surface-to-surface missile launchers"
iiss$equipment_type[iiss$equipment_type == "SSM"] <- "surface-to-surface missile launchers"
iiss$equipment_type[iiss$equipment_type == "surface-to-surface missiles"] <- "surface-to-surface missile launchers"
iiss$equipment_type[iiss$equipment_type == "surface-to-surface missile"] <- "surface-to-surface missile launchers"
iiss$equipment_type[iiss$equipment_type == "launchers" &
                      iiss$equipment_name == "SSM"] <- "surface-to-surface missile launchers"
```

### Coding changes

#### Unit_name
Fix incorrect columns based on unit_name value
```{r}
# Unit_name
iiss$equipment_type[iiss$unit_name == "MM-38"] <- "surface-to-surface missile launchers"

iiss$equipment_type[iiss$unit_name == "MM-40 Exocet"] <- "surface-to-surface missile launchers"
iiss$equipment_name[iiss$unit_name == "MM-40 Exocet" &
                      (iiss$equipment_name == "Coast Defense" |
                         iiss$equipment_name == "FAC")] <- "SSM"

iiss$equipment_type[iiss$unit_name == "MM-40 Exocet SMM"] <- "surface-to-surface missile launchers"
iiss$equipment_name[iiss$unit_name == "MM-40 Exocet SMM" &
                      (iiss$equipment_name == "Coast Defense" |
                         iiss$equipment_name == "FAC")] <- "SSM"

# Equipment_subname

# Equipment_name
iiss$equipment_name[iiss$equipment_type == "anti-ship missile" &
                      iiss$unit_name == "KN-01"] <- "AShM"
# Equipment_subtype

# Equipment_type

```

#### Equipment_subname
Fix incorrect columns that should have equipment_subname = TBD
```{r}
# Unit_name
iiss$unit_name[iiss$equipment_subname == "Strela-1/Strela-10 (SA-9 Gaskin/SA-13 Gopher)"] <- "Strela-1/Strela-10 (SA-9 Gaskin/SA-13 Gopher)"
iiss$equipment_subname[iiss$equipment_subname == "Strela-1/Strela-10 (SA-9 Gaskin/SA-13 Gopher)"] <- NA
iiss$unit_name[iiss$equipment_subname == "9K33 Osa (SA-8 Gecko)"] <- "9K33 Osa (SA-8 Gecko)"
iiss$equipment_subname[iiss$equipment_subname == "9K33 Osa (SA-8 Gecko)"] <- NA

# Equipment_subname
iiss$equipment_subname[iiss$equipment_type == "surface-to-surface missile launchers" &
                      iiss$equipment_name == "ARM" &
                      iiss$equipment_subname == "ARM"] <- NA
```

#### Equipment_name
Fix incorrect columns that should have equipment_name = TBD
```{r}
# Unit_name
iiss$equipment_name[iiss$unit_name == "Salish" |
                      iiss$unit_name == "Shaddock"] <- "SSM"
iiss$equipment_type[iiss$unit_name == "Salish" |
                      iiss$unit_name == "Shaddock"] <- "surface-to-surface missile launchers"

iiss$equipment_name[iiss$equipment_type == "surface-to-surface missile launchers" &
                        (iiss$unit_name == "MM-40 Exocet" |
                           iiss$unit_name == "RGM-84A Harpoon AShM")] <- "AShM"

iiss$equipment_name[iiss$equipment_type == "surface-to-surface missile launchers" &
                        (iiss$unit_name == "RGM-84A Harpoon SSM" |
                           iiss$unit_name == "twin each with 1 Mk 2 Otomat SSM")] <- "AShM"


iiss$equipment_type[iiss$unit_name == "Kormoran 2"] <- "surface-to-surface missile launchers"
iiss$equipment_name[iiss$unit_name == "Kormoran 2"] <- "AShM"

iiss$equipment_name[iiss$unit_name == "THAAD"] <- "SAM-associated short-range"

iiss$equipment_name[iiss$equipment_type == "surface-to-surface missile launchers" &
                      (iiss$unit_name == "Shaddock" |
                         iiss$unit_name == "SS-N-3 Shaddock" |
                         iiss$unit_name == "SS-C-3 Sepal")] <- "SLCM"

# Equipment_subname
iiss$equipment_name[iiss$equipment_type == "surface-to-surface missile launchers" &
                      iiss$equipment_subname == "ARM"] <- "ARM"

iiss$equipment_name[iiss$equipment_type == "surface-to-surface missile launchers" &
                      iiss$equipment_subname == "GLCM"] <- "GLCM"
iiss$equipment_subname[iiss$equipment_type == "surface-to-surface missile launchers" &
                      iiss$equipment_subname == "GLCM"] <- NA

# Equipment_name
iiss$equipment_type[iiss$equipment_name == "COAST" |
                      iiss$equipment_name == "Coast Defense"] <- "AShM"
iiss$equipment_type[iiss$equipment_name == "BTY"] <- "surface-to-surface missile launchers"
iiss$equipment_type[iiss$equipment_name == "LNCHR"] <- "surface-to-surface missile launchers"
iiss$equipment_type[iiss$equipment_name == "MSL"] <- "surface-to-surface missile launchers"

# Equipment_subtype

# Equipment_type
iiss$equipment_name[iiss$equipment_type == "launcher" &
                        is.na(iiss$equipment_name)] <- "SSM"
```
  
#### Equipment_subtype
Fix incorrect columns that should have equipment_subtype = TBD
```{r}

```

  REPEAT FOR EACH EQUIPMENT_SUBTYPE AS NEEDED

#### Equipment_type

Fix incorrect unit_name that should have equipment_type = equipment_type
```{r}

```

Fix incorrect equipment_subname that should have equipment_type = equipment_type
```{r}
# Convert to TOWED
iiss$equipment_subname[iiss$unit_name == "THAAD"] <- "TOWED"

# Convert to ARM
iiss$equipment_subname[iiss$equipment_type == "surface-to-surface missile launchers" &
                         iiss$equipment_subtype == "tactical" &
                         iiss$equipment_name == "ARM" &
                         is.na(iiss$equipment_subname)] <- "ARM"

# Convert to tactical 
iiss$equipment_subname[iiss$equipment_type == "surface-to-surface missile launchers" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "TACTICAL" &
                         is.na(iiss$equipment_subname)] <- "tactical"
iiss$equipment_subname[(iiss$unit_name == "SCUD" |
                          iiss$unit_name == "FROG")] <- "tactical"
iiss$equipment_subname[iiss$equipment_type == "surface-to-surface missile launchers" &
                         iiss$equipment_subtype == "tac"] <- "tactical"
iiss$equipment_subname[iiss$equipment_type == "surface-to-surface missile launchers" &
                         iiss$equipment_name == "Tactical SSM"] <- "tactical"

# Convert to strategic
iiss$equipment_subname[iiss$equipment_type == "surface-to-surface missile launchers" &
                         iiss$equipment_subtype == "strategic" &
                         iiss$equipment_name == "LACM" &
                         is.na(iiss$equipment_subname)] <- "strategic"

# Convert to coastal
iiss$equipment_subname[iiss$equipment_type == "surface-to-surface missile launchers" &
                         iiss$equipment_subname == "Coastal"] <- "coastal"
iiss$equipment_subname[iiss$equipment_type == "MSLS" & 
                         iiss$equipment_subtype == "SSM" & 
                         (iiss$equipment_name == "coastal" |
                            iiss$equipment_name == "sea-launched")] <- "coastal"

# Convert to NA
iiss$equipment_subname[iiss$equipment_type == "surface-to-surface missile launchers" &
                         iiss$equipment_subtype == "missiles" &
                         iiss$equipment_name == "SSM" &
                         iiss$equipment_subname == "SSM"] <- NA
iiss$equipment_subname[iiss$equipment_type == "surface-to-surface missile launchers" &
                         iiss$equipment_subtype == "missiles" &
                         iiss$equipment_name == "ASM" &
                         iiss$equipment_subname == "ASM"] <- NA
iiss$equipment_subname[iiss$equipment_type == "surface-to-surface missile launchers" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "ASM" &
                         iiss$equipment_subname %in% c("57mm", "80mm")] <- NA
iiss$equipment_subname[iiss$equipment_type == "surface-to-surface missile launchers" &
                         iiss$equipment_name == "SSM" &
                      iiss$equipment_subname == "SSM"] <- NA


```

Fix incorrect equipment_name that should have equipment_type = equipment_type
```{r}
# Convert to NA 
iiss$equipment_name[iiss$equipment_type == "surface-to-surface missile launchers" &
                      iiss$equipment_subtype == "tactical" &
                      iiss$equipment_name == "ARM" &
                      iiss$equipment_subname == "ARM"] <- NA
iiss$equipment_name[iiss$equipment_type == "surface-to-surface missile launchers" &
                      iiss$equipment_subtype == "missiles" &
                         iiss$equipment_name == "MSL"] <- NA

# Convert to AShM
iiss$equipment_name[iiss$equipment_type == "surface-to-surface missile launchers" &
                      is.na(iiss$equipment_subtype) &
                      iiss$equipment_name == "ASSM" &
                      is.na(iiss$equipment_subname)] <- "AShM"
iiss$equipment_name[iiss$equipment_type == "surface-to-surface missile launchers" &
                      is.na(iiss$equipment_subtype) &
                      iiss$equipment_name == "TACTICAL" &
                      iiss$equipment_subname == "tactical"] <- "AShM"

iiss$equipment_type[iiss$equipment_type == "AShM" &
                      iiss$equipment_name == "COAST"] <- "surface-to-surface missile launchers"
iiss$equipment_name[iiss$equipment_type == "surface-to-surface missile launchers" &
                      iiss$equipment_name == "COAST"] <- "AShM"

# Convert to SSM
iiss$equipment_name[iiss$equipment_type == "surface-to-surface missile launchers" &
                      iiss$equipment_subtype == "missiles" &
                      iiss$equipment_name == "MSL" &
                      iiss$equipment_subname == "SSM"] <- "SSM"
iiss$equipment_name[(iiss$unit_name == "SCUD" |
                       iiss$unit_name == "FROG")] <- "SSM"
iiss$equipment_name[iiss$equipment_type == "surface-to-surface missile launchers" &
                      iiss$equipment_subtype == "missiles" &
                      is.na(iiss$equipment_name) &
                      is.na(iiss$equipment_subname)] <- "SSM"
iiss$equipment_name[iiss$equipment_type == "surface-to-surface missile launchers" &
                      iiss$equipment_subtype == "SSM"] <- "SSM"
iiss$equipment_name[iiss$equipment_type == "surface-to-surface missile launchers" &
                      iiss$equipment_name == "MSL" &
                      iiss$equipment_subname == "tactical"] <- "SSM"
iiss$equipment_name[iiss$equipment_type == "surface-to-surface missile launchers" &
                         iiss$equipment_name == "Tactical SSM" &
                         iiss$equipment_subname == "tactical"] <- "SSM"
iiss$equipment_name[iiss$equipment_type == "surface-to-surface missile launchers" &
                      iiss$equipment_subname == "SSM"] <- "SSM"
iiss$equipment_name[iiss$equipment_type == "MSLS" & 
                      iiss$equipment_subtype == "SSM" & 
                      (iiss$equipment_name == "coastal" | 
                         iiss$equipment_name == "sea-launched")] <- "SSM"

# Convert to LACM
iiss$equipment_name[iiss$equipment_type == "surface-to-surface missile launchers" &
                      is.na(iiss$equipment_subtype) &
                      iiss$equipment_name == "SCALP EG" &
                      is.na(iiss$equipment_subname)] <- "LACM"

# Convert to SLCM
iiss$equipment_name[iiss$equipment_type == "MSLS" & 
                      iiss$equipment_subtype == "SLCM"] <- "SSM"

```

Fix incorrect equipment_subtype that should have equipment_type = equipment_type
```{r}
# convert to missiles
iiss$equipment_subtype[iiss$unit_name == "THAAD"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "surface-to-surface missile launchers" &
                           is.na(iiss$equipment_subtype) &
                           iiss$equipment_name == "AShM" &
                           is.na(iiss$equipment_subname)] <- "missiles"
iiss$equipment_subtype[iiss$unit_name == "Salish" |
                         iiss$unit_name == "Shaddock"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "surface-to-surface missile launchers" &
                         iiss$equipment_subtype == "tactical" &
                         iiss$equipment_name == "SSM" &
                         iiss$equipment_subname == "tactical"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "launcher" &
                           iiss$equipment_name == "SSM"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "surface-to-surface missile launchers" &
                         iiss$equipment_subtype == "tactical" &
                         iiss$equipment_name == "AShM" &
                         iiss$equipment_subname == "strategic"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "surface-to-surface missile launchers" &
                         iiss$equipment_subtype == "tactical" &
                         is.na(iiss$equipment_name) &
                         iiss$equipment_subname == "ARM"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "surface-to-surface missile launchers" &
                         iiss$equipment_subtype == "strategic" &
                         iiss$equipment_name == "LACM" &
                         iiss$equipment_subname == "strategic"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "surface-to-surface missile launchers" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "ASCM" &
                         is.na(iiss$equipment_subname)] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "surface-to-surface missile launchers" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "AShM" &
                         is.na(iiss$equipment_subname)] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "surface-to-surface missile launchers" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "LACM" &
                         is.na(iiss$equipment_subname)] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "surface-to-surface missile launchers" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "MSL" &
                         iiss$equipment_subname == "SSM"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "surface-to-surface missile launchers" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "AShM" &
                         iiss$equipment_subname == "tactical"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "surface-to-surface missile launchers" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "LACM" &
                         is.na(iiss$equipment_subname)] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "surface-to-surface missile launchers" &
                         is.na(iiss$equipment_subtype) &
                         iiss$equipment_name == "ASM" &
                         iiss$equipment_subname == "ASM"] <- "missiles"
iiss$equipment_subtype[(iiss$unit_name == "SCUD" |
                          iiss$unit_name == "FROG")] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "surface-to-surface missile launchers" &
                         is.na(iiss$equipment_subtype) &
                         is.na(iiss$equipment_name) &
                         is.na(iiss$equipment_subname)] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "surface-to-surface missile launchers" &
                         iiss$equipment_subtype == "tac" &
                         iiss$equipment_subname == "tactical"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "surface-to-surface missile launchers" &
                         iiss$equipment_name == "SAM"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "surface-to-surface missile launchers" &
                      iiss$equipment_subtype == "SSM" &
                        iiss$equipment_name == "SSM"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "surface-to-surface missile launchers" &
                         iiss$equipment_name == "MSL"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "anti-ship missile" &
                         iiss$equipment_name == "AShM" &
                      iiss$unit_name == "KN-01"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "surface-to-surface missile launchers"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "surface-to-surface missile launchers" &
  (is.na(iiss$equipment_subname) |
     iiss$equipment_subname == "Tactical - AAM" |
     iiss$equipment_subname %in% c("IR", "OR") |
     iiss$equipment_subname == "IIR" |
     iiss$equipment_subname == "ARH" |
     iiss$equipment_subname == "AAM" |
     iiss$equipment_subname == "SARH"|
     iiss$equipment_subname == "AShM"|
     iiss$equipment_subname == "ARM"|
     iiss$equipment_subname == "PRH"|
     iiss$equipment_subname == "IIR/ARH"|
     iiss$equipment_subname == "IR/SARH"|
     iiss$equipment_subname == "IR/ARH") &
    iiss$unit_name %like any% c("AA-%", "AIM-%", "%AIM%", "AAM-%",
                                "%AGM-%", "AM-%", "%ALARM%", "AS%",
                                "%Derby%", "IRIS%", "%Iris%", "Kh%",
                                "MICA%", "Mica%", "R-%", "PL-%",
                                "%Meteor%","Python%", "Shafrir%",
                                "Super 530%", "YJ-91", "U-Darter",
                                "Armat", "%Magic%", "MAR-1", "R530",
                                "RB-%", "S5K%", "S8KP%", "Sky Flash",
                                "Sky Sword%", "V3C%")] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "MSLS" & 
                         iiss$equipment_subtype == "SSM" & 
                         iiss$equipment_name == "SSM"] <- "missiles"
iiss$equipment_subtype[iiss$equipment_type == "MSLS" & 
                         iiss$equipment_subtype == "SLCM" & 
                         iiss$equipment_name == "SSM"] <- "missiles"
```

Fix incorrect equipment_type that should have equipment_type = equipment_type
```{r}
# Launcher
iiss$equipment_type[iiss$equipment_type == "launcher" &
                        iiss$equipment_subtype == "missiles" &
                        iiss$equipment_name == "SSM"] <- "surface-to-surface missile launchers"

# Missiles
iiss$equipment_type[iiss$equipment_type == "missiles" &
                        iiss$equipment_name == "AShM" &
                        (iiss$unit_name == "Salish" |
                           iiss$unit_name == "Shaddock")] <- "surface-to-surface missile launchers"

iiss$equipment_type[iiss$equipment_type == "surface-to-surface/surface-to-air missile launchers"] <- "surface-to-surface missile launchers"

iiss$equipment_type[iiss$equipment_type == "missiles"] <- "surface-to-surface missile launchers"

# Air defence 
iiss$equipment_type[iiss$equipment_type == "air defence" &
                      iiss$equipment_subtype == "tac" &
                      iiss$equipment_name == "SSM"] <- "surface-to-surface missile launchers"
iiss$equipment_type[iiss$equipment_type == "air defence" &
                      iiss$equipment_subtype == "missiles" &
                      iiss$equipment_name == "SSM" &
                      is.na(iiss$equipment_subname)] <- "surface-to-surface missile launchers"
iiss$equipment_type[iiss$equipment_type == "air defence" &
                      iiss$equipment_subtype == "tac" &
                      iiss$equipment_name == "SSM"] <- "surface-to-surface missile launchers"
iiss$equipment_type[iiss$equipment_type == "air defence" &
                      iiss$equipment_subtype == "tactical" &
                      iiss$equipment_name == "SSM"] <- "surface-to-surface missile launchers"
iiss$equipment_type[iiss$equipment_type == "air defence" &
                      iiss$equipment_name == "SSM" &
                      iiss$equipment_subname == "tactical"] <- "surface-to-surface missile launchers"
iiss$equipment_type[iiss$equipment_type == "air defence" &
                      iiss$equipment_name == "SSM"] <- "surface-to-surface missile launchers"

# Artillery
iiss$equipment_type[iiss$equipment_type == "artillery" &
                      iiss$equipment_name == "AShM"] <- "surface-to-surface missile launchers"
iiss$equipment_type[iiss$equipment_type == "artillery" &
                      iiss$equipment_subtype == "SSM"] <- "surface-to-surface missile launchers"
iiss$equipment_type[iiss$equipment_type == "artillery" &
                      iiss$equipment_name == "SSM"] <- "surface-to-surface missile launchers"

# Anti-ship missile 
iiss$equipment_type[iiss$equipment_type == "anti-ship missile" &
                         iiss$equipment_name == "AShM" &
                      iiss$equipment_subtype == "missiles" &
                         iiss$unit_name == "KN-01"] <- "surface-to-surface missile launchers"

# Coastal regional defence forces
iiss$subservice[iiss$equipment_type == "Coastal regional defence forces"] <- "Coastal regional defence forces"
iiss$equipment_type[iiss$equipment_type == "Coastal regional defence forces" &
                      iiss$equipment_name == "SSM"] <- "surface-to-surface missile launchers"

# Radars
iiss$equipment_type[iiss$equipment_type == "radars" &
                      iiss$equipment_name == "SSM"] <- "surface-to-surface missile launchers"

# NA
iiss$equipment_type[is.na(iiss$equipment_type) &
                      (iiss$equipment_name == "MSL" &
                      (iiss$unit_name == "SS-C-1B Sepal" |
                         iiss$unit_name == "SS-C-3 Styx" |
                         is.na(iiss$unit_name)) |
                         iiss$equipment_name == "SSM" |
                        iiss$equipment_name == "MSL" |
                         iiss$equipment_name == "Tactical SSM") |
                      iiss$equipment_subname == "SSM"] <- "surface-to-surface missile launchers"

# Anti-tank/anti-infrastructure
iiss$equipment_type[iiss$equipment_type == "anti-tank/anti-infrastructure" &
                      iiss$equipment_name == "SSM"] <- "surface-to-surface missile launchers"

# Aircraft
iiss$equipment_type[iiss$equipment_type == "aircraft" &
                      iiss$equipment_name == "LACM"] <- "surface-to-surface missile launchers"

# Patrol and coastal combatants
iiss$equipment_type[iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_name == "SSM" &
                      iiss$unit_name == "MM-38 Exocet"] <- "surface-to-surface missile launchers"

# MSLS
iiss$equipment_type[iiss$equipment_type == "MSLS" & 
                      iiss$equipment_subtype == "missiles" & 
                      iiss$equipment_name == "SSM"] <- "surface-to-surface missile launchers"
                      
```


## Unmanned aerial vehicles

### Typos
Here we fix typos, which include spelling errors, capitalization errors, and any other formatting errors that affect merging or equipment similarity

#### Unit_name typos
```{r}
iiss$unit_name[iiss$unit_name == "Aladdin"] <- "Aladin"
iiss$unit_name[iiss$unit_name == "Orbier"] <- "Orbiter"
iiss$unit_name[iiss$unit_name == "Fchela-1"] <- "Pchela-1"
iiss$unit_name[iiss$unit_name == "Fchela-2"] <- "Pchela-2"
iiss$unit_name[iiss$unit_name == "Predato"] <- "Predator"
iiss$unit_name[iiss$unit_name == "R4E-50 Skeye"] <- "R4E-50 Skyeye"
iiss$unit_name[iiss$unit_name == "MALE"] <- "Sperwer"
```

#### Equipment_subname typos
```{r}
iiss$equipment_subname[iiss$equipment_subname == "med"] <- "medium"
iiss$equipment_subname[iiss$equipment_subname == "lt"] <- "light"
```

#### Equipment_name typos
```{r}
iiss$equipment_name[iiss$equipment_name == "TAC" & 
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "ISR"
```

#### Equipment_subtype typos
```{r}
iiss$equipment_subtype[iiss$equipment_subtype == "UAV"] <- NA
```

#### Equipment_type typos
```{r}
iiss$equipment_type[iiss$equipment_type == "drone"] <- "unmanned aerial vehicles"
iiss$equipment_type[iiss$equipment_type == "unmanned aerial vehicle"] <- "unmanned aerial vehicles"
iiss$equipment_type[iiss$equipment_type == "Unmanned aerial vehicles"] <- "unmanned aerial vehicles"
```

### Coding changes

#### Unit_name
Fix incorrect columns based on unit_name value
```{r}
# Unit_name
iiss$equipment_type[(iiss$unit_name == "Armscor Seeker" |
                       iiss$unit_name == "IAI Scout" |
                       iiss$unit_name == "Meteor P1") &
                      iiss$equipment_type == "aircraft"] <- "unmanned aerial vehicles"

iiss$equipment_name[(iiss$unit_name == "Armscor Seeker" |
                       iiss$unit_name == "IAI Scout" |
                       iiss$unit_name == "Meteor P1") &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "recon-surveil"

# Equipment_subname

# Equipment_name

# Equipment_subtype

# Equipment_type

```

#### Equipment_subname
Fix incorrect columns that should have equipment_subname = TBD
```{r}
# Unit_name

# Equipment_subname

# Equipment_name

# Equipment_subtype

# Equipment_type

```

#### Equipment_name
Fix incorrect columns that should have equipment_name = TBD
```{r}
# Unit_name
iiss$equipment_name[iiss$unit_name == "R4E-50 Skyeye" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "recon-surveil"
iiss$equipment_name[iiss$unit_name == "Teledyne-Ryan 324 Scarab" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "recon-surveil"

iiss$equipment_name[iiss$unit_name == "(trials)"&
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "TRIALS"
iiss$equipment_name[iiss$unit_name == "3D Max Dragon Eye" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "recon-surveil"
iiss$equipment_name[iiss$unit_name == "Aerostar" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "ISR"
iiss$equipment_name[iiss$unit_name == "Aladin" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "recon-surveil"
iiss$equipment_name[iiss$unit_name == "Albatross" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "RECCE"
iiss$equipment_name[iiss$unit_name == "AN/USD-501 Midge" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "RECCE"
iiss$equipment_name[iiss$unit_name == "AOLOS-289/CL-289" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "RECCE"
iiss$equipment_name[iiss$unit_name == "AOLOS-289/CL-289 (AN/USD-502)" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "RECCE"
iiss$equipment_name[iiss$unit_name == "ASN-104/-105" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "ISR"
iiss$equipment_name[iiss$unit_name == "ASN-105/-105/-206" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "ISR"
iiss$equipment_name[iiss$unit_name == "B-Hunter systems" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "RECCE"
iiss$equipment_name[iiss$unit_name == "Bayraktar"&
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "RECCE"
iiss$equipment_name[iiss$unit_name == "BLA-06" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "RECCE"
iiss$equipment_name[iiss$unit_name == "BLA-07" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "RECCE"
iiss$equipment_name[iiss$unit_name == "Blue Horizon" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "ISR"
iiss$equipment_name[iiss$unit_name == "Blue Horizon II" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "ISR"
iiss$equipment_name[iiss$unit_name == "Blue Horizon-2" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "ISR"
iiss$equipment_name[iiss$unit_name == "BQM-147 Exdrone" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "ISR"
iiss$equipment_name[iiss$unit_name == "Bravo" &
                      iiss$equipment_name == "unmanned aerial vehicles"] <- "ISR"
iiss$equipment_name[iiss$unit_name == "Buster"&
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "ISR"
iiss$equipment_name[iiss$unit_name == "Chukar III" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "recon-surveil"
iiss$equipment_name[iiss$unit_name == "CL 89 (AN/USD501)" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "ISR"
iiss$equipment_name[iiss$unit_name == "CL-89" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "RECCE"
iiss$equipment_name[iiss$unit_name == "CL-289" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "RECCE"
iiss$equipment_name[iiss$unit_name == "CL-89 (AN/USD-501)" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "RECCE"
iiss$equipment_name[iiss$unit_name == "CL289 (AN/USD502)" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "ISR"
iiss$equipment_name[iiss$unit_name == "Crecelle" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "RECCE"
iiss$equipment_name[iiss$unit_name == "Delilah" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "ATK"
iiss$equipment_name[iiss$unit_name == "Eagle I"&
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "RECCE"
iiss$equipment_name[iiss$unit_name == "Expert"&
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "RECCE"
iiss$equipment_name[iiss$unit_name == "Firebee" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "ISR"
iiss$equipment_name[iiss$unit_name == "FS- 01 Watchdog"&
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "heavy"
iiss$equipment_name[iiss$unit_name == "Hermes" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "ISR"
iiss$equipment_name[iiss$unit_name == "Hermes 450" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "ISR"
iiss$equipment_name[iiss$unit_name == "Hunter"&
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "RECCE"
iiss$equipment_name[iiss$unit_name == "Hunter Silver Arrow" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "RECCE"
iiss$equipment_name[iiss$unit_name == "Impact"&
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "ISR"
iiss$equipment_name[iiss$unit_name == "Jasoos" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "ISR"
iiss$equipment_name[iiss$unit_name == "Krunk" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "RECCE"
iiss$equipment_name[iiss$unit_name == "KZO" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "ISR"
iiss$equipment_name[iiss$unit_name == "Luna X-2000" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "ISR"
iiss$equipment_name[iiss$unit_name == "MALE" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "other"
iiss$equipment_name[iiss$unit_name == "MART Mk II" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "recon-surveil"
iiss$equipment_name[iiss$unit_name == "Mastiff III" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "ISR"
iiss$equipment_name[iiss$unit_name == "MIKADO" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "recon-surveil"
iiss$equipment_name[iiss$unit_name == "Mohajer II/Mohajer III/Mohajer IV" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "ISR"
iiss$equipment_name[iiss$unit_name == "MQ-8B Fire Scout" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "TAC"
iiss$equipment_name[iiss$unit_name == "Orbiter"&
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "ISR"
iiss$equipment_name[iiss$unit_name == "Pchela-1" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "ISR"
iiss$equipment_name[iiss$unit_name == "Pchela-1T" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "ISR"
iiss$equipment_name[iiss$unit_name == "Pchela-2" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "ISR"
iiss$equipment_name[iiss$unit_name == "Pioneer" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "TAC"
iiss$equipment_name[iiss$unit_name == "Predator" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "ATK"
iiss$equipment_name[iiss$unit_name == "R4E-50 Skyeye" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "ISR"
iiss$equipment_name[iiss$unit_name == "Ranger/ADS 95" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "RECCE"
iiss$equipment_name[iiss$unit_name == "RPV-2 Seeker" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "RECCE"
iiss$equipment_name[iiss$unit_name == "RQ-11 Raven" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "ISR"
iiss$equipment_name[iiss$unit_name == "RQ-21A Blackjack" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "ISR"
iiss$equipment_name[iiss$unit_name == "RQ-2B Pioneer" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "TAC"
iiss$equipment_name[iiss$unit_name == "RQ-4A Global Hawk" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "ISR"
iiss$equipment_name[iiss$unit_name == "Samson"&
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "RECCE"
iiss$equipment_name[iiss$unit_name == "Scan Eagle" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "recon-surveil"
iiss$equipment_name[iiss$unit_name == "scout"&
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "RECCE"
iiss$equipment_name[iiss$unit_name == "Scout"&
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "RECCE"
iiss$equipment_name[iiss$unit_name == "Searcher"&
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "RECCE"
iiss$equipment_name[iiss$unit_name == "Searcher MkII"&
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "ISR"
iiss$equipment_name[iiss$unit_name == "Searcher-2"&
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "ISR"
iiss$equipment_name[iiss$unit_name == "Seeker"&
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "ISR"
iiss$equipment_name[iiss$unit_name == "Shadow 600" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "RECCE"
iiss$equipment_name[iiss$unit_name == "Silver Fox" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "ISR"
iiss$equipment_name[iiss$unit_name == "Skyeye" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "ISR"
iiss$equipment_name[iiss$unit_name == "Skylark" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "ISR"
iiss$equipment_name[iiss$unit_name == "Sperwer" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "ISR"
iiss$equipment_name[iiss$unit_name == "Tu-134 Reys" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "ISR"
iiss$equipment_name[iiss$unit_name == "Tu-143 Reys" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "ISR"
iiss$equipment_name[iiss$unit_name == "Tu-243 Reys/Tu-243 Reys D" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "ISR"
iiss$equipment_name[iiss$unit_name == "Tu-300 Korshun" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "ISR"
iiss$equipment_name[iiss$unit_name == "Vector" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "ISR"
iiss$equipment_name[iiss$unit_name == "W-50" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "ISR"
iiss$equipment_name[is.na(iiss$unit_name) &
                      iiss$equipment_name == "UAV" &
                      iiss$equipment_type == "unmanned aerial vehicles"] <- "TAC"

# Equipment_subname
iiss$equipment_subname[iiss$unit_name == "Aerostar"] <- "medium"
iiss$equipment_subname[iiss$unit_name == "3D Max Dragon Eye"] <- "light"
iiss$equipment_subname[iiss$unit_name == "Aladin"] <- "light"
iiss$equipment_subname[iiss$unit_name == "Blue Horizon"] <- "medium"
iiss$equipment_subname[iiss$unit_name == "Blue Horizon II"] <- "medium"
iiss$equipment_subname[iiss$unit_name == "Blue Horizon-2"] <- "medium"
iiss$equipment_subname[iiss$unit_name == "BQM-147 Exdrone"] <- "light"
iiss$equipment_subname[iiss$unit_name == "Bravo"] <- "light"
iiss$equipment_subname[iiss$unit_name == "CL 89 (AN/USD501)"] <- "medium"
iiss$equipment_subname[iiss$unit_name == "CL289 (AN/USD502)"] <- "medium"
iiss$equipment_subname[iiss$unit_name == "Firebee"] <- "heavy"
iiss$equipment_subname[iiss$unit_name == "Jasoos"] <- "light"
iiss$equipment_subname[iiss$unit_name == "KZO"] <- "medium"
iiss$equipment_subname[iiss$unit_name == "Mastiff III"] <- "light"
iiss$equipment_subname[iiss$unit_name == "MQ-1C Gray Eagle"] <- "heavy"
iiss$equipment_subname[iiss$unit_name == "Pchela-1 (Shmel)"] <- "light"
iiss$equipment_subname[iiss$unit_name == "Pchela-1T"] <- "light"
iiss$equipment_subname[iiss$unit_name == "RQ-21A Blackjack"] <- "light"
iiss$equipment_subname[iiss$unit_name == "RQ-2B Pioneer"] <- "medium"
iiss$equipment_subname[iiss$unit_name == "RQ-4A Global Hawk"] <- "heavy"
iiss$equipment_subname[iiss$unit_name == "RQ-7B Shadow 200"] <- "medium"
iiss$equipment_subname[iiss$unit_name == "Samson"] <- "TAC"
iiss$equipment_subname[iiss$unit_name == "scout"] <- "TAC"
iiss$equipment_subname[iiss$unit_name == "Scout"] <- "TAC"
iiss$equipment_subname[iiss$unit_name == "Searcher"] <- "TAC"
iiss$equipment_subname[iiss$unit_name == "Seeker"] <- "medium"
iiss$equipment_subname[iiss$unit_name == "Skylark"] <- "light"
iiss$equipment_subname[iiss$unit_name == "Sperwer"] <- "medium"
iiss$equipment_subname[iiss$unit_name == "Vector"] <- "light"
iiss$equipment_subname[iiss$unit_name == "W-50"] <- "light"

# Equipment_name

# Equipment_subtype

# Equipment_type
iiss$equipment_type[iiss$equipment_name == "UAV"] <- "unmanned aerial vehicles"
```

#### Equipment_subtype
Fix incorrect columns that should have equipment_subtype = TBD
```{r}
# Unit_name
iiss$equipment_subtype[iiss$unit_name == "Hermes 450"] <- NA

# Equipment_subname

# Equipment_name

# Equipment_subtype

# Equipment_type
iiss$equipment_subtype[iiss$equipment_type == "unmanned aerial vehicles"] <- NA
```
#### Equipment_type

Fix incorrect unit_name that should have equipment_type = equipment_type
```{r}
iiss$equipment_type[iiss$unit_name == "CL-89"] <- "unmanned aerial vehicles"
iiss$equipment_type[iiss$unit_name == "FS- 01 Watchdog"] <- "unmanned aerial vehicles"
iiss$equipment_type[iiss$unit_name == "Hermes 450"] <- "unmanned aerial vehicles"
iiss$equipment_type[iiss$unit_name == "R4E-50 Skyeye"] <- "unmanned aerial vehicles"
iiss$equipment_type[iiss$unit_name == "Teledyne-Ryan 324 Scarab"] <- "unmanned aerial vehicles"
```

Fix incorrect equipment_subname that should have equipment_type = equipment_type
```{r}
# Convert to light
iiss$equipment_subname[iiss$equipment_type == "unmanned aerial vehicles" &
                      iiss$equipment_name == "light"] <- "light"

# Convert to medium
iiss$equipment_subname[iiss$equipment_type == "unmanned aerial vehicles" &
                         iiss$equipment_name == "medium"] <- "medium"

# Convert to heavy
iiss$equipment_subname[iiss$equipment_type == "unmanned aerial vehicles" &
                         iiss$equipment_name == "heavy"] <- "heavy"

# Convert to tactical
iiss$equipment_subname[iiss$equipment_type == "unmanned aerial vehicles" &
                         iiss$equipment_subtype == "tactical"] <- "tactical"
iiss$equipment_subname[iiss$equipment_type == "unmanned aerial vehicles" &
                         iiss$equipment_subname == "TAC"] <- "tactical"
iiss$equipment_subname[iiss$equipment_type == "unmanned aerial vehicles" &
                         iiss$equipment_name == "TACTICAL"] <- "tactical"

# Convert to NA
iiss$equipment_subname[iiss$equipment_type == "unmanned aerial vehicles" &
                      (iiss$equipment_subname == "UAV" |
                         iiss$equipment_subname == "RECCE" |
                         iiss$equipment_subname == "Unknown")] <- NA
```

Fix incorrect equipment_name that should have equipment_type = equipment_type
```{r}
# Convert to CISR
iiss$equipment_name[iiss$equipment_type == "unmanned aerial vehicles" &
                      iiss$equipment_name == "Cbt ISR"] <- "CISR"

# Convert to ISR
iiss$equipment_name[iiss$equipment_type == "unmanned aerial vehicles" &
                         iiss$equipment_name == "light" &
                      iiss$equipment_subname == "light"] <- "ISR"

# Convert to UAV
iiss$equipment_name[iiss$equipment_type == "unmanned aerial vehicles" &
                      iiss$equipment_subname == "UAV"] <- "UAV"

# Convert to RECCE/ATK
iiss$equipment_name[iiss$equipment_type == "unmanned aerial vehicles" &
                      iiss$equipment_name == "RECCE/ATL"] <- "RECCE/ATK"

# Convert to RECCE
iiss$equipment_name[iiss$equipment_type == "unmanned aerial vehicles" & 
                      iiss$equipment_name == "AN/USD-502"] <- "RECCE"
iiss$equipment_name[iiss$equipment_type == "unmanned aerial vehicles" & 
                      iiss$equipment_name == "UAV" & 
                      iiss$unit_name == "Predator"] <- "RECCE"

# Convert to NA 
iiss$equipment_name[iiss$equipment_type == "unmanned aerial vehicles" &
                      iiss$equipment_name == "medium" &
                      iiss$equipment_subname == "medium"] <- NA
iiss$equipment_name[iiss$equipment_type == "unmanned aerial vehicles" &
                      iiss$equipment_name == "heavy" &
                      iiss$equipment_subname == "heavy"] <- NA
iiss$equipment_name[iiss$equipment_type == "unmanned aerial vehicles" &
                         iiss$equipment_name == "TACTICAL" &
                      iiss$equipment_subname == "tactical"] <- NA

# Convert to combat
iiss$equipment_name[iiss$equipment_type == "unmanned aerial vehicles" & 
                      iiss$equipment_name == "UAV" & 
                      iiss$unit_name == "Predator"] <- "combat" 

# Convert to recon-surveil
iiss$equipment_name[iiss$equipment_type == "unmanned aerial vehicles" & 
                      (iiss$equipment_name == "UAV" |
                         iiss$equipment_name == "MINI-UAV" |
                         iiss$equipment_name == "RPV" |
                         is.na(iiss$equipment_name)) & 
                      (iiss$unit_name %in% c("Aladin",
                                             "Armor X7",
                                             "ASN-104/105",
                                             "ASN-104/-105",
                                             "ASN-104/-105/-206",
                                             "B-Hunter",
                                             "Blue Horizon",
                                             "Chang Hong 1",
                                             "CL-89 (AN/USD-501)",
                                             "E1 Gavilan",
                                             "Epervier",
                                             "Impact",
                                             "L-29",
                                             "Sperwer",
                                             "Mastiff III",
                                             "Micro 15",
                                             "Mirach 20/-100/-150",
                                             "Mirach 20/-150",
                                             "Mirach 20",
                                             NA,
                                             "Orbiter",
                                             "Pioneer",
                                             "Scout",
                                             "Searcher",
                                             "Searcher MK II",
                                             "Searcher-2",
                                             "Seeker",
                                             "Shadow 600",
                                             "Skylark",
                                             "Skylark MkI",
                                             "Sperwer",
                                             "W-50"))] <- "recon-surveil"
```

Fix incorrect equipment_subtype that should have equipment_type = equipment_type
```{r}
# Convert to NA
iiss$equipment_subtype[iiss$equipment_type == "unmanned aerial vehicles" &
                         iiss$equipment_subtype == "missiles"] <- NA
iiss$equipment_subtype[iiss$equipment_type == "unmanned aerial vehicles" &
                         iiss$equipment_subtype == "tactical" &
                         iiss$equipment_subname == "tactical"] <- NA
```

Fix incorrect equipment_type that should have equipment_type = equipment_type
```{r}
# Helicopters
iiss$equipment_type[iiss$equipment_type == "helicopters" &
                      iiss$equipment_name == "UAV"] <- "unmanned aerial vehicles"

# Air defence
iiss$equipment_type[iiss$equipment_type == "air defence" &
                      iiss$equipment_name == "UAV"] <- "unmanned aerial vehicles"

# Aircraft
iiss$equipment_type[iiss$equipment_type == "aircraft" &
                       iiss$equipment_name == "UAV"] <- "unmanned aerial vehicles"

# NA
iiss$equipment_type[is.na(iiss$equipment_type) &
                      (iiss$equipment_name == "UAV")] <- "unmanned aerial vehicles"
iiss$equipment_type[is.na(iiss$equipment_type) &
                      (iiss$unit_name == "Hunter")] <- "unmanned aerial vehicles"
iiss$equipment_type[is.na(iiss$equipment_type) &
                      (iiss$equipment_name == "RPV")] <- "unmanned aerial vehicles"

```

## Dropped observations and edge cases

```{r}
iiss$equipment_type[iiss$country == "sri lanka" &
                      iiss$equipment_subtype == "MOR" &
                      iiss$equipment_name == "anti-tank/anti-infrastructure"] <- "artillery"

iiss <- iiss %>%
  dplyr::filter(!(country == "india" & 
                    equipment_name == "CV" & 
                    unit_name == "Sea Harrier (Sea Eagle ASM)"))

iiss <- iiss %>%
  dplyr::filter(!(country == "india" & 
                    equipment_name == "CV" & 
                    unit_name == "Ka-27 Helix/ Sea King Mk24B"))

iiss <- iiss %>%
  dplyr::filter(!(equipment_subtype == "carriers" & 
                    equipment_name == "AEW"))

iiss <- iiss %>%
  dplyr::filter(!(equipment_type == "principal surface combatants" & 
                    equipment_name == "SAM") | is.na(equipment_name))

iiss <- iiss %>%
  dplyr::filter(!(equipment_type == "principal surface combatants" & 
                    unit_name == "ASROC") | is.na(unit_name))

iiss <- iiss %>%
  dplyr::filter(!(equipment_type == "logistics and support" & 
                    equipment_name == "TT") | is.na(equipment_name))

iiss <- iiss %>%
  dplyr::filter(!(equipment_subtype == "carriers" & 
                    equipment_name == "ASW"))

iiss <- iiss %>%
  dplyr::filter(!(equipment_type == "logistics and support" & 
                    equipment_name == "AIR SPT") | is.na(equipment_name))

iiss <- iiss %>%
  dplyr::filter(!(equipment_subtype == "carriers" & 
                    equipment_name == "FGA"))

iiss <- iiss %>%
  dplyr::filter(!(country == "vietnam" & 
                    equipment_type == "radars" & 
                    equipment_name == "early warning"))

iiss <- iiss %>%
  dplyr::filter(!(equipment_type == "unmanned aerial vehicles" & 
                    equipment_name == "UAV" & 
                    unit_name == "(trials)"))

iiss <- iiss %>%
  dplyr::filter(!(equipment_type == "surface-to-surface missile launchers" &
                  unit_name == "trials"))

#######
iiss <- iiss %>%
  dplyr::filter(!((equipment_name %in% c("FFG",
                                         "FFGHM") & 
                    equipment_type == "surface-to-surface missile launchers")))

iiss <- iiss %>%
  dplyr::filter(!(equipment_name == "TRIALS" & 
                    equipment_type == "surface-to-surface missile launchers"))

iiss <- iiss %>%
  dplyr::filter(!(equipment_type == "battalion"))

iiss <- iiss %>%
  dplyr::filter(is.na(unit_name) | !(unit_name == "Mk46"))

iiss <- iiss %>%
  dplyr::filter(!(equipment_type == "amphibious" & 
                    equipment_name %in% c("SF",
                                          "SSM")))

iiss <- iiss %>%
  dplyr::filter(!(equipment_type == "helicopters" & 
                    equipment_name == "LPH" & 
                    (unit_name %in% c("Helicopter",
                                      "Helicopter Support"))))

iiss <- iiss %>% dplyr::mutate(notes = ifelse(iiss$equipment_type == "aircraft" &
                                                (iiss$equipment_name == "In Store" |
                                                   iiss$equipment_name == "IN STORE" |
                                                   iiss$equipment_name == "STORAGE"), 
                                              paste0(unit_count, " in store"), notes))
iiss <- iiss %>% dplyr::mutate(notes = ifelse(iiss$equipment_type == "aircraft" &
                                                iiss$equipment_name == "TRIALS AND TEST", 
                                              paste0(unit_count, " test and trials"), notes))

a = which(iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_name == "SAM")
if(length(a) > 0){
  iiss <- iiss[-a, ]
}

b = which(iiss$equipment_type == "helicopters" &
            iiss$equipment_name %in% c("Reserves", "RESERVE"))

if(length(b) > 0){
  iiss <- iiss[-b, ]
}

iiss <- iiss[!grepl("Reserves", iiss$equipment_name), ]

row_to_keep = which(iiss$equipment_type == "naval commandos")
if(length(row_to_keep) > 0){
  iiss <- iiss[-row_to_keep, ]
}

row_to_keep = which(iiss$equipment_name == "equipment_name")
if(length(row_to_keep) > 0){
iiss <- iiss[-row_to_keep, ]
}

iiss <- iiss[!grepl("DDS opcon USSOCOM", iiss$unit_name), ]

row_to_keep <- which(iiss$equipment_type == "patrol and coastal combatants" &
                      iiss$equipment_subname == "324mm")
if(length(row_to_keep) > 0){
iiss <- iiss[-row_to_keep, ]
}

row_to_keep <- which(iiss$equipment_type == "principal surface combatants" &
                      (iiss$equipment_subname == "406mm" |
                         iiss$equipment_subname == "AEW"))
if(length(row_to_keep) > 0){
iiss <- iiss[-row_to_keep, ]
}
```
